!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=21)}([function(t,e){e.nil=new Error("#NULL!"),e.div0=new Error("#DIV/0!"),e.value=new Error("#VALUE!"),e.ref=new Error("#REF!"),e.name=new Error("#NAME?"),e.num=new Error("#NUM!"),e.na=new Error("#N/A"),e.error=new Error("#ERROR!"),e.data=new Error("#GETTING_DATA")},function(t,e,r){var n=r(0);e.flattenShallow=function(t){return t&&t.reduce?t.reduce((function(t,e){var r=Array.isArray(t),n=Array.isArray(e);return r&&n?t.concat(e):r?(t.push(e),t):n?[t].concat(e):[t,e]})):t},e.isFlat=function(t){if(!t)return!1;for(var e=0;e<t.length;++e)if(Array.isArray(t[e]))return!1;return!0},e.flatten=function(){for(var t=e.argsToArray.apply(null,arguments);!e.isFlat(t);)t=e.flattenShallow(t);return t},e.argsToArray=function(t){var r=[];return e.arrayEach(t,(function(t){r.push(t)})),r},e.numbers=function(){var t=this.flatten.apply(null,arguments);return t.filter((function(t){return"number"==typeof t}))},e.cleanFloat=function(t){return Math.round(1e14*t)/1e14},e.parseBool=function(t){if("boolean"==typeof t)return t;if(t instanceof Error)return t;if("number"==typeof t)return 0!==t;if("string"==typeof t){var e=t.toUpperCase();if("TRUE"===e)return!0;if("FALSE"===e)return!1}return t instanceof Date&&!isNaN(t)||n.value},e.parseNumber=function(t){return void 0===t||""===t||isNaN(t)?n.value:parseFloat(t)},e.parseNumberArray=function(t){var r,o;if(!t||0===(r=t.length))return n.value;for(;r--;){if((o=e.parseNumber(t[r]))===n.value)return o;t[r]=o}return t},e.parseMatrix=function(t){var r;if(!t||0===t.length)return n.value;for(var o=0;o<t.length;o++)if(r=e.parseNumberArray(t[o]),t[o]=r,r instanceof Error)return r;return t};var o=new Date(Date.UTC(1900,0,1));e.parseDate=function(t){if(!isNaN(t)){if(t instanceof Date)return new Date(t);var e=parseInt(t,10);return e<0?n.num:e<=60?new Date(o.getTime()+864e5*(e-1)):new Date(o.getTime()+864e5*(e-2))}return"string"!=typeof t||(t=new Date(t),isNaN(t))?n.value:t},e.parseDateArray=function(t){for(var e,r=t.length;r--;){if((e=this.parseDate(t[r]))===n.value)return e;t[r]=e}return t},e.anyIsError=function(){for(var t=arguments.length;t--;)if(arguments[t]instanceof Error)return!0;return!1},e.arrayValuesToNumbers=function(t){for(var e,r=t.length;r--;)if("number"!=typeof(e=t[r]))if(!0!==e)if(!1!==e){if("string"==typeof e){var n=this.parseNumber(e);n instanceof Error?t[r]=0:t[r]=n}}else t[r]=0;else t[r]=1;return t},e.rest=function(t,e){return e=e||1,t&&"function"==typeof t.slice?t.slice(e):t},e.initial=function(t,e){return e=e||1,t&&"function"==typeof t.slice?t.slice(0,t.length-e):t},e.arrayEach=function(t,e){for(var r=-1,n=t.length;++r<n&&!1!==e(t[r],r,t););return t},e.transpose=function(t){return t?t[0].map((function(e,r){return t.map((function(t){return t[r]}))})):n.value}},function(t,e,r){var n=[r(14),r(16),r(12),r(17),r(3),r(5),r(8),r(18),r(7),r(19),r(4),r(11)];for(var o in n){var i=n[o];for(var a in i)e[a]=e[a]||i[a]}},function(t,e,r){var n=r(1),o=r(0),i=r(4),a=r(7),u=r(6);e.ABS=function(t){return(t=n.parseNumber(t))instanceof Error?t:Math.abs(t)},e.ACOS=function(t){if((t=n.parseNumber(t))instanceof Error)return t;var e=Math.acos(t);return isNaN(e)&&(e=o.num),e},e.ACOSH=function(t){if((t=n.parseNumber(t))instanceof Error)return t;var e=Math.log(t+Math.sqrt(t*t-1));return isNaN(e)&&(e=o.num),e},e.ACOT=function(t){return(t=n.parseNumber(t))instanceof Error?t:Math.atan(1/t)},e.ACOTH=function(t){if((t=n.parseNumber(t))instanceof Error)return t;var e=.5*Math.log((t+1)/(t-1));return isNaN(e)&&(e=o.num),e},e.AGGREGATE=function(t,r,a,u){if(t=n.parseNumber(t),r=n.parseNumber(t),n.anyIsError(t,r))return o.value;switch(t){case 1:return i.AVERAGE(a);case 2:return i.COUNT(a);case 3:return i.COUNTA(a);case 4:return i.MAX(a);case 5:return i.MIN(a);case 6:return e.PRODUCT(a);case 7:return i.STDEV.S(a);case 8:return i.STDEV.P(a);case 9:return e.SUM(a);case 10:return i.VAR.S(a);case 11:return i.VAR.P(a);case 12:return i.MEDIAN(a);case 13:return i.MODE.SNGL(a);case 14:return i.LARGE(a,u);case 15:return i.SMALL(a,u);case 16:return i.PERCENTILE.INC(a,u);case 17:return i.QUARTILE.INC(a,u);case 18:return i.PERCENTILE.EXC(a,u);case 19:return i.QUARTILE.EXC(a,u)}},e.ARABIC=function(t){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))return o.value;var e=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(t){e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]})),e},e.ASIN=function(t){if((t=n.parseNumber(t))instanceof Error)return t;var e=Math.asin(t);return isNaN(e)&&(e=o.num),e},e.ASINH=function(t){return(t=n.parseNumber(t))instanceof Error?t:Math.log(t+Math.sqrt(t*t+1))},e.ATAN=function(t){return(t=n.parseNumber(t))instanceof Error?t:Math.atan(t)},e.ATAN2=function(t,e){return t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.value:Math.atan2(t,e)},e.ATANH=function(t){if((t=n.parseNumber(t))instanceof Error)return t;var e=Math.log((1+t)/(1-t))/2;return isNaN(e)&&(e=o.num),e},e.BASE=function(t,e,r){if(r=r||0,t=n.parseNumber(t),e=n.parseNumber(e),r=n.parseNumber(r),n.anyIsError(t,e,r))return o.value;r=void 0===r?0:r;var i=t.toString(e);return new Array(Math.max(r+1-i.length,0)).join("0")+i},e.CEILING=function(t,r,i){if(r=void 0===r?1:Math.abs(r),i=i||0,t=n.parseNumber(t),r=n.parseNumber(r),i=n.parseNumber(i),n.anyIsError(t,r,i))return o.value;if(0===r)return 0;var a=-Math.floor(Math.log(r)/Math.log(10));return t>=0?e.ROUND(Math.ceil(t/r)*r,a):0===i?-e.ROUND(Math.floor(Math.abs(t)/r)*r,a):-e.ROUND(Math.ceil(Math.abs(t)/r)*r,a)},e.CEILING.MATH=e.CEILING,e.CEILING.PRECISE=e.CEILING,e.COMBIN=function(t,r){return t=n.parseNumber(t),r=n.parseNumber(r),n.anyIsError(t,r)?o.value:e.FACT(t)/(e.FACT(r)*e.FACT(t-r))},e.COMBINA=function(t,r){return t=n.parseNumber(t),r=n.parseNumber(r),n.anyIsError(t,r)?o.value:0===t&&0===r?1:e.COMBIN(t+r-1,t-1)},e.COS=function(t){return(t=n.parseNumber(t))instanceof Error?t:Math.cos(t)},e.COSH=function(t){return(t=n.parseNumber(t))instanceof Error?t:(Math.exp(t)+Math.exp(-t))/2},e.COT=function(t){return(t=n.parseNumber(t))instanceof Error?t:1/Math.tan(t)},e.COTH=function(t){if((t=n.parseNumber(t))instanceof Error)return t;var e=Math.exp(2*t);return(e+1)/(e-1)},e.CSC=function(t){return(t=n.parseNumber(t))instanceof Error?t:1/Math.sin(t)},e.CSCH=function(t){return(t=n.parseNumber(t))instanceof Error?t:2/(Math.exp(t)-Math.exp(-t))},e.DECIMAL=function(t,e){return arguments.length<1?o.value:parseInt(t,e)},e.DEGREES=function(t){return(t=n.parseNumber(t))instanceof Error?t:180*t/Math.PI},e.EVEN=function(t){return(t=n.parseNumber(t))instanceof Error?t:e.CEILING(t,-2,-1)},e.EXP=function(t){return arguments.length<1?o.na:"number"!=typeof t||arguments.length>1?o.error:t=Math.exp(t)};var l=[];e.FACT=function(t){if((t=n.parseNumber(t))instanceof Error)return t;var r=Math.floor(t);return 0===r||1===r?1:(l[r]>0||(l[r]=e.FACT(r-1)*r),l[r])},e.FACTDOUBLE=function(t){if((t=n.parseNumber(t))instanceof Error)return t;var r=Math.floor(t);return r<=0?1:r*e.FACTDOUBLE(r-2)},e.FLOOR=function(t,r){if(t=n.parseNumber(t),r=n.parseNumber(r),n.anyIsError(t,r))return o.value;if(0===r)return 0;if(!(t>0&&r>0||t<0&&r<0))return o.num;r=Math.abs(r);var i=-Math.floor(Math.log(r)/Math.log(10));return t>=0?e.ROUND(Math.floor(t/r)*r,i):-e.ROUND(Math.ceil(Math.abs(t)/r),i)},e.FLOOR.MATH=function(t,r,i){if(r=void 0===r?1:r,i=void 0===i?0:i,t=n.parseNumber(t),r=n.parseNumber(r),i=n.parseNumber(i),n.anyIsError(t,r,i))return o.value;if(0===r)return 0;r=r?Math.abs(r):1;var a=-Math.floor(Math.log(r)/Math.log(10));return t>=0?e.ROUND(Math.floor(t/r)*r,a):0===i||void 0===i?-e.ROUND(Math.ceil(Math.abs(t)/r)*r,a):-e.ROUND(Math.floor(Math.abs(t)/r)*r,a)},e.FLOOR.PRECISE=e.FLOOR.MATH,e.GCD=function(){var t=n.parseNumberArray(n.flatten(arguments));if(t instanceof Error)return t;for(var e=t.length,r=t[0],o=r<0?-r:r,i=1;i<e;i++){for(var a=t[i],u=a<0?-a:a;o&&u;)o>u?o%=u:u%=o;o+=u}return o},e.INT=function(t){return(t=n.parseNumber(t))instanceof Error?t:Math.floor(t)},e.ISO={CEILING:e.CEILING},e.LCM=function(){var t=n.parseNumberArray(n.flatten(arguments));if(t instanceof Error)return t;for(var e,r,o,i,a=1;void 0!==(o=t.pop());)for(;o>1;){if(o%2){for(e=3,r=Math.floor(Math.sqrt(o));e<=r&&o%e;e+=2);i=e<=r?e:o}else i=2;for(o/=i,a*=i,e=t.length;e;t[--e]%i==0&&1==(t[e]/=i)&&t.splice(e,1));}return a},e.LN=function(t){return(t=n.parseNumber(t))instanceof Error?t:Math.log(t)},e.LN10=function(){return Math.log(10)},e.LN2=function(){return Math.log(2)},e.LOG10E=function(){return Math.LOG10E},e.LOG2E=function(){return Math.LOG2E},e.LOG=function(t,e){return t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.value:(e=void 0===e?10:e,Math.log(t)/Math.log(e))},e.LOG10=function(t){return(t=n.parseNumber(t))instanceof Error?t:Math.log(t)/Math.log(10)},e.MOD=function(t,e){if(t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e))return o.value;if(0===e)return o.div0;var r=Math.abs(t%e);return e>0?r:-r},e.MROUND=function(t,e){return t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.value:t*e<0?o.num:Math.round(t/e)*e},e.MULTINOMIAL=function(){var t=n.parseNumberArray(n.flatten(arguments));if(t instanceof Error)return t;for(var r=0,o=1,i=0;i<t.length;i++)r+=t[i],o*=e.FACT(t[i]);return e.FACT(r)/o},e.ODD=function(t){if((t=n.parseNumber(t))instanceof Error)return t;var e=Math.ceil(Math.abs(t));return e=1&e?e:e+1,t>0?e:-e},e.PI=function(){return Math.PI},e.E=function(){return Math.E},e.POWER=function(t,e){if(t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e))return o.value;var r=Math.pow(t,e);return isNaN(r)?o.num:r},e.PRODUCT=function(){var t=n.parseNumberArray(n.flatten(arguments));if(t instanceof Error)return t;for(var e=1,r=0;r<t.length;r++)e*=t[r];return e},e.QUOTIENT=function(t,e){return t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.value:parseInt(t/e,10)},e.RADIANS=function(t){return(t=n.parseNumber(t))instanceof Error?t:t*Math.PI/180},e.RAND=function(){return Math.random()},e.RANDBETWEEN=function(t,e){return t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.value:t+Math.ceil((e-t+1)*Math.random())-1},e.ROMAN=function(t){if((t=n.parseNumber(t))instanceof Error)return t;for(var e=String(t).split(""),r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],o="",i=3;i--;)o=(r[+e.pop()+10*i]||"")+o;return new Array(+e.join("")+1).join("M")+o},e.ROUND=function(t,e){return t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.value:Math.round(t*Math.pow(10,e))/Math.pow(10,e)},e.ROUNDDOWN=function(t,e){return t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.value:(t>0?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)},e.ROUNDUP=function(t,e){return t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.value:(t>0?1:-1)*Math.ceil(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)},e.SEC=function(t){return(t=n.parseNumber(t))instanceof Error?t:1/Math.cos(t)},e.SECH=function(t){return(t=n.parseNumber(t))instanceof Error?t:2/(Math.exp(t)+Math.exp(-t))},e.SERIESSUM=function(t,e,r,i){if(t=n.parseNumber(t),e=n.parseNumber(e),r=n.parseNumber(r),i=n.parseNumberArray(i),n.anyIsError(t,e,r,i))return o.value;for(var a=i[0]*Math.pow(t,e),u=1;u<i.length;u++)a+=i[u]*Math.pow(t,e+u*r);return a},e.SIGN=function(t){return(t=n.parseNumber(t))instanceof Error?t:t<0?-1:0===t?0:1},e.SIN=function(t){return(t=n.parseNumber(t))instanceof Error?t:Math.sin(t)},e.SINH=function(t){return(t=n.parseNumber(t))instanceof Error?t:(Math.exp(t)-Math.exp(-t))/2},e.SQRT=function(t){return(t=n.parseNumber(t))instanceof Error?t:t<0?o.num:Math.sqrt(t)},e.SQRTPI=function(t){return(t=n.parseNumber(t))instanceof Error?t:Math.sqrt(t*Math.PI)},e.SQRT1_2=function(){return 1/Math.sqrt(2)},e.SQRT2=function(){return Math.sqrt(2)},e.SUBTOTAL=function(t,r){if((t=n.parseNumber(t))instanceof Error)return t;switch(t){case 1:return i.AVERAGE(r);case 2:return i.COUNT(r);case 3:return i.COUNTA(r);case 4:return i.MAX(r);case 5:return i.MIN(r);case 6:return e.PRODUCT(r);case 7:return i.STDEV.S(r);case 8:return i.STDEV.P(r);case 9:return e.SUM(r);case 10:return i.VAR.S(r);case 11:return i.VAR.P(r);case 101:return i.AVERAGE(r);case 102:return i.COUNT(r);case 103:return i.COUNTA(r);case 104:return i.MAX(r);case 105:return i.MIN(r);case 106:return e.PRODUCT(r);case 107:return i.STDEV.S(r);case 108:return i.STDEV.P(r);case 109:return e.SUM(r);case 110:return i.VAR.S(r);case 111:return i.VAR.P(r)}},e.ADD=function(t,e){return 2!==arguments.length?o.na:(t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.value:t+e)},e.MINUS=function(t,e){return 2!==arguments.length?o.na:(t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.value:t-e)},e.DIVIDE=function(t,e){return 2!==arguments.length?o.na:(t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.value:0===e?o.div0:t/e)},e.MULTIPLY=function(t,e){return 2!==arguments.length?o.na:(t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.value:t*e)},e.GTE=function(t,e){return 2!==arguments.length?o.na:(t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.error:t>=e)},e.LT=function(t,e){return 2!==arguments.length?o.na:(t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.error:t<e)},e.LTE=function(t,e){return 2!==arguments.length?o.na:(t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.error:t<=e)},e.EQ=function(t,e){return 2!==arguments.length?o.na:t===e},e.NE=function(t,e){return 2!==arguments.length?o.na:t!==e},e.POW=function(t,r){return 2!==arguments.length?o.na:(t=n.parseNumber(t),r=n.parseNumber(r),n.anyIsError(t,r)?o.error:e.POWER(t,r))},e.SUM=function(){var t=0;return n.arrayEach(n.argsToArray(arguments),(function(r){if("number"==typeof r)t+=r;else if("string"==typeof r){var n=parseFloat(r);!isNaN(n)&&(t+=n)}else Array.isArray(r)&&(t+=e.SUM.apply(null,r))})),t},e.SUMIF=function(t,e){if((t=n.parseNumberArray(n.flatten(t)))instanceof Error)return t;for(var r=0,o=void 0===e||"*"===e,i=o?null:u.parse(e+""),a=0;a<t.length;a++){var l=t[a];if(o)r+=l;else{var c=[u.createToken(l,u.TOKEN_TYPE_LITERAL)].concat(i);r+=u.compute(c)?l:0}}return r},e.SUMIFS=function(){var t=n.argsToArray(arguments),e=n.parseNumberArray(n.flatten(t.shift()));if(e instanceof Error)return e;for(var r=t,o=e.length,i=r.length,a=0,l=0;l<o;l++){for(var c=e[l],s=!1,f=0;f<i;f++){var h=r[f],p=void 0===h||"*"===h,y=!1;if(p)y=!0;else{var v=u.parse(h+""),b=[u.createToken(c,u.TOKEN_TYPE_LITERAL)].concat(v);y=u.compute(b)}if(!y){s=!1;break}s=!0}s&&(a+=c)}return a},e.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return o.value;for(var t,e,r,i,a=arguments.length+1,u=0,l=0;l<arguments[0].length;l++)if(arguments[0][l]instanceof Array)for(var c=0;c<arguments[0][l].length;c++){for(t=1,e=1;e<a;e++){if((i=n.parseNumber(arguments[e-1][l][c]))instanceof Error)return i;t*=i}u+=t}else{for(t=1,e=1;e<a;e++){if((r=n.parseNumber(arguments[e-1][l]))instanceof Error)return r;t*=r}u+=t}return u},e.SUMSQ=function(){var t=n.parseNumberArray(n.flatten(arguments));if(t instanceof Error)return t;for(var e=0,r=t.length,o=0;o<r;o++)e+=a.ISNUMBER(t[o])?t[o]*t[o]:0;return e},e.SUMX2MY2=function(t,e){if(t=n.parseNumberArray(n.flatten(t)),e=n.parseNumberArray(n.flatten(e)),n.anyIsError(t,e))return o.value;for(var r=0,i=0;i<t.length;i++)r+=t[i]*t[i]-e[i]*e[i];return r},e.SUMX2PY2=function(t,e){if(t=n.parseNumberArray(n.flatten(t)),e=n.parseNumberArray(n.flatten(e)),n.anyIsError(t,e))return o.value;var r=0;t=n.parseNumberArray(n.flatten(t)),e=n.parseNumberArray(n.flatten(e));for(var i=0;i<t.length;i++)r+=t[i]*t[i]+e[i]*e[i];return r},e.SUMXMY2=function(t,e){if(t=n.parseNumberArray(n.flatten(t)),e=n.parseNumberArray(n.flatten(e)),n.anyIsError(t,e))return o.value;var r=0;t=n.flatten(t),e=n.flatten(e);for(var i=0;i<t.length;i++)r+=Math.pow(t[i]-e[i],2);return r},e.TAN=function(t){return(t=n.parseNumber(t))instanceof Error?t:Math.tan(t)},e.TANH=function(t){if((t=n.parseNumber(t))instanceof Error)return t;var e=Math.exp(2*t);return(e-1)/(e+1)},e.TRUNC=function(t,e){return e=void 0===e?0:e,t=n.parseNumber(t),e=n.parseNumber(e),n.anyIsError(t,e)?o.value:(t>0?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)}},function(t,e,r){var n=r(3),o=r(5),i=r(10),a=r(1),u=r(6),l=r(0),c=r(11);e.AVEDEV=function(){var t=a.parseNumberArray(a.flatten(arguments));return t instanceof Error?t:i.sum(i(t).subtract(i.mean(t)).abs()[0])/t.length},e.AVERAGE=function(){for(var t,e=a.numbers(a.flatten(arguments)),r=e.length,n=0,o=0,i=0;i<r;i++)n+=e[i],o+=1;return t=n/o,isNaN(t)&&(t=l.num),t},e.AVERAGEA=function(){for(var t,e=a.flatten(arguments),r=e.length,n=0,o=0,i=0;i<r;i++){var u=e[i];"number"==typeof u&&(n+=u),!0===u&&n++,null!==u&&o++}return t=n/o,isNaN(t)&&(t=l.num),t},e.AVERAGEIF=function(t,e,r){if(arguments.length<=1)return l.na;if(r=r||t,t=a.flatten(t),(r=a.parseNumberArray(a.flatten(r)))instanceof Error)return r;for(var n=0,o=0,i=void 0===e||"*"===e,c=i?null:u.parse(e+""),s=0;s<t.length;s++){var f=t[s];if(i)o+=r[s],n++;else{var h=[u.createToken(f,u.TOKEN_TYPE_LITERAL)].concat(c);u.compute(h)&&(o+=r[s],n++)}}return o/n},e.AVERAGEIFS=function(){for(var t=a.argsToArray(arguments),e=(t.length-1)/2,r=a.flatten(t[0]),n=0,o=0,i=0;i<r.length;i++){for(var l=!1,c=0;c<e;c++){var s=t[2*c+1][i],f=t[2*c+2],h=void 0===f||"*"===f,p=!1;if(h)p=!0;else{var y=u.parse(f+""),v=[u.createToken(s,u.TOKEN_TYPE_LITERAL)].concat(y);p=u.compute(v)}if(!p){l=!1;break}l=!0}l&&(o+=r[i],n++)}var b=o/n;return isNaN(b)?0:b},e.BETA={},e.BETA.DIST=function(t,e,r,n,o,u){return arguments.length<4?l.value:(o=void 0===o?0:o,u=void 0===u?1:u,t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),o=a.parseNumber(o),u=a.parseNumber(u),a.anyIsError(t,e,r,o,u)?l.value:(t=(t-o)/(u-o),n?i.beta.cdf(t,e,r):i.beta.pdf(t,e,r)))},e.BETA.INV=function(t,e,r,n,o){return n=void 0===n?0:n,o=void 0===o?1:o,t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),n=a.parseNumber(n),o=a.parseNumber(o),a.anyIsError(t,e,r,n,o)?l.value:i.beta.inv(t,e,r)*(o-n)+n},e.BINOM={},e.BINOM.DIST=function(t,e,r,n){return t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),n=a.parseNumber(n),a.anyIsError(t,e,r,n)?l.value:n?i.binomial.cdf(t,e,r):i.binomial.pdf(t,e,r)},e.BINOM.DIST.RANGE=function(t,e,r,o){if(o=void 0===o?r:o,t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),o=a.parseNumber(o),a.anyIsError(t,e,r,o))return l.value;for(var i=0,u=r;u<=o;u++)i+=n.COMBIN(t,u)*Math.pow(e,u)*Math.pow(1-e,t-u);return i},e.BINOM.INV=function(t,e,r){if(t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r))return l.value;for(var n=0;n<=t;){if(i.binomial.cdf(n,t,e)>=r)return n;n++}},e.CHISQ={},e.CHISQ.DIST=function(t,e,r){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:r?i.chisquare.cdf(t,e):i.chisquare.pdf(t,e)},e.CHISQ.DIST.RT=function(t,e){return!t|!e?l.na:t<1||e>Math.pow(10,10)?l.num:"number"!=typeof t||"number"!=typeof e?l.value:1-i.chisquare.cdf(t,e)},e.CHISQ.INV=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:i.chisquare.inv(t,e)},e.CHISQ.INV.RT=function(t,e){return!t|!e?l.na:t<0||t>1||e<1||e>Math.pow(10,10)?l.num:"number"!=typeof t||"number"!=typeof e?l.value:i.chisquare.inv(1-t,e)},e.CHISQ.TEST=function(t,e){if(2!==arguments.length)return l.na;if(!(t instanceof Array&&e instanceof Array))return l.value;if(t.length!==e.length)return l.value;if(t[0]&&e[0]&&t[0].length!==e[0].length)return l.value;var r,n,o,i=t.length;for(n=0;n<i;n++)t[n]instanceof Array||(r=t[n],t[n]=[],t[n].push(r)),e[n]instanceof Array||(r=e[n],e[n]=[],e[n].push(r));var a=t[0].length,u=1===a?i-1:(i-1)*(a-1),c=0,s=Math.PI;for(n=0;n<i;n++)for(o=0;o<a;o++)c+=Math.pow(t[n][o]-e[n][o],2)/e[n][o];function f(t,e){var r=Math.exp(-.5*t);e%2==1&&(r*=Math.sqrt(2*t/s));for(var n=e;n>=2;)r=r*t/n,n-=2;for(var o=r,i=e;o>1e-10*r;)r+=o=o*t/(i+=2);return 1-r}return Math.round(1e6*f(c,u))/1e6},e.COLUMN=function(t,e){return 2!==arguments.length?l.na:e<0?l.num:t instanceof Array&&"number"==typeof e?0!==t.length?i.col(t,e):void 0:l.value},e.COLUMNS=function(t){return 1!==arguments.length?l.na:t instanceof Array?0===t.length?0:i.cols(t):l.value},e.CONFIDENCE={},e.CONFIDENCE.NORM=function(t,e,r){return t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r)?l.value:i.normalci(1,t,e,r)[1]-1},e.CONFIDENCE.T=function(t,e,r){return t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r)?l.value:i.tci(1,t,e,r)[1]-1},e.CORREL=function(t,e){return t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e)?l.value:i.corrcoeff(t,e)},e.COUNT=function(){return a.numbers(a.flatten(arguments)).length},e.COUNTA=function(){var t=a.flatten(arguments);return t.length-e.COUNTBLANK(t)},e.COUNTIN=function(t,e){var r=0;t=a.flatten(t);for(var n=0;n<t.length;n++)t[n]===e&&r++;return r},e.COUNTBLANK=function(){for(var t,e=a.flatten(arguments),r=0,n=0;n<e.length;n++)null!==(t=e[n])&&""!==t||r++;return r},e.COUNTIF=function(t,e){if(t=a.flatten(t),void 0===e||"*"===e)return t.length;for(var r=0,n=u.parse(e+""),o=0;o<t.length;o++){var i=t[o],l=[u.createToken(i,u.TOKEN_TYPE_LITERAL)].concat(n);u.compute(l)&&r++}return r},e.COUNTIFS=function(){for(var t=a.argsToArray(arguments),e=new Array(a.flatten(t[0]).length),r=0;r<e.length;r++)e[r]=!0;for(r=0;r<t.length;r+=2){var n=a.flatten(t[r]),o=t[r+1],i=void 0===o||"*"===o;if(!i)for(var l=u.parse(o+""),c=0;c<n.length;c++){var s=n[c],f=[u.createToken(s,u.TOKEN_TYPE_LITERAL)].concat(l);e[c]=e[c]&&u.compute(f)}}var h=0;for(r=0;r<e.length;r++)e[r]&&h++;return h},e.COUNTUNIQUE=function(){return c.UNIQUE.apply(null,a.flatten(arguments)).length},e.COVARIANCE={},e.COVARIANCE.P=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var r=i.mean(t),n=i.mean(e),o=0,u=t.length,c=0;c<u;c++)o+=(t[c]-r)*(e[c]-n);return o/u},e.COVARIANCE.S=function(t,e){return t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e)?l.value:i.covariance(t,e)},e.DEVSQ=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=i.mean(t),r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e,2);return r},e.EXPON={},e.EXPON.DIST=function(t,e,r){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:r?i.exponential.cdf(t,e):i.exponential.pdf(t,e)},e.F={},e.F.DIST=function(t,e,r,n){return t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r)?l.value:n?i.centralF.cdf(t,e,r):i.centralF.pdf(t,e,r)},e.F.DIST.RT=function(t,e,r){return 3!==arguments.length?l.na:t<0||e<1||r<1?l.num:"number"!=typeof t||"number"!=typeof e||"number"!=typeof r?l.value:1-i.centralF.cdf(t,e,r)},e.F.INV=function(t,e,r){return t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r)?l.value:t<=0||t>1?l.num:i.centralF.inv(t,e,r)},e.F.INV.RT=function(t,e,r){return 3!==arguments.length?l.na:t<0||t>1||e<1||e>Math.pow(10,10)||r<1||r>Math.pow(10,10)?l.num:"number"!=typeof t||"number"!=typeof e||"number"!=typeof r?l.value:i.centralF.inv(1-t,e,r)},e.F.TEST=function(t,e){if(!t||!e)return l.na;if(!(t instanceof Array&&e instanceof Array))return l.na;if(t.length<2||e.length<2)return l.div0;var r=function(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e,2);return r},o=n.SUM(t)/t.length,i=n.SUM(e)/e.length;return r(t,o)/(t.length-1)/(r(e,i)/(e.length-1))},e.FISHER=function(t){return(t=a.parseNumber(t))instanceof Error?t:Math.log((1+t)/(1-t))/2},e.FISHERINV=function(t){if((t=a.parseNumber(t))instanceof Error)return t;var e=Math.exp(2*t);return(e-1)/(e+1)},e.FORECAST=function(t,e,r){if(t=a.parseNumber(t),e=a.parseNumberArray(a.flatten(e)),r=a.parseNumberArray(a.flatten(r)),a.anyIsError(t,e,r))return l.value;for(var n=i.mean(r),o=i.mean(e),u=r.length,c=0,s=0,f=0;f<u;f++)c+=(r[f]-n)*(e[f]-o),s+=Math.pow(r[f]-n,2);var h=c/s;return o-h*n+h*t},e.FREQUENCY=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var r=t.length,n=e.length,o=[],i=0;i<=n;i++){o[i]=0;for(var u=0;u<r;u++)0===i?t[u]<=e[0]&&(o[0]+=1):i<n?t[u]>e[i-1]&&t[u]<=e[i]&&(o[i]+=1):i===n&&t[u]>e[n-1]&&(o[n]+=1)}return o},e.GAMMA=function(t){return(t=a.parseNumber(t))instanceof Error?t:0===t||parseInt(t,10)===t&&t<0?l.num:i.gammafn(t)},e.GAMMA.DIST=function(t,e,r,n){return 4!==arguments.length?l.na:t<0||e<=0||r<=0||"number"!=typeof t||"number"!=typeof e||"number"!=typeof r?l.value:n?i.gamma.cdf(t,e,r,!0):i.gamma.pdf(t,e,r,!1)},e.GAMMA.INV=function(t,e,r){return 3!==arguments.length?l.na:t<0||t>1||e<=0||r<=0?l.num:"number"!=typeof t||"number"!=typeof e||"number"!=typeof r?l.value:i.gamma.inv(t,e,r)},e.GAMMALN=function(t){return(t=a.parseNumber(t))instanceof Error?t:i.gammaln(t)},e.GAMMALN.PRECISE=function(t){return 1!==arguments.length?l.na:t<=0?l.num:"number"!=typeof t?l.value:i.gammaln(t)},e.GAUSS=function(t){return(t=a.parseNumber(t))instanceof Error?t:i.normal.cdf(t,0,1)-.5},e.GEOMEAN=function(){var t=a.parseNumberArray(a.flatten(arguments));return t instanceof Error?t:i.geomean(t)},e.GROWTH=function(t,e,r,n){if((t=a.parseNumberArray(t))instanceof Error)return t;var o;if(void 0===e)for(e=[],o=1;o<=t.length;o++)e.push(o);if(void 0===r)for(r=[],o=1;o<=t.length;o++)r.push(o);if(e=a.parseNumberArray(e),r=a.parseNumberArray(r),a.anyIsError(e,r))return l.value;void 0===n&&(n=!0);var i,u,c=t.length,s=0,f=0,h=0,p=0;for(o=0;o<c;o++){var y=e[o],v=Math.log(t[o]);s+=y,f+=v,h+=y*v,p+=y*y}s/=c,f/=c,h/=c,p/=c,n?u=f-(i=(h-s*f)/(p-s*s))*s:(i=h/p,u=0);var b=[];for(o=0;o<r.length;o++)b.push(Math.exp(u+i*r[o]));return b},e.HARMEAN=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=t.length,r=0,n=0;n<e;n++)r+=1/t[n];return e/r},e.HYPGEOM={},e.HYPGEOM.DIST=function(t,e,r,o,i){if(t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),o=a.parseNumber(o),a.anyIsError(t,e,r,o))return l.value;function u(t,e,r,o){return n.COMBIN(r,t)*n.COMBIN(o-r,e-t)/n.COMBIN(o,e)}return i?function(t,e,r,n){for(var o=0,i=0;i<=t;i++)o+=u(i,e,r,n);return o}(t,e,r,o):u(t,e,r,o)},e.INTERCEPT=function(t,r){return t=a.parseNumberArray(t),r=a.parseNumberArray(r),a.anyIsError(t,r)?l.value:t.length!==r.length?l.na:e.FORECAST(0,t,r)},e.KURT=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=i.mean(t),r=t.length,n=0,o=0;o<r;o++)n+=Math.pow(t[o]-e,4);return r*(r+1)/((r-1)*(r-2)*(r-3))*(n/=Math.pow(i.stdev(t,!0),4))-3*(r-1)*(r-1)/((r-2)*(r-3))},e.LARGE=function(t,e){return t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e)?t:t.sort((function(t,e){return e-t}))[e-1]},e.LINEST=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var r=i.mean(t),n=i.mean(e),o=e.length,u=0,c=0,s=0;s<o;s++)u+=(e[s]-n)*(t[s]-r),c+=Math.pow(e[s]-n,2);var f=u/c;return[f,r-f*n]},e.LOGEST=function(t,r){if(t=a.parseNumberArray(a.flatten(t)),r=a.parseNumberArray(a.flatten(r)),a.anyIsError(t,r))return l.value;for(var n=0;n<t.length;n++)t[n]=Math.log(t[n]);var o=e.LINEST(t,r);return o[0]=Math.round(1e6*Math.exp(o[0]))/1e6,o[1]=Math.round(1e6*Math.exp(o[1]))/1e6,o},e.LOGNORM={},e.LOGNORM.DIST=function(t,e,r,n){return t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r)?l.value:n?i.lognormal.cdf(t,e,r):i.lognormal.pdf(t,e,r)},e.LOGNORM.INV=function(t,e,r){return t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r)?l.value:i.lognormal.inv(t,e,r)},e.MAX=function(){var t=a.numbers(a.flatten(arguments));return 0===t.length?0:Math.max.apply(Math,t)},e.MAXA=function(){var t=a.arrayValuesToNumbers(a.flatten(arguments));return 0===t.length?0:Math.max.apply(Math,t)},e.MEDIAN=function(){var t=a.arrayValuesToNumbers(a.flatten(arguments)),e=i.median(t);return isNaN(e)&&(e=l.num),e},e.MIN=function(){var t=a.numbers(a.flatten(arguments));return 0===t.length?0:Math.min.apply(Math,t)},e.MINA=function(){var t=a.arrayValuesToNumbers(a.flatten(arguments));return 0===t.length?0:Math.min.apply(Math,t)},e.MODE={},e.MODE.MULT=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e,r=t.length,n={},o=[],i=0,u=0;u<r;u++)n[e=t[u]]=n[e]?n[e]+1:1,n[e]>i&&(i=n[e],o=[]),n[e]===i&&(o[o.length]=e);return o},e.MODE.SNGL=function(){var t=a.parseNumberArray(a.flatten(arguments));return t instanceof Error?t:e.MODE.MULT(t).sort((function(t,e){return t-e}))[0]},e.NEGBINOM={},e.NEGBINOM.DIST=function(t,e,r,n){return t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r)?l.value:n?i.negbin.cdf(t,e,r):i.negbin.pdf(t,e,r)},e.NORM={},e.NORM.DIST=function(t,e,r,n){return t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r)?l.value:r<=0?l.num:n?i.normal.cdf(t,e,r):i.normal.pdf(t,e,r)},e.NORM.INV=function(t,e,r){return t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r)?l.value:i.normal.inv(t,e,r)},e.NORM.S={},e.NORM.S.DIST=function(t,e){return(t=a.parseNumber(t))instanceof Error?l.value:e?i.normal.cdf(t,0,1):i.normal.pdf(t,0,1)},e.NORM.S.INV=function(t){return(t=a.parseNumber(t))instanceof Error?l.value:i.normal.inv(t,0,1)},e.PEARSON=function(t,e){if(e=a.parseNumberArray(a.flatten(e)),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t))return l.value;for(var r=i.mean(t),n=i.mean(e),o=t.length,u=0,c=0,s=0,f=0;f<o;f++)u+=(t[f]-r)*(e[f]-n),c+=Math.pow(t[f]-r,2),s+=Math.pow(e[f]-n,2);return u/Math.sqrt(c*s)},e.PERCENTILE={},e.PERCENTILE.EXC=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e))return l.value;var r=(t=t.sort((function(t,e){return t-e}))).length;if(e<1/(r+1)||e>1-1/(r+1))return l.num;var n=e*(r+1)-1,o=Math.floor(n);return a.cleanFloat(n===o?t[n]:t[o]+(n-o)*(t[o+1]-t[o]))},e.PERCENTILE.INC=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e))return l.value;var r=e*((t=t.sort((function(t,e){return t-e}))).length-1),n=Math.floor(r);return a.cleanFloat(r===n?t[r]:t[n]+(r-n)*(t[n+1]-t[n]))},e.PERCENTRANK={},e.PERCENTRANK.EXC=function(t,e,r){if(r=void 0===r?3:r,t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r))return l.value;t=t.sort((function(t,e){return t-e}));for(var n=c.UNIQUE.apply(null,t),o=t.length,i=n.length,u=Math.pow(10,r),s=0,f=!1,h=0;!f&&h<i;)e===n[h]?(s=(t.indexOf(n[h])+1)/(o+1),f=!0):e>=n[h]&&(e<n[h+1]||h===i-1)&&(s=(t.indexOf(n[h])+1+(e-n[h])/(n[h+1]-n[h]))/(o+1),f=!0),h++;return Math.floor(s*u)/u},e.PERCENTRANK.INC=function(t,e,r){if(r=void 0===r?3:r,t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r))return l.value;t=t.sort((function(t,e){return t-e}));for(var n=c.UNIQUE.apply(null,t),o=t.length,i=n.length,u=Math.pow(10,r),s=0,f=!1,h=0;!f&&h<i;)e===n[h]?(s=t.indexOf(n[h])/(o-1),f=!0):e>=n[h]&&(e<n[h+1]||h===i-1)&&(s=(t.indexOf(n[h])+(e-n[h])/(n[h+1]-n[h]))/(o-1),f=!0),h++;return Math.floor(s*u)/u},e.PERMUT=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:n.FACT(t)/n.FACT(t-e)},e.PERMUTATIONA=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:Math.pow(t,e)},e.PHI=function(t){return(t=a.parseNumber(t))instanceof Error?l.value:Math.exp(-.5*t*t)/2.5066282746310002},e.POISSON={},e.POISSON.DIST=function(t,e,r){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:r?i.poisson.cdf(t,e):i.poisson.pdf(t,e)},e.PROB=function(t,e,r,n){if(void 0===r)return 0;if(n=void 0===n?r:n,t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),r=a.parseNumber(r),n=a.parseNumber(n),a.anyIsError(t,e,r,n))return l.value;if(r===n)return t.indexOf(r)>=0?e[t.indexOf(r)]:0;for(var o=t.sort((function(t,e){return t-e})),i=o.length,u=0,c=0;c<i;c++)o[c]>=r&&o[c]<=n&&(u+=e[t.indexOf(o[c])]);return u},e.QUARTILE={},e.QUARTILE.EXC=function(t,r){if(t=a.parseNumberArray(a.flatten(t)),r=a.parseNumber(r),a.anyIsError(t,r))return l.value;switch(r){case 1:return e.PERCENTILE.EXC(t,.25);case 2:return e.PERCENTILE.EXC(t,.5);case 3:return e.PERCENTILE.EXC(t,.75);default:return l.num}},e.QUARTILE.INC=function(t,r){if(t=a.parseNumberArray(a.flatten(t)),r=a.parseNumber(r),a.anyIsError(t,r))return l.value;switch(r){case 1:return e.PERCENTILE.INC(t,.25);case 2:return e.PERCENTILE.INC(t,.5);case 3:return e.PERCENTILE.INC(t,.75);default:return l.num}},e.RANK={},e.RANK.AVG=function(t,e,r){if(t=a.parseNumber(t),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var n=(r=r||!1)?function(t,e){return t-e}:function(t,e){return e-t},o=(e=(e=a.flatten(e)).sort(n)).length,i=0,u=0;u<o;u++)e[u]===t&&i++;return i>1?(2*e.indexOf(t)+i+1)/2:e.indexOf(t)+1},e.RANK.EQ=function(t,e,r){if(t=a.parseNumber(t),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;var n=(r=r||!1)?function(t,e){return t-e}:function(t,e){return e-t};return(e=e.sort(n)).indexOf(t)+1},e.ROW=function(t,e){return 2!==arguments.length?l.na:e<0?l.num:t instanceof Array&&"number"==typeof e?0!==t.length?i.row(t,e):void 0:l.value},e.ROWS=function(t){return 1!==arguments.length?l.na:t instanceof Array?0===t.length?0:i.rows(t):l.value},e.RSQ=function(t,r){return t=a.parseNumberArray(a.flatten(t)),r=a.parseNumberArray(a.flatten(r)),a.anyIsError(t,r)?l.value:Math.pow(e.PEARSON(t,r),2)},e.SKEW=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=i.mean(t),r=t.length,n=0,o=0;o<r;o++)n+=Math.pow(t[o]-e,3);return r*n/((r-1)*(r-2)*Math.pow(i.stdev(t,!0),3))},e.SKEW.P=function(){var t=a.parseNumberArray(a.flatten(arguments));if(t instanceof Error)return t;for(var e=i.mean(t),r=t.length,n=0,o=0,u=0;u<r;u++)o+=Math.pow(t[u]-e,3),n+=Math.pow(t[u]-e,2);return n/=r,(o/=r)/Math.pow(n,1.5)},e.SLOPE=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var r=i.mean(e),n=i.mean(t),o=e.length,u=0,c=0,s=0;s<o;s++)u+=(e[s]-r)*(t[s]-n),c+=Math.pow(e[s]-r,2);return u/c},e.SMALL=function(t,e){return t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e)?t:t.sort((function(t,e){return t-e}))[e-1]},e.STANDARDIZE=function(t,e,r){return t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r)?l.value:(t-e)/r},e.STDEV={},e.STDEV.P=function(){var t=e.VAR.P.apply(this,arguments),r=Math.sqrt(t);return isNaN(r)&&(r=l.num),r},e.STDEV.S=function(){var t=e.VAR.S.apply(this,arguments),r=Math.sqrt(t);return r},e.STDEVA=function(){var t=e.VARA.apply(this,arguments),r=Math.sqrt(t);return r},e.STDEVPA=function(){var t=e.VARPA.apply(this,arguments),r=Math.sqrt(t);return isNaN(r)&&(r=l.num),r},e.STEYX=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var r=i.mean(e),n=i.mean(t),o=e.length,u=0,c=0,s=0,f=0;f<o;f++)u+=Math.pow(t[f]-n,2),c+=(e[f]-r)*(t[f]-n),s+=Math.pow(e[f]-r,2);return Math.sqrt((u-c*c/s)/(o-2))},e.TRANSPOSE=function(t){return t?i.transpose(t):l.na},e.T=o.T,e.T.DIST=function(t,e,r){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:r?i.studentt.cdf(t,e):i.studentt.pdf(t,e)},e.T.DIST["2T"]=function(t,e){return 2!==arguments.length?l.na:t<0||e<1?l.num:"number"!=typeof t||"number"!=typeof e?l.value:2*(1-i.studentt.cdf(t,e))},e.T.DIST.RT=function(t,e){return 2!==arguments.length?l.na:t<0||e<1?l.num:"number"!=typeof t||"number"!=typeof e?l.value:1-i.studentt.cdf(t,e)},e.T.INV=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?l.value:i.studentt.inv(t,e)},e.T.INV["2T"]=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),t<=0||t>1||e<1?l.num:a.anyIsError(t,e)?l.value:Math.abs(i.studentt.inv(t/2,e))},e.T.TEST=function(t,r){if(t=a.parseNumberArray(a.flatten(t)),r=a.parseNumberArray(a.flatten(r)),a.anyIsError(t,r))return l.value;var n,o=i.mean(t),u=i.mean(r),c=0,s=0;for(n=0;n<t.length;n++)c+=Math.pow(t[n]-o,2);for(n=0;n<r.length;n++)s+=Math.pow(r[n]-u,2);c/=t.length-1,s/=r.length-1;var f=Math.abs(o-u)/Math.sqrt(c/t.length+s/r.length);return e.T.DIST["2T"](f,t.length+r.length-2)},e.TREND=function(t,r,n){if(t=a.parseNumberArray(a.flatten(t)),r=a.parseNumberArray(a.flatten(r)),n=a.parseNumberArray(a.flatten(n)),a.anyIsError(t,r,n))return l.value;var o=e.LINEST(t,r),i=o[0],u=o[1],c=[];return n.forEach((function(t){c.push(i*t+u)})),c},e.TRIMMEAN=function(t,e){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumber(e),a.anyIsError(t,e))return l.value;var r=n.FLOOR(t.length*e,2)/2;return i.mean(a.initial(a.rest(t.sort((function(t,e){return t-e})),r),r))},e.VAR={},e.VAR.P=function(){for(var t,r=a.numbers(a.flatten(arguments)),n=r.length,o=0,i=e.AVERAGE(r),u=0;u<n;u++)o+=Math.pow(r[u]-i,2);return t=o/n,isNaN(t)&&(t=l.num),t},e.VAR.S=function(){for(var t=a.numbers(a.flatten(arguments)),r=t.length,n=0,o=e.AVERAGE(t),i=0;i<r;i++)n+=Math.pow(t[i]-o,2);return n/(r-1)},e.VARA=function(){for(var t=a.flatten(arguments),r=t.length,n=0,o=0,i=e.AVERAGEA(t),u=0;u<r;u++){var l=t[u];n+="number"==typeof l?Math.pow(l-i,2):!0===l?Math.pow(1-i,2):Math.pow(0-i,2),null!==l&&o++}return n/(o-1)},e.VARPA=function(){for(var t,r=a.flatten(arguments),n=r.length,o=0,i=0,u=e.AVERAGEA(r),c=0;c<n;c++){var s=r[c];o+="number"==typeof s?Math.pow(s-u,2):!0===s?Math.pow(1-u,2):Math.pow(0-u,2),null!==s&&i++}return t=o/i,isNaN(t)&&(t=l.num),t},e.WEIBULL={},e.WEIBULL.DIST=function(t,e,r,n){return t=a.parseNumber(t),e=a.parseNumber(e),r=a.parseNumber(r),a.anyIsError(t,e,r)?l.value:n?1-Math.exp(-Math.pow(t/r,e)):Math.pow(t,e-1)*Math.exp(-Math.pow(t/r,e))*e/Math.pow(r,e)},e.Z={},e.Z.TEST=function(t,r,n){if(t=a.parseNumberArray(a.flatten(t)),r=a.parseNumber(r),a.anyIsError(t,r))return l.value;n=n||e.STDEV.S(t);var o=t.length;return 1-e.NORM.S.DIST((e.AVERAGE(t)-r)/(n/Math.sqrt(o)),!0)}},function(t,e,r){var n=r(1),o=r(0);e.ASC=function(){throw new Error("ASC is not implemented")},e.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},e.CHAR=function(t){return(t=n.parseNumber(t))instanceof Error?t:String.fromCharCode(t)},e.CLEAN=function(t){return(t=t||"").replace(/[\0-\x1F]/g,"")},e.CODE=function(t){var e=(t=t||"").charCodeAt(0);return isNaN(e)&&(e=o.na),e},e.CONCATENATE=function(){for(var t=n.flatten(arguments),e=0;(e=t.indexOf(!0))>-1;)t[e]="TRUE";for(var r=0;(r=t.indexOf(!1))>-1;)t[r]="FALSE";return t.join("")},e.DBCS=function(){throw new Error("DBCS is not implemented")},e.DOLLAR=function(){throw new Error("DOLLAR is not implemented")},e.EXACT=function(t,e){return 2!==arguments.length?o.na:t===e},e.FIND=function(t,e,r){return arguments.length<2?o.na:(r=void 0===r?0:r,e?e.indexOf(t,r-1)+1:null)},e.FIXED=function(){throw new Error("FIXED is not implemented")},e.HTML2TEXT=function(t){var e="";return t&&(t instanceof Array?t.forEach((function(t){""!==e&&(e+="\n"),e+=t.replace(/<(?:.|\n)*?>/gm,"")})):e=t.replace(/<(?:.|\n)*?>/gm,"")),e},e.LEFT=function(t,e){return e=void 0===e?1:e,(e=n.parseNumber(e))instanceof Error||"string"!=typeof t?o.value:t?t.substring(0,e):null},e.LEN=function(t){return 0===arguments.length?o.error:"string"==typeof t?t?t.length:0:t.length?t.length:o.value},e.LOWER=function(t){return"string"!=typeof t?o.value:t?t.toLowerCase():t},e.MID=function(t,e,r){if(e=n.parseNumber(e),r=n.parseNumber(r),n.anyIsError(e,r)||"string"!=typeof t)return r;var o=e-1,i=o+r;return t.substring(o,i)},e.NUMBERVALUE=function(t,e,r){return e=void 0===e?".":e,r=void 0===r?",":r,Number(t.replace(e,".").replace(r,""))},e.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},e.PROPER=function(t){return void 0===t||0===t.length?o.value:(!0===t&&(t="TRUE"),!1===t&&(t="FALSE"),isNaN(t)&&"number"==typeof t?o.value:("number"==typeof t&&(t=""+t),t.replace(/\w\S*/g,(function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()}))))},e.REGEXEXTRACT=function(t,e){if(arguments.length<2)return o.na;var r=t.match(new RegExp(e));return r?r[r.length>1?r.length-1:0]:null},e.REGEXMATCH=function(t,e,r){if(arguments.length<2)return o.na;var n=t.match(new RegExp(e));return r?n:!!n},e.REGEXREPLACE=function(t,e,r){return arguments.length<3?o.na:t.replace(new RegExp(e),r)},e.REPLACE=function(t,e,r,i){return e=n.parseNumber(e),r=n.parseNumber(r),n.anyIsError(e,r)||"string"!=typeof t||"string"!=typeof i?o.value:t.substr(0,e-1)+i+t.substr(e-1+r)},e.REPT=function(t,e){return(e=n.parseNumber(e))instanceof Error?e:new Array(e+1).join(t)},e.RIGHT=function(t,e){return e=void 0===e?1:e,(e=n.parseNumber(e))instanceof Error?e:t?t.substring(t.length-e):o.na},e.SEARCH=function(t,e,r){var n;return"string"!=typeof t||"string"!=typeof e?o.value:(r=void 0===r?0:r,0===(n=e.toLowerCase().indexOf(t.toLowerCase(),r-1)+1)?o.value:n)},e.SPLIT=function(t,e){return t.split(e)},e.SUBSTITUTE=function(t,e,r,n){if(arguments.length<2)return o.na;if(!(t&&e&&r))return t;if(void 0===n)return t.replace(new RegExp(e,"g"),r);for(var i=0,a=0;t.indexOf(e,i)>0;)if(i=t.indexOf(e,i+1),++a===n)return t.substring(0,i)+r+t.substring(i+e.length)},e.T=function(t){return"string"==typeof t?t:""},e.TEXT=function(){throw new Error("TEXT is not implemented")},e.TRIM=function(t){return"string"!=typeof t?o.value:t.replace(/ +/g," ").trim()},e.UNICHAR=e.CHAR,e.UNICODE=e.CODE,e.UPPER=function(t){return"string"!=typeof t?o.value:t.toUpperCase()},e.VALUE=function(){throw new Error("VALUE is not implemented")}},function(t,e){var r=[">",">=","<","<=","=","<>"],n=["operator","literal"];function o(t,e){if(-1===n.indexOf(e))throw new Error("Unsupported token type: "+e);return{value:t,type:e}}function i(t){for(var e,n="",i=[],a=0;a<t.length;a++){var u=t[a];0===a&&r.indexOf(u)>=0?i.push(o(u,"operator")):n+=u}return n.length>0&&i.push(o(("string"!=typeof(e=n)||/^\d+(\.\d+)?$/.test(e)&&(e=-1===e.indexOf(".")?parseInt(e,10):parseFloat(e)),e),"literal")),i.length>0&&"operator"!==i[0].type&&i.unshift(o("=","operator")),i}e.TOKEN_TYPE_OPERATOR="operator",e.TOKEN_TYPE_LITERAL="literal",e.parse=function(t){return i(function(t){for(var e=t.length,r=[],n=0,o="",i="";n<e;){var a=t.charAt(n);switch(a){case">":case"<":case"=":i+=a,o.length>0&&(r.push(o),o="");break;default:i.length>0&&(r.push(i),i=""),o+=a}n++}return o.length>0&&r.push(o),i.length>0&&r.push(i),r}(t))},e.createToken=o,e.compute=function(t){for(var e,r=[],n=0;n<t.length;n++){var o=t[n];switch(o.type){case"operator":e=o.value;break;case"literal":r.push(o.value)}}return function(t,e){var r=!1;switch(e){case">":r=t[0]>t[1];break;case">=":r=t[0]>=t[1];break;case"<":r=t[0]<t[1];break;case"<=":r=t[0]<=t[1];break;case"=":r=t[0]==t[1];break;case"<>":r=t[0]!=t[1]}return r}(r,e)}},function(t,e,r){var n=r(0);e.CELL=function(){throw new Error("CELL is not implemented")},e.ERROR={},e.ERROR.TYPE=function(t){switch(t){case n.nil:return 1;case n.div0:return 2;case n.value:return 3;case n.ref:return 4;case n.name:return 5;case n.num:return 6;case n.na:return 7;case n.data:return 8}return n.na},e.INFO=function(){throw new Error("INFO is not implemented")},e.ISBLANK=function(t){return null===t},e.ISBINARY=function(t){return/^[01]{1,10}$/.test(t)},e.ISERR=function(t){return[n.value,n.ref,n.div0,n.num,n.name,n.nil].indexOf(t)>=0||"number"==typeof t&&(isNaN(t)||!isFinite(t))},e.ISERROR=function(t){return e.ISERR(t)||t===n.na},e.ISEVEN=function(t){return!(1&Math.floor(Math.abs(t)))},e.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},e.ISLOGICAL=function(t){return!0===t||!1===t},e.ISNA=function(t){return t===n.na},e.ISNONTEXT=function(t){return"string"!=typeof t},e.ISNUMBER=function(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)},e.ISODD=function(t){return!!(1&Math.floor(Math.abs(t)))},e.ISREF=function(){throw new Error("ISREF is not implemented")},e.ISTEXT=function(t){return"string"==typeof t},e.N=function(t){return this.ISNUMBER(t)?t:t instanceof Date?t.getTime():!0===t?1:!1===t?0:this.ISERROR(t)?t:0},e.NA=function(){return n.na},e.SHEET=function(){throw new Error("SHEET is not implemented")},e.SHEETS=function(){throw new Error("SHEETS is not implemented")},e.TYPE=function(t){return this.ISNUMBER(t)?1:this.ISTEXT(t)?2:this.ISLOGICAL(t)?4:this.ISERROR(t)?16:Array.isArray(t)?64:void 0}},function(t,e,r){var n=r(0),o=r(1),i=new Date(Date.UTC(1900,0,1)),a=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],u=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],l=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function c(t){return 1===new Date(t,1,29).getMonth()}function s(t,e){return Math.ceil((e-t)/1e3/60/60/24)}function f(t){var e=t>-22038912e5?2:1;return Math.ceil((t-i)/864e5)+e}e.DATE=function(t,e,r){return t=o.parseNumber(t),e=o.parseNumber(e),r=o.parseNumber(r),o.anyIsError(t,e,r)?n.value:t<0||e<0||r<0?n.num:new Date(t,e-1,r)},e.DATEVALUE=function(t){var e,r=2;return"string"!=typeof t?n.value:(e=Date.parse(t),isNaN(e)?n.value:(e<=-22038912e5&&(r=1),Math.ceil((e-i)/864e5)+r))},e.DAY=function(t){var e=o.parseDate(t);return e instanceof Error?e:e.getDate()},e.DAYS=function(t,e){return t=o.parseDate(t),e=o.parseDate(e),t instanceof Error?t:e instanceof Error?e:f(t)-f(e)},e.DAYS360=function(t,e,r){if(r=o.parseBool(r),t=o.parseDate(t),e=o.parseDate(e),t instanceof Error)return t;if(e instanceof Error)return e;if(r instanceof Error)return r;var n,i,a=t.getMonth(),u=e.getMonth();if(r)n=31===t.getDate()?30:t.getDate(),i=31===e.getDate()?30:e.getDate();else{var l=new Date(t.getFullYear(),a+1,0).getDate(),c=new Date(e.getFullYear(),u+1,0).getDate();n=t.getDate()===l?30:t.getDate(),e.getDate()===c?n<30?(u++,i=1):i=30:i=e.getDate()}return 360*(e.getFullYear()-t.getFullYear())+30*(u-a)+(i-n)},e.EDATE=function(t,e){return(t=o.parseDate(t))instanceof Error?t:isNaN(e)?n.value:(e=parseInt(e,10),t.setMonth(t.getMonth()+e),f(t))},e.EOMONTH=function(t,e){return(t=o.parseDate(t))instanceof Error?t:isNaN(e)?n.value:(e=parseInt(e,10),f(new Date(t.getFullYear(),t.getMonth()+e+1,0)))},e.HOUR=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getHours()},e.INTERVAL=function(t){if("number"!=typeof t&&"string"!=typeof t)return n.value;t=parseInt(t,10);var e=Math.floor(t/94608e4);t%=94608e4;var r=Math.floor(t/2592e3);t%=2592e3;var o=Math.floor(t/86400);t%=86400;var i=Math.floor(t/3600);t%=3600;var a=Math.floor(t/60),u=t%=60;return"P"+(e=e>0?e+"Y":"")+(r=r>0?r+"M":"")+(o=o>0?o+"D":"")+"T"+(i=i>0?i+"H":"")+(a=a>0?a+"M":"")+(u=u>0?u+"S":"")},e.ISOWEEKNUM=function(t){if((t=o.parseDate(t))instanceof Error)return t;t.setHours(0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7));var e=new Date(t.getFullYear(),0,1);return Math.ceil(((t-e)/864e5+1)/7)},e.MINUTE=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getMinutes()},e.MONTH=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getMonth()+1},e.NETWORKDAYS=function(t,e,r){return this.NETWORKDAYS.INTL(t,e,1,r)},e.NETWORKDAYS.INTL=function(t,e,r,i){if((t=o.parseDate(t))instanceof Error)return t;if((e=o.parseDate(e))instanceof Error)return e;if(!((r=void 0===r?l[1]:l[r])instanceof Array))return n.value;void 0===i?i=[]:i instanceof Array||(i=[i]);for(var a=0;a<i.length;a++){var u=o.parseDate(i[a]);if(u instanceof Error)return u;i[a]=u}var c=(e-t)/864e5+1,s=c,f=t;for(a=0;a<c;a++){var h=(new Date).getTimezoneOffset()>0?f.getUTCDay():f.getDay(),p=!1;h!==r[0]&&h!==r[1]||(p=!0);for(var y=0;y<i.length;y++){var v=i[y];if(v.getDate()===f.getDate()&&v.getMonth()===f.getMonth()&&v.getFullYear()===f.getFullYear()){p=!0;break}}p&&s--,f.setDate(f.getDate()+1)}return s},e.NOW=function(){return new Date},e.SECOND=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getSeconds()},e.TIME=function(t,e,r){return t=o.parseNumber(t),e=o.parseNumber(e),r=o.parseNumber(r),o.anyIsError(t,e,r)?n.value:t<0||e<0||r<0?n.num:(3600*t+60*e+r)/86400},e.TIMEVALUE=function(t){return(t=o.parseDate(t))instanceof Error?t:(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},e.TODAY=function(){return new Date},e.WEEKDAY=function(t,e){if((t=o.parseDate(t))instanceof Error)return t;void 0===e&&(e=1);var r=t.getDay();return u[e][r]},e.WEEKNUM=function(t,e){if((t=o.parseDate(t))instanceof Error)return t;if(void 0===e&&(e=1),21===e)return this.ISOWEEKNUM(t);var r=a[e],n=new Date(t.getFullYear(),0,1),i=n.getDay()<r?1:0;return n-=24*Math.abs(n.getDay()-r)*60*60*1e3,Math.floor((t-n)/864e5/7+1)+i},e.WORKDAY=function(t,e,r){return this.WORKDAY.INTL(t,e,1,r)},e.WORKDAY.INTL=function(t,e,r,i){if((t=o.parseDate(t))instanceof Error)return t;if((e=o.parseNumber(e))instanceof Error)return e;if(e<0)return n.num;if(!((r=void 0===r?l[1]:l[r])instanceof Array))return n.value;void 0===i?i=[]:i instanceof Array||(i=[i]);for(var a=0;a<i.length;a++){var u=o.parseDate(i[a]);if(u instanceof Error)return u;i[a]=u}for(var c=0;c<e;){t.setDate(t.getDate()+1);var s=t.getDay();if(s!==r[0]&&s!==r[1]){for(var f=0;f<i.length;f++){var h=i[f];if(h.getDate()===t.getDate()&&h.getMonth()===t.getMonth()&&h.getFullYear()===t.getFullYear()){c--;break}}c++}}return t},e.YEAR=function(t){return(t=o.parseDate(t))instanceof Error?t:t.getFullYear()},e.YEARFRAC=function(t,e,r){if((t=o.parseDate(t))instanceof Error)return t;if((e=o.parseDate(e))instanceof Error)return e;r=r||0;var n=t.getDate(),i=t.getMonth()+1,a=t.getFullYear(),u=e.getDate(),l=e.getMonth()+1,f=e.getFullYear();switch(r){case 0:return 31===n&&31===u?(n=30,u=30):31===n?n=30:30===n&&31===u&&(u=30),(u+30*l+360*f-(n+30*i+360*a))/360;case 1:var h=365;if(a===f||a+1===f&&(i>l||i===l&&n>=u))return(a===f&&c(a)||function(t,e){var r=t.getFullYear(),n=new Date(r,2,1);if(c(r)&&t<n&&e>=n)return!0;var o=e.getFullYear(),i=new Date(o,2,1);return c(o)&&e>=i&&t<i}(t,e)||1===l&&29===u)&&(h=366),s(t,e)/h;var p=f-a+1,y=(new Date(f+1,0,1)-new Date(a,0,1))/1e3/60/60/24/p;return s(t,e)/y;case 2:return s(t,e)/360;case 3:return s(t,e)/365;case 4:return(u+30*l+360*f-(n+30*i+360*a))/360}}},function(t,e){},function(t,e,r){var n;t.exports=(function(t,e){var r=t.utils.isFunction;function n(t,e){return t-e}function o(t,r,n){return e.max(r,e.min(t,n))}t.sum=function(t){for(var e=0,r=t.length;--r>=0;)e+=t[r];return e},t.sumsqrd=function(t){for(var e=0,r=t.length;--r>=0;)e+=t[r]*t[r];return e},t.sumsqerr=function(e){for(var r,n=t.mean(e),o=0,i=e.length;--i>=0;)o+=(r=e[i]-n)*r;return o},t.sumrow=function(t){for(var e=0,r=t.length;--r>=0;)e+=t[r];return e},t.product=function(t){for(var e=1,r=t.length;--r>=0;)e*=t[r];return e},t.min=function(t){for(var e=t[0],r=0;++r<t.length;)t[r]<e&&(e=t[r]);return e},t.max=function(t){for(var e=t[0],r=0;++r<t.length;)t[r]>e&&(e=t[r]);return e},t.unique=function(t){for(var e={},r=[],n=0;n<t.length;n++)e[t[n]]||(e[t[n]]=!0,r.push(t[n]));return r},t.mean=function(e){return t.sum(e)/e.length},t.meansqerr=function(e){return t.sumsqerr(e)/e.length},t.geomean=function(r){var n=r.map(e.log),o=t.mean(n);return e.exp(o)},t.median=function(t){var e=t.length,r=t.slice().sort(n);return 1&e?r[e/2|0]:(r[e/2-1]+r[e/2])/2},t.cumsum=function(e){return t.cumreduce(e,(function(t,e){return t+e}))},t.cumprod=function(e){return t.cumreduce(e,(function(t,e){return t*e}))},t.diff=function(t){var e,r=[],n=t.length;for(e=1;e<n;e++)r.push(t[e]-t[e-1]);return r},t.rank=function(t){var e,r=[],o={};for(e=0;e<t.length;e++)o[l=t[e]]?o[l]++:(o[l]=1,r.push(l));var i=r.sort(n),a={},u=1;for(e=0;e<i.length;e++){var l,c=o[l=i[e]],s=(u+(u+c-1))/2;a[l]=s,u+=c}return t.map((function(t){return a[t]}))},t.mode=function(t){var e,r=t.length,o=t.slice().sort(n),i=1,a=0,u=0,l=[];for(e=0;e<r;e++)o[e]===o[e+1]?i++:(i>a?(l=[o[e]],a=i,u=0):i===a&&(l.push(o[e]),u++),i=1);return 0===u?l[0]:l},t.range=function(e){return t.max(e)-t.min(e)},t.variance=function(e,r){return t.sumsqerr(e)/(e.length-(r?1:0))},t.pooledvariance=function(e){return e.reduce((function(e,r){return e+t.sumsqerr(r)}),0)/(e.reduce((function(t,e){return t+e.length}),0)-e.length)},t.deviation=function(e){for(var r=t.mean(e),n=e.length,o=new Array(n),i=0;i<n;i++)o[i]=e[i]-r;return o},t.stdev=function(r,n){return e.sqrt(t.variance(r,n))},t.pooledstdev=function(r){return e.sqrt(t.pooledvariance(r))},t.meandev=function(r){for(var n=t.mean(r),o=[],i=r.length-1;i>=0;i--)o.push(e.abs(r[i]-n));return t.mean(o)},t.meddev=function(r){for(var n=t.median(r),o=[],i=r.length-1;i>=0;i--)o.push(e.abs(r[i]-n));return t.median(o)},t.coeffvar=function(e){return t.stdev(e)/t.mean(e)},t.quartiles=function(t){var r=t.length,o=t.slice().sort(n);return[o[e.round(r/4)-1],o[e.round(r/2)-1],o[e.round(3*r/4)-1]]},t.quantiles=function(t,r,i,a){var u,l,c,s,f,h=t.slice().sort(n),p=[r.length],y=t.length;for(void 0===i&&(i=3/8),void 0===a&&(a=3/8),u=0;u<r.length;u++)c=y*(l=r[u])+(i+l*(1-i-a)),s=e.floor(o(c,1,y-1)),f=o(c-s,0,1),p[u]=(1-f)*h[s-1]+f*h[s];return p},t.percentile=function(t,e,r){var o=t.slice().sort(n),i=e*(o.length+(r?1:-1))+(r?0:1),a=parseInt(i),u=i-a;return a+1<o.length?o[a-1]+u*(o[a]-o[a-1]):o[a-1]},t.percentileOfScore=function(t,e,r){var n,o,i=0,a=t.length,u=!1;for("strict"===r&&(u=!0),o=0;o<a;o++)n=t[o],(u&&n<e||!u&&n<=e)&&i++;return i/a},t.histogram=function(r,n){n=n||4;var o,i=t.min(r),a=(t.max(r)-i)/n,u=r.length,l=[];for(o=0;o<n;o++)l[o]=0;for(o=0;o<u;o++)l[e.min(e.floor((r[o]-i)/a),n-1)]+=1;return l},t.covariance=function(e,r){var n,o=t.mean(e),i=t.mean(r),a=e.length,u=new Array(a);for(n=0;n<a;n++)u[n]=(e[n]-o)*(r[n]-i);return t.sum(u)/(a-1)},t.corrcoeff=function(e,r){return t.covariance(e,r)/t.stdev(e,1)/t.stdev(r,1)},t.spearmancoeff=function(e,r){return e=t.rank(e),r=t.rank(r),t.corrcoeff(e,r)},t.stanMoment=function(r,n){for(var o=t.mean(r),i=t.stdev(r),a=r.length,u=0,l=0;l<a;l++)u+=e.pow((r[l]-o)/i,n);return u/r.length},t.skewness=function(e){return t.stanMoment(e,3)},t.kurtosis=function(e){return t.stanMoment(e,4)-3};var i=t.prototype;!function(e){for(var n=0;n<e.length;n++)!function(e){i[e]=function(n,o){var a=[],u=0,l=this;if(r(n)&&(o=n,n=!1),o)return setTimeout((function(){o.call(l,i[e].call(l,n))})),this;if(this.length>1){for(l=!0===n?this:this.transpose();u<l.length;u++)a[u]=t[e](l[u]);return a}return t[e](this[0],n)}}(e[n])}("cumsum cumprod".split(" ")),function(e){for(var n=0;n<e.length;n++)!function(e){i[e]=function(n,o){var a=[],u=0,l=this;if(r(n)&&(o=n,n=!1),o)return setTimeout((function(){o.call(l,i[e].call(l,n))})),this;if(this.length>1){for("sumrow"!==e&&(l=!0===n?this:this.transpose());u<l.length;u++)a[u]=t[e](l[u]);return!0===n?t[e](t.utils.toVector(a)):a}return t[e](this[0],n)}}(e[n])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(e){for(var n=0;n<e.length;n++)!function(e){i[e]=function(){var n,o=[],a=0,u=this,l=Array.prototype.slice.call(arguments);if(r(l[l.length-1])){n=l[l.length-1];var c=l.slice(0,l.length-1);return setTimeout((function(){n.call(u,i[e].apply(u,c))})),this}n=void 0;var s=function(r){return t[e].apply(u,[r].concat(l))};if(this.length>1){for(u=u.transpose();a<u.length;a++)o[a]=s(u[a]);return o}return s(this[0])}}(e[n])}("quantiles percentileOfScore".split(" "))}(n=function(t,e){var r=Array.prototype.concat,n=Array.prototype.slice,o=Object.prototype.toString;function i(e,r){var n=e>r?e:r;return t.pow(10,17-~~(t.log(n>0?n:-n)*t.LOG10E))}var a=Array.isArray||function(t){return"[object Array]"===o.call(t)};function u(t){return"[object Function]"===o.call(t)}function l(t){return"number"==typeof t&&t-t==0}function c(){return new c._init(arguments)}function s(){return 0}function f(){return 1}function h(t,e){return t===e?1:0}c.fn=c.prototype,c._init=function(t){if(a(t[0]))if(a(t[0][0])){u(t[1])&&(t[0]=c.map(t[0],t[1]));for(var e=0;e<t[0].length;e++)this[e]=t[0][e];this.length=t[0].length}else this[0]=u(t[1])?c.map(t[0],t[1]):t[0],this.length=1;else if(l(t[0]))this[0]=c.seq.apply(null,t),this.length=1;else{if(t[0]instanceof c)return c(t[0].toArray());this[0]=[],this.length=1}return this},c._init.prototype=c.prototype,c._init.constructor=c,c.utils={calcRdx:i,isArray:a,isFunction:u,isNumber:l,toVector:function(t){return r.apply([],t)}},c._random_fn=t.random,c.setRandom=function(t){if("function"!=typeof t)throw new TypeError("fn is not a function");c._random_fn=t},c.extend=function(t){var e,r;if(1===arguments.length){for(r in t)c[r]=t[r];return this}for(e=1;e<arguments.length;e++)for(r in arguments[e])t[r]=arguments[e][r];return t},c.rows=function(t){return t.length||1},c.cols=function(t){return t[0].length||1},c.dimensions=function(t){return{rows:c.rows(t),cols:c.cols(t)}},c.row=function(t,e){return a(e)?e.map((function(e){return c.row(t,e)})):t[e]},c.rowa=function(t,e){return c.row(t,e)},c.col=function(t,e){if(a(e)){var r=c.arange(t.length).map((function(){return new Array(e.length)}));return e.forEach((function(e,n){c.arange(t.length).forEach((function(o){r[o][n]=t[o][e]}))})),r}for(var n=new Array(t.length),o=0;o<t.length;o++)n[o]=[t[o][e]];return n},c.cola=function(t,e){return c.col(t,e).map((function(t){return t[0]}))},c.diag=function(t){for(var e=c.rows(t),r=new Array(e),n=0;n<e;n++)r[n]=[t[n][n]];return r},c.antidiag=function(t){for(var e=c.rows(t)-1,r=new Array(e),n=0;e>=0;e--,n++)r[n]=[t[n][e]];return r},c.transpose=function(t){var e,r,n,o,i,u=[];for(a(t[0])||(t=[t]),r=t.length,n=t[0].length,i=0;i<n;i++){for(e=new Array(r),o=0;o<r;o++)e[o]=t[o][i];u.push(e)}return 1===u.length?u[0]:u},c.map=function(t,e,r){var n,o,i,u,l;for(a(t[0])||(t=[t]),o=t.length,i=t[0].length,u=r?t:new Array(o),n=0;n<o;n++)for(u[n]||(u[n]=new Array(i)),l=0;l<i;l++)u[n][l]=e(t[n][l],n,l);return 1===u.length?u[0]:u},c.cumreduce=function(t,e,r){var n,o,i,u,l;for(a(t[0])||(t=[t]),o=t.length,i=t[0].length,u=r?t:new Array(o),n=0;n<o;n++)for(u[n]||(u[n]=new Array(i)),i>0&&(u[n][0]=t[n][0]),l=1;l<i;l++)u[n][l]=e(u[n][l-1],t[n][l]);return 1===u.length?u[0]:u},c.alter=function(t,e){return c.map(t,e,!0)},c.create=function(t,e,r){var n,o,i=new Array(t);for(u(e)&&(r=e,e=t),n=0;n<t;n++)for(i[n]=new Array(e),o=0;o<e;o++)i[n][o]=r(n,o);return i},c.zeros=function(t,e){return l(e)||(e=t),c.create(t,e,s)},c.ones=function(t,e){return l(e)||(e=t),c.create(t,e,f)},c.rand=function(t,e){return l(e)||(e=t),c.create(t,e,c._random_fn)},c.identity=function(t,e){return l(e)||(e=t),c.create(t,e,h)},c.symmetric=function(t){var e,r,n=t.length;if(t.length!==t[0].length)return!1;for(e=0;e<n;e++)for(r=0;r<n;r++)if(t[r][e]!==t[e][r])return!1;return!0},c.clear=function(t){return c.alter(t,s)},c.seq=function(t,e,r,n){u(n)||(n=!1);var o,a=[],l=i(t,e),c=(e*l-t*l)/((r-1)*l),s=t;for(o=0;s<=e&&o<r;s=(t*l+c*l*++o)/l)a.push(n?n(s,o):s);return a},c.arange=function(t,e,r){var n,o=[];if(r=r||1,void 0===e&&(e=t,t=0),t===e||0===r)return[];if(t<e&&r<0)return[];if(t>e&&r>0)return[];if(r>0)for(n=t;n<e;n+=r)o.push(n);else for(n=t;n>e;n+=r)o.push(n);return o},c.slice=function(){function t(t,e,r,n){var o,i=[],a=t.length;if(void 0===e&&void 0===r&&void 0===n)return c.copy(t);if(n=n||1,(e=(e=e||0)>=0?e:a+e)===(r=(r=r||t.length)>=0?r:a+r)||0===n)return[];if(e<r&&n<0)return[];if(e>r&&n>0)return[];if(n>0)for(o=e;o<r;o+=n)i.push(t[o]);else for(o=e;o>r;o+=n)i.push(t[o]);return i}return function(e,r){var n,o;return l((r=r||{}).row)?l(r.col)?e[r.row][r.col]:t(c.rowa(e,r.row),(n=r.col||{}).start,n.end,n.step):l(r.col)?t(c.cola(e,r.col),(o=r.row||{}).start,o.end,o.step):(o=r.row||{},n=r.col||{},t(e,o.start,o.end,o.step).map((function(e){return t(e,n.start,n.end,n.step)})))}}(),c.sliceAssign=function(e,r,n){var o,i;if(l(r.row)){if(l(r.col))return e[r.row][r.col]=n;r.col=r.col||{},r.col.start=r.col.start||0,r.col.end=r.col.end||e[0].length,r.col.step=r.col.step||1,o=c.arange(r.col.start,t.min(e.length,r.col.end),r.col.step);var a=r.row;return o.forEach((function(t,r){e[a][t]=n[r]})),e}if(l(r.col)){r.row=r.row||{},r.row.start=r.row.start||0,r.row.end=r.row.end||e.length,r.row.step=r.row.step||1,i=c.arange(r.row.start,t.min(e[0].length,r.row.end),r.row.step);var u=r.col;return i.forEach((function(t,r){e[t][u]=n[r]})),e}return void 0===n[0].length&&(n=[n]),r.row.start=r.row.start||0,r.row.end=r.row.end||e.length,r.row.step=r.row.step||1,r.col.start=r.col.start||0,r.col.end=r.col.end||e[0].length,r.col.step=r.col.step||1,i=c.arange(r.row.start,t.min(e.length,r.row.end),r.row.step),o=c.arange(r.col.start,t.min(e[0].length,r.col.end),r.col.step),i.forEach((function(t,r){o.forEach((function(o,i){e[t][o]=n[r][i]}))})),e},c.diagonal=function(t){var e=c.zeros(t.length,t.length);return t.forEach((function(t,r){e[r][r]=t})),e},c.copy=function(t){return t.map((function(t){return l(t)?t:t.map((function(t){return t}))}))};var p=c.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?n.call(this):n.call(this)[0]},p.map=function(t,e){return c(c.map(this,t,e))},p.cumreduce=function(t,e){return c(c.cumreduce(this,t,e))},p.alter=function(t){return c.alter(this,t),this},function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(e){var r,n=this;return e?(setTimeout((function(){e.call(n,p[t].call(n))})),this):(r=c[t](this),a(r)?c(r):r)}}(t[e])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(e,r){var n=this;return r?(setTimeout((function(){r.call(n,p[t].call(n,e))})),this):c(c[t](this,e))}}(t[e])}("row col".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(){return c(c[t].apply(null,arguments))}}(t[e])}("create zeros ones rand identity".split(" ")),c}(Math),Math),function(t,e){t.gammaln=function(t){var r,n,o,i=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],u=1.000000000190015;for(o=(n=r=t)+5.5,o-=(r+.5)*e.log(o);i<6;i++)u+=a[i]/++n;return e.log(2.5066282746310007*u/r)-o},t.loggam=function(t){var r,n,o,i,a,u,l,c=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(r=t,l=0,1==t||2==t)return 0;for(t<=7&&(r=t+(l=e.floor(7-t))),n=1/(r*r),o=2*e.PI,a=c[9],u=8;u>=0;u--)a*=n,a+=c[u];if(i=a/r+.5*e.log(o)+(r-.5)*e.log(r)-r,t<=7)for(u=1;u<=l;u++)i-=e.log(r-1),r-=1;return i},t.gammafn=function(t){var r,n,o,i,a=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],u=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,c=0,s=0,f=0,h=t;if(t>171.6243769536076)return 1/0;if(h<=0){if(!(i=h%1+36e-17))return 1/0;l=(1&h?-1:1)*e.PI/e.sin(e.PI*i),h=1-h}for(o=h,n=h<1?h++:(h-=c=(0|h)-1)-1,r=0;r<8;++r)f=(f+a[r])*n,s=s*n+u[r];if(i=f/s+1,o<h)i/=o;else if(o>h)for(r=0;r<c;++r)i*=h,h++;return l&&(i=l/i),i},t.gammap=function(e,r){return t.lowRegGamma(e,r)*t.gammafn(e)},t.lowRegGamma=function(r,n){var o,i=t.gammaln(r),a=r,u=1/r,l=u,c=n+1-r,s=1/1e-30,f=1/c,h=f,p=1,y=-~(8.5*e.log(r>=1?r:1/r)+.4*r+17);if(n<0||r<=0)return NaN;if(n<r+1){for(;p<=y;p++)u+=l*=n/++a;return u*e.exp(-n+r*e.log(n)-i)}for(;p<=y;p++)h*=(f=1/(f=(o=-p*(p-r))*f+(c+=2)))*(s=c+o/s);return 1-h*e.exp(-n+r*e.log(n)-i)},t.factorialln=function(e){return e<0?NaN:t.gammaln(e+1)},t.factorial=function(e){return e<0?NaN:t.gammafn(e+1)},t.combination=function(r,n){return r>170||n>170?e.exp(t.combinationln(r,n)):t.factorial(r)/t.factorial(n)/t.factorial(r-n)},t.combinationln=function(e,r){return t.factorialln(e)-t.factorialln(r)-t.factorialln(e-r)},t.permutation=function(e,r){return t.factorial(e)/t.factorial(e-r)},t.betafn=function(r,n){if(!(r<=0||n<=0))return r+n>170?e.exp(t.betaln(r,n)):t.gammafn(r)*t.gammafn(n)/t.gammafn(r+n)},t.betaln=function(e,r){return t.gammaln(e)+t.gammaln(r)-t.gammaln(e+r)},t.betacf=function(t,r,n){var o,i,a,u,l=1,c=r+n,s=r+1,f=r-1,h=1,p=1-c*t/s;for(e.abs(p)<1e-30&&(p=1e-30),u=p=1/p;l<=100&&(p=1+(i=l*(n-l)*t/((f+(o=2*l))*(r+o)))*p,e.abs(p)<1e-30&&(p=1e-30),h=1+i/h,e.abs(h)<1e-30&&(h=1e-30),u*=(p=1/p)*h,p=1+(i=-(r+l)*(c+l)*t/((r+o)*(s+o)))*p,e.abs(p)<1e-30&&(p=1e-30),h=1+i/h,e.abs(h)<1e-30&&(h=1e-30),u*=a=(p=1/p)*h,!(e.abs(a-1)<3e-7));l++);return u},t.gammapinv=function(r,n){var o,i,a,u,l,c,s=0,f=n-1,h=t.gammaln(n);if(r>=1)return e.max(100,n+100*e.sqrt(n));if(r<=0)return 0;for(n>1?(l=e.log(f),c=e.exp(f*(l-1)-h),u=r<.5?r:1-r,o=(2.30753+.27061*(i=e.sqrt(-2*e.log(u))))/(1+i*(.99229+.04481*i))-i,r<.5&&(o=-o),o=e.max(.001,n*e.pow(1-1/(9*n)-o/(3*e.sqrt(n)),3))):o=r<(i=1-n*(.253+.12*n))?e.pow(r/i,1/n):1-e.log(1-(r-i)/(1-i));s<12;s++){if(o<=0)return 0;if((o-=i=(a=(t.lowRegGamma(n,o)-r)/(i=n>1?c*e.exp(-(o-f)+f*(e.log(o)-l)):e.exp(-o+f*e.log(o)-h)))/(1-.5*e.min(1,a*((n-1)/o-1))))<=0&&(o=.5*(o+i)),e.abs(i)<1e-8*o)break}return o},t.erf=function(t){var r,n,o,i,a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],u=a.length-1,l=!1,c=0,s=0;for(t<0&&(t=-t,l=!0),n=4*(r=2/(2+t))-2;u>0;u--)o=c,c=n*c-s+a[u],s=o;return i=r*e.exp(-t*t+.5*(a[0]+n*c)-s),l?i-1:1-i},t.erfc=function(e){return 1-t.erf(e)},t.erfcinv=function(r){var n,o,i,a,u=0;if(r>=2)return-100;if(r<=0)return 100;for(a=r<1?r:2-r,n=-.70711*((2.30753+.27061*(i=e.sqrt(-2*e.log(a/2))))/(1+i*(.99229+.04481*i))-i);u<2;u++)n+=(o=t.erfc(n)-a)/(1.1283791670955126*e.exp(-n*n)-n*o);return r<1?n:-n},t.ibetainv=function(r,n,o){var i,a,u,l,c,s,f,h,p,y,v=n-1,b=o-1,m=0;if(r<=0)return 0;if(r>=1)return 1;for(n>=1&&o>=1?(u=r<.5?r:1-r,s=(2.30753+.27061*(l=e.sqrt(-2*e.log(u))))/(1+l*(.99229+.04481*l))-l,r<.5&&(s=-s),f=(s*s-3)/6,h=2/(1/(2*n-1)+1/(2*o-1)),p=s*e.sqrt(f+h)/h-(1/(2*o-1)-1/(2*n-1))*(f+5/6-2/(3*h)),s=n/(n+o*e.exp(2*p))):(i=e.log(n/(n+o)),a=e.log(o/(n+o)),s=r<(l=e.exp(n*i)/n)/(p=l+(c=e.exp(o*a)/o))?e.pow(n*p*r,1/n):1-e.pow(o*p*(1-r),1/o)),y=-t.gammaln(n)-t.gammaln(o)+t.gammaln(n+o);m<10;m++){if(0===s||1===s)return s;if((s-=l=(c=(t.ibeta(s,n,o)-r)/(l=e.exp(v*e.log(s)+b*e.log(1-s)+y)))/(1-.5*e.min(1,c*(v/s-b/(1-s)))))<=0&&(s=.5*(s+l)),s>=1&&(s=.5*(s+l+1)),e.abs(l)<1e-8*s&&m>0)break}return s},t.ibeta=function(r,n,o){var i=0===r||1===r?0:e.exp(t.gammaln(n+o)-t.gammaln(n)-t.gammaln(o)+n*e.log(r)+o*e.log(1-r));return!(r<0||r>1)&&(r<(n+1)/(n+o+2)?i*t.betacf(r,n,o)/n:1-i*t.betacf(1-r,o,n)/o)},t.randn=function(r,n){var o,i,a,u,l;if(n||(n=r),r)return t.create(r,n,(function(){return t.randn()}));do{o=t._random_fn(),i=1.7156*(t._random_fn()-.5),l=(a=o-.449871)*a+(u=e.abs(i)+.386595)*(.196*u-.25472*a)}while(l>.27597&&(l>.27846||i*i>-4*e.log(o)*o*o));return i/o},t.randg=function(r,n,o){var i,a,u,l,c,s,f=r;if(o||(o=n),r||(r=1),n)return(s=t.zeros(n,o)).alter((function(){return t.randg(r)})),s;r<1&&(r+=1),i=r-1/3,a=1/e.sqrt(9*i);do{do{l=1+a*(c=t.randn())}while(l<=0);l*=l*l,u=t._random_fn()}while(u>1-.331*e.pow(c,4)&&e.log(u)>.5*c*c+i*(1-l+e.log(l)));if(r==f)return i*l;do{u=t._random_fn()}while(0===u);return e.pow(u,1/f)*i*l},function(e){for(var r=0;r<e.length;r++)!function(e){t.fn[e]=function(){return t(t.map(this,(function(r){return t[e](r)})))}}(e[r])}("gammaln gammafn factorial factorialln".split(" ")),function(e){for(var r=0;r<e.length;r++)!function(e){t.fn[e]=function(){return t(t[e].apply(null,arguments))}}(e[r])}("randn".split(" "))}(n,Math),function(t,e){function r(t,r,n,o){for(var i,a=0,u=1,l=1,c=1,s=0,f=0;e.abs((l-f)/l)>o;)f=l,u=c+(i=-(r+s)*(r+n+s)*t/(r+2*s)/(r+2*s+1))*u,l=(a=l+i*a)+(i=(s+=1)*(n-s)*t/(r+2*s-1)/(r+2*s))*l,a/=c=u+i*c,u/=c,l/=c,c=1;return l/r}function n(r,n,o){var i=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],a=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],u=.5*r;if(u>=8)return 1;var l,c=2*t.normal.cdf(u,0,1,1,0)-1;c=c>=e.exp(-50/o)?e.pow(c,o):0;for(var s=u,f=(8-u)/(l=r>3?2:3),h=s+f,p=0,y=o-1,v=1;v<=l;v++){for(var b=0,m=.5*(h+s),d=.5*(h-s),g=1;g<=12;g++){var w,E=m+d*(6<g?i[(w=12-g+1)-1]:-i[(w=g)-1]),S=E*E;if(S>60)break;var O=2*t.normal.cdf(E,0,1,1,0)*.5-2*t.normal.cdf(E,r,1,1,0)*.5;O>=e.exp(-30/y)&&(b+=O=a[w-1]*e.exp(-.5*S)*e.pow(O,y))}p+=b*=2*d*o/e.sqrt(2*e.PI),s=h,h+=f}return(c+=p)<=e.exp(-30/n)?0:(c=e.pow(c,n))>=1?1:c}!function(e){for(var r=0;r<e.length;r++)!function(e){t[e]=function t(e,r,n){return this instanceof t?(this._a=e,this._b=r,this._c=n,this):new t(e,r,n)},t.fn[e]=function(r,n,o){var i=t[e](r,n,o);return i.data=this,i},t[e].prototype.sample=function(r){var n=this._a,o=this._b,i=this._c;return r?t.alter(r,(function(){return t[e].sample(n,o,i)})):t[e].sample(n,o,i)},function(r){for(var n=0;n<r.length;n++)!function(r){t[e].prototype[r]=function(n){var o=this._a,i=this._b,a=this._c;return n||0===n||(n=this.data),"number"!=typeof n?t.fn.map.call(n,(function(n){return t[e][r](n,o,i,a)})):t[e][r](n,o,i,a)}}(r[n])}("pdf cdf inv".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){t[e].prototype[r]=function(){return t[e][r](this._a,this._b,this._c)}}(r[n])}("mean median mode variance".split(" "))}(e[r])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(r,n,o){return r>1||r<0?0:1==n&&1==o?1:n<512&&o<512?e.pow(r,n-1)*e.pow(1-r,o-1)/t.betafn(n,o):e.exp((n-1)*e.log(r)+(o-1)*e.log(1-r)-t.betaln(n,o))},cdf:function(e,r,n){return e>1||e<0?1*(e>1):t.ibeta(e,r,n)},inv:function(e,r,n){return t.ibetainv(e,r,n)},mean:function(t,e){return t/(t+e)},median:function(e,r){return t.ibetainv(.5,e,r)},mode:function(t,e){return(t-1)/(t+e-2)},sample:function(e,r){var n=t.randg(e);return n/(n+t.randg(r))},variance:function(t,r){return t*r/(e.pow(t+r,2)*(t+r+1))}}),t.extend(t.centralF,{pdf:function(r,n,o){var i;return r<0?0:n<=2?0===r&&n<2?1/0:0===r&&2===n?1:1/t.betafn(n/2,o/2)*e.pow(n/o,n/2)*e.pow(r,n/2-1)*e.pow(1+n/o*r,-(n+o)/2):(i=n*r/(o+r*n),n*(o/(o+r*n))/2*t.binomial.pdf((n-2)/2,(n+o-2)/2,i))},cdf:function(e,r,n){return e<0?0:t.ibeta(r*e/(r*e+n),r/2,n/2)},inv:function(e,r,n){return n/(r*(1/t.ibetainv(e,r/2,n/2)-1))},mean:function(t,e){return e>2?e/(e-2):void 0},mode:function(t,e){return t>2?e*(t-2)/(t*(e+2)):void 0},sample:function(e,r){return 2*t.randg(e/2)/e/(2*t.randg(r/2)/r)},variance:function(t,e){if(!(e<=4))return 2*e*e*(t+e-2)/(t*(e-2)*(e-2)*(e-4))}}),t.extend(t.cauchy,{pdf:function(t,r,n){return n<0?0:n/(e.pow(t-r,2)+e.pow(n,2))/e.PI},cdf:function(t,r,n){return e.atan((t-r)/n)/e.PI+.5},inv:function(t,r,n){return r+n*e.tan(e.PI*(t-.5))},median:function(t){return t},mode:function(t){return t},sample:function(r,n){return t.randn()*e.sqrt(1/(2*t.randg(.5)))*n+r}}),t.extend(t.chisquare,{pdf:function(r,n){return r<0?0:0===r&&2===n?.5:e.exp((n/2-1)*e.log(r)-r/2-n/2*e.log(2)-t.gammaln(n/2))},cdf:function(e,r){return e<0?0:t.lowRegGamma(r/2,e/2)},inv:function(e,r){return 2*t.gammapinv(e,.5*r)},mean:function(t){return t},median:function(t){return t*e.pow(1-2/(9*t),3)},mode:function(t){return t-2>0?t-2:0},sample:function(e){return 2*t.randg(e/2)},variance:function(t){return 2*t}}),t.extend(t.exponential,{pdf:function(t,r){return t<0?0:r*e.exp(-r*t)},cdf:function(t,r){return t<0?0:1-e.exp(-r*t)},inv:function(t,r){return-e.log(1-t)/r},mean:function(t){return 1/t},median:function(t){return 1/t*e.log(2)},mode:function(){return 0},sample:function(r){return-1/r*e.log(t._random_fn())},variance:function(t){return e.pow(t,-2)}}),t.extend(t.gamma,{pdf:function(r,n,o){return r<0?0:0===r&&1===n?1/o:e.exp((n-1)*e.log(r)-r/o-t.gammaln(n)-n*e.log(o))},cdf:function(e,r,n){return e<0?0:t.lowRegGamma(r,e/n)},inv:function(e,r,n){return t.gammapinv(e,r)*n},mean:function(t,e){return t*e},mode:function(t,e){if(t>1)return(t-1)*e},sample:function(e,r){return t.randg(e)*r},variance:function(t,e){return t*e*e}}),t.extend(t.invgamma,{pdf:function(r,n,o){return r<=0?0:e.exp(-(n+1)*e.log(r)-o/r-t.gammaln(n)+n*e.log(o))},cdf:function(e,r,n){return e<=0?0:1-t.lowRegGamma(r,n/e)},inv:function(e,r,n){return n/t.gammapinv(1-e,r)},mean:function(t,e){return t>1?e/(t-1):void 0},mode:function(t,e){return e/(t+1)},sample:function(e,r){return r/t.randg(e)},variance:function(t,e){if(!(t<=2))return e*e/((t-1)*(t-1)*(t-2))}}),t.extend(t.kumaraswamy,{pdf:function(t,r,n){return 0===t&&1===r?n:1===t&&1===n?r:e.exp(e.log(r)+e.log(n)+(r-1)*e.log(t)+(n-1)*e.log(1-e.pow(t,r)))},cdf:function(t,r,n){return t<0?0:t>1?1:1-e.pow(1-e.pow(t,r),n)},inv:function(t,r,n){return e.pow(1-e.pow(1-t,1/n),1/r)},mean:function(e,r){return r*t.gammafn(1+1/e)*t.gammafn(r)/t.gammafn(1+1/e+r)},median:function(t,r){return e.pow(1-e.pow(2,-1/r),1/t)},mode:function(t,r){if(t>=1&&r>=1&&1!==t&&1!==r)return e.pow((t-1)/(t*r-1),1/t)},variance:function(){throw new Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(t,r,n){return t<=0?0:e.exp(-e.log(t)-.5*e.log(2*e.PI)-e.log(n)-e.pow(e.log(t)-r,2)/(2*n*n))},cdf:function(r,n,o){return r<0?0:.5+.5*t.erf((e.log(r)-n)/e.sqrt(2*o*o))},inv:function(r,n,o){return e.exp(-1.4142135623730951*o*t.erfcinv(2*r)+n)},mean:function(t,r){return e.exp(t+r*r/2)},median:function(t){return e.exp(t)},mode:function(t,r){return e.exp(t-r*r)},sample:function(r,n){return e.exp(t.randn()*n+r)},variance:function(t,r){return(e.exp(r*r)-1)*e.exp(2*t+r*r)}}),t.extend(t.noncentralt,{pdf:function(r,n,o){return e.abs(o)<1e-14?t.studentt.pdf(r,n):e.abs(r)<1e-14?e.exp(t.gammaln((n+1)/2)-o*o/2-.5*e.log(e.PI*n)-t.gammaln(n/2)):n/r*(t.noncentralt.cdf(r*e.sqrt(1+2/n),n+2,o)-t.noncentralt.cdf(r,n,o))},cdf:function(r,n,o){if(e.abs(o)<1e-14)return t.studentt.cdf(r,n);var i=!1;r<0&&(i=!0,o=-o);for(var a=t.normal.cdf(-o,0,1),u=1e-14+1,l=u,c=r*r/(r*r+n),s=0,f=e.exp(-o*o/2),h=e.exp(-o*o/2-.5*e.log(2)-t.gammaln(1.5))*o;s<200||l>1e-14||u>1e-14;)l=u,s>0&&(f*=o*o/(2*s),h*=o*o/(2*(s+.5))),a+=.5*(u=f*t.beta.cdf(c,s+.5,n/2)+h*t.beta.cdf(c,s+1,n/2)),s++;return i?1-a:a}}),t.extend(t.normal,{pdf:function(t,r,n){return e.exp(-.5*e.log(2*e.PI)-e.log(n)-e.pow(t-r,2)/(2*n*n))},cdf:function(r,n,o){return.5*(1+t.erf((r-n)/e.sqrt(2*o*o)))},inv:function(e,r,n){return-1.4142135623730951*n*t.erfcinv(2*e)+r},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},sample:function(e,r){return t.randn()*r+e},variance:function(t,e){return e*e}}),t.extend(t.pareto,{pdf:function(t,r,n){return t<r?0:n*e.pow(r,n)/e.pow(t,n+1)},cdf:function(t,r,n){return t<r?0:1-e.pow(r/t,n)},inv:function(t,r,n){return r/e.pow(1-t,1/n)},mean:function(t,r){if(!(r<=1))return r*e.pow(t,r)/(r-1)},median:function(t,r){return t*(r*e.SQRT2)},mode:function(t){return t},variance:function(t,r){if(!(r<=2))return t*t*r/(e.pow(r-1,2)*(r-2))}}),t.extend(t.studentt,{pdf:function(r,n){return n=n>1e100?1e100:n,1/(e.sqrt(n)*t.betafn(.5,n/2))*e.pow(1+r*r/n,-(n+1)/2)},cdf:function(r,n){var o=n/2;return t.ibeta((r+e.sqrt(r*r+n))/(2*e.sqrt(r*r+n)),o,o)},inv:function(r,n){var o=t.ibetainv(2*e.min(r,1-r),.5*n,.5);return o=e.sqrt(n*(1-o)/o),r>.5?o:-o},mean:function(t){return t>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(r){return t.randn()*e.sqrt(r/(2*t.randg(r/2)))},variance:function(t){return t>2?t/(t-2):t>1?1/0:void 0}}),t.extend(t.weibull,{pdf:function(t,r,n){return t<0||r<0||n<0?0:n/r*e.pow(t/r,n-1)*e.exp(-e.pow(t/r,n))},cdf:function(t,r,n){return t<0?0:1-e.exp(-e.pow(t/r,n))},inv:function(t,r,n){return r*e.pow(-e.log(1-t),1/n)},mean:function(e,r){return e*t.gammafn(1+1/r)},median:function(t,r){return t*e.pow(e.log(2),1/r)},mode:function(t,r){return r<=1?0:t*e.pow((r-1)/r,1/r)},sample:function(r,n){return r*e.pow(-e.log(t._random_fn()),1/n)},variance:function(r,n){return r*r*t.gammafn(1+2/n)-e.pow(t.weibull.mean(r,n),2)}}),t.extend(t.uniform,{pdf:function(t,e,r){return t<e||t>r?0:1/(r-e)},cdf:function(t,e,r){return t<e?0:t<r?(t-e)/(r-e):1},inv:function(t,e,r){return e+t*(r-e)},mean:function(t,e){return.5*(t+e)},median:function(e,r){return t.mean(e,r)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,r){return e/2+r/2+(r/2-e/2)*(2*t._random_fn()-1)},variance:function(t,r){return e.pow(r-t,2)/12}}),t.extend(t.binomial,{pdf:function(r,n,o){return 0===o||1===o?n*o===r?1:0:t.combination(n,r)*e.pow(o,r)*e.pow(1-o,n-r)},cdf:function(n,o,i){var a;if(n<0)return 0;if(n>=o)return 1;if(i<0||i>1||o<=0)return NaN;var u=i,l=(n=e.floor(n))+1,c=o-n,s=l+c,f=e.exp(t.gammaln(s)-t.gammaln(c)-t.gammaln(l)+l*e.log(u)+c*e.log(1-u));return a=u<(l+1)/(s+2)?f*r(u,l,c,1e-10):1-f*r(1-u,c,l,1e-10),e.round(1/1e-10*(1-a))/(1/1e-10)}}),t.extend(t.negbin,{pdf:function(r,n,o){return r===r>>>0&&(r<0?0:t.combination(r+n-1,n-1)*e.pow(1-o,r)*e.pow(o,n))},cdf:function(e,r,n){var o=0,i=0;if(e<0)return 0;for(;i<=e;i++)o+=t.negbin.pdf(i,r,n);return o}}),t.extend(t.hypgeom,{pdf:function(r,n,o,i){if(r!=r|0)return!1;if(r<0||r<o-(n-i))return 0;if(r>i||r>o)return 0;if(2*o>n)return 2*i>n?t.hypgeom.pdf(n-o-i+r,n,n-o,n-i):t.hypgeom.pdf(i-r,n,n-o,i);if(2*i>n)return t.hypgeom.pdf(o-r,n,o,n-i);if(o<i)return t.hypgeom.pdf(r,n,i,o);for(var a=1,u=0,l=0;l<r;l++){for(;a>1&&u<i;)a*=1-o/(n-u),u++;a*=(i-l)*(o-l)/((l+1)*(n-o-i+l+1))}for(;u<i;u++)a*=1-o/(n-u);return e.min(1,e.max(0,a))},cdf:function(r,n,o,i){if(r<0||r<o-(n-i))return 0;if(r>=i||r>=o)return 1;if(2*o>n)return 2*i>n?t.hypgeom.cdf(n-o-i+r,n,n-o,n-i):1-t.hypgeom.cdf(i-r-1,n,n-o,i);if(2*i>n)return 1-t.hypgeom.cdf(o-r-1,n,o,n-i);if(o<i)return t.hypgeom.cdf(r,n,i,o);for(var a=1,u=1,l=0,c=0;c<r;c++){for(;a>1&&l<i;){var s=1-o/(n-l);u*=s,a*=s,l++}a+=u*=(i-c)*(o-c)/((c+1)*(n-o-i+c+1))}for(;l<i;l++)a*=1-o/(n-l);return e.min(1,e.max(0,a))}}),t.extend(t.poisson,{pdf:function(r,n){return n<0||r%1!=0||r<0?0:e.pow(n,r)*e.exp(-n)/t.factorial(r)},cdf:function(e,r){var n=[],o=0;if(e<0)return 0;for(;o<=e;o++)n.push(t.poisson.pdf(o,r));return t.sum(n)},mean:function(t){return t},variance:function(t){return t},sampleSmall:function(r){var n=1,o=0,i=e.exp(-r);do{o++,n*=t._random_fn()}while(n>i);return o-1},sampleLarge:function(r){var n,o,i,a,u,l,c,s,f,h,p=r;for(a=e.sqrt(p),u=e.log(p),l=.02483*(c=.931+2.53*a)-.059,s=1.1239+1.1328/(c-3.4),f=.9277-3.6224/(c-2);;){if(o=e.random()-.5,i=e.random(),h=.5-e.abs(o),n=e.floor((2*l/h+c)*o+p+.43),h>=.07&&i<=f)return n;if(!(n<0||h<.013&&i>h)&&e.log(i)+e.log(s)-e.log(l/(h*h)+c)<=n*u-p-t.loggam(n+1))return n}},sample:function(t){return t<10?this.sampleSmall(t):this.sampleLarge(t)}}),t.extend(t.triangular,{pdf:function(t,e,r,n){return r<=e||n<e||n>r?NaN:t<e||t>r?0:t<n?2*(t-e)/((r-e)*(n-e)):t===n?2/(r-e):2*(r-t)/((r-e)*(r-n))},cdf:function(t,r,n,o){return n<=r||o<r||o>n?NaN:t<=r?0:t>=n?1:t<=o?e.pow(t-r,2)/((n-r)*(o-r)):1-e.pow(n-t,2)/((n-r)*(n-o))},inv:function(t,r,n,o){return n<=r||o<r||o>n?NaN:t<=(o-r)/(n-r)?r+(n-r)*e.sqrt(t*((o-r)/(n-r))):r+(n-r)*(1-e.sqrt((1-t)*(1-(o-r)/(n-r))))},mean:function(t,e,r){return(t+e+r)/3},median:function(t,r,n){return n<=(t+r)/2?r-e.sqrt((r-t)*(r-n))/e.sqrt(2):n>(t+r)/2?t+e.sqrt((r-t)*(n-t))/e.sqrt(2):void 0},mode:function(t,e,r){return r},sample:function(r,n,o){var i=t._random_fn();return i<(o-r)/(n-r)?r+e.sqrt(i*(n-r)*(o-r)):n-e.sqrt((1-i)*(n-r)*(n-o))},variance:function(t,e,r){return(t*t+e*e+r*r-t*e-t*r-e*r)/18}}),t.extend(t.arcsine,{pdf:function(t,r,n){return n<=r?NaN:t<=r||t>=n?0:2/e.PI*e.pow(e.pow(n-r,2)-e.pow(2*t-r-n,2),-.5)},cdf:function(t,r,n){return t<r?0:t<n?2/e.PI*e.asin(e.sqrt((t-r)/(n-r))):1},inv:function(t,r,n){return r+(.5-.5*e.cos(e.PI*t))*(n-r)},mean:function(t,e){return e<=t?NaN:(t+e)/2},median:function(t,e){return e<=t?NaN:(t+e)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(r,n){return(r+n)/2+(n-r)/2*e.sin(2*e.PI*t.uniform.sample(0,1))},variance:function(t,r){return r<=t?NaN:e.pow(r-t,2)/8}}),t.extend(t.laplace,{pdf:function(t,r,n){return n<=0?0:e.exp(-e.abs(t-r)/n)/(2*n)},cdf:function(t,r,n){return n<=0?0:t<r?.5*e.exp((t-r)/n):1-.5*e.exp(-(t-r)/n)},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},variance:function(t,e){return 2*e*e},sample:function(r,n){var o,i=t._random_fn()-.5;return r-n*((o=i)/e.abs(o))*e.log(1-2*e.abs(i))}}),t.extend(t.tukey,{cdf:function(r,o,i){var a=o,u=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],l=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(r<=0)return 0;if(i<2||a<2)return NaN;if(!Number.isFinite(r))return 1;if(i>25e3)return n(r,1,a);var c,s=.5*i,f=s*e.log(i)-i*e.log(2)-t.gammaln(s),h=s-1,p=.25*i;c=i<=100?1:i<=800?.5:i<=5e3?.25:.125,f+=e.log(c);for(var y=0,v=1;v<=50;v++){for(var b=0,m=(2*v-1)*c,d=1;d<=16;d++){var g,w;8<d?(g=d-8-1,w=f+h*e.log(m+u[g]*c)-(u[g]*c+m)*p):(g=d-1,w=f+h*e.log(m-u[g]*c)+(u[g]*c-m)*p),w>=-30&&(b+=n(8<d?r*e.sqrt(.5*(u[g]*c+m)):r*e.sqrt(.5*(-u[g]*c+m)),1,a)*l[g]*e.exp(w))}if(v*c>=1&&b<=1e-14)break;y+=b}if(b>1e-14)throw new Error("tukey.cdf failed to converge");return y>1&&(y=1),y},inv:function(r,n,o){if(o<2||n<2)return NaN;if(r<0||r>1)return NaN;if(0===r)return 0;if(1===r)return 1/0;var i,a=function(t,r,n){var o=.5-.5*t,i=e.sqrt(e.log(1/(o*o))),a=i+((((-453642210148e-16*i-.204231210125)*i-.342242088547)*i-1)*i+.322232421088)/((((.0038560700634*i+.10353775285)*i+.531103462366)*i+.588581570495)*i+.099348462606);n<120&&(a+=(a*a*a+a)/n/4);var u=.8832-.2368*a;return n<120&&(u+=-1.214/n+1.208*a/n),a*(u*e.log(r-1)+1.4142)}(r,n,o),u=t.tukey.cdf(a,n,o)-r;i=u>0?e.max(0,a-1):a+1;for(var l,c=t.tukey.cdf(i,n,o)-r,s=1;s<50;s++)if(l=i-c*(i-a)/(c-u),u=c,a=i,l<0&&(l=0,c=-r),c=t.tukey.cdf(l,n,o)-r,i=l,e.abs(i-a)<1e-4)return l;throw new Error("tukey.inv failed to converge")}})}(n,Math),function(t,e){var r,n,o=Array.prototype.push,i=t.utils.isArray;function a(e){return i(e)||e instanceof t}t.extend({add:function(e,r){return a(r)?(a(r[0])||(r=[r]),t.map(e,(function(t,e,n){return t+r[e][n]}))):t.map(e,(function(t){return t+r}))},subtract:function(e,r){return a(r)?(a(r[0])||(r=[r]),t.map(e,(function(t,e,n){return t-r[e][n]||0}))):t.map(e,(function(t){return t-r}))},divide:function(e,r){return a(r)?(a(r[0])||(r=[r]),t.multiply(e,t.inv(r))):t.map(e,(function(t){return t/r}))},multiply:function(e,r){var n,o,i,u,l,c,s,f;if(void 0===e.length&&void 0===r.length)return e*r;if(l=e.length,c=e[0].length,s=t.zeros(l,i=a(r)?r[0].length:c),f=0,a(r)){for(;f<i;f++)for(n=0;n<l;n++){for(u=0,o=0;o<c;o++)u+=e[n][o]*r[o][f];s[n][f]=u}return 1===l&&1===f?s[0][0]:s}return t.map(e,(function(t){return t*r}))},outer:function(e,r){return t.multiply(e.map((function(t){return[t]})),[r])},dot:function(e,r){a(e[0])||(e=[e]),a(r[0])||(r=[r]);for(var n,o,i=1===e[0].length&&1!==e.length?t.transpose(e):e,u=1===r[0].length&&1!==r.length?t.transpose(r):r,l=[],c=0,s=i.length,f=i[0].length;c<s;c++){for(l[c]=[],n=0,o=0;o<f;o++)n+=i[c][o]*u[c][o];l[c]=n}return 1===l.length?l[0]:l},pow:function(r,n){return t.map(r,(function(t){return e.pow(t,n)}))},exp:function(r){return t.map(r,(function(t){return e.exp(t)}))},log:function(r){return t.map(r,(function(t){return e.log(t)}))},abs:function(r){return t.map(r,(function(t){return e.abs(t)}))},norm:function(t,r){var n=0,o=0;for(isNaN(r)&&(r=2),a(t[0])&&(t=t[0]);o<t.length;o++)n+=e.pow(e.abs(t[o]),r);return e.pow(n,1/r)},angle:function(r,n){return e.acos(t.dot(r,n)/(t.norm(r)*t.norm(n)))},aug:function(t,e){var r,n=[];for(r=0;r<t.length;r++)n.push(t[r].slice());for(r=0;r<n.length;r++)o.apply(n[r],e[r]);return n},inv:function(e){for(var r,n=e.length,o=e[0].length,i=t.identity(n,o),a=t.gauss_jordan(e,i),u=[],l=0;l<n;l++)for(u[l]=[],r=o;r<a[0].length;r++)u[l][r-o]=a[l][r];return u},det:function t(e){if(2===e.length)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(var r=0,n=0;n<e.length;n++){for(var o=[],i=1;i<e.length;i++){o[i-1]=[];for(var a=0;a<e.length;a++)a<n?o[i-1][a]=e[i][a]:a>n&&(o[i-1][a-1]=e[i][a])}var u=n%2?-1:1;r+=t(o)*e[0][n]*u}return r},gauss_elimination:function(r,n){var o,i,a,u,l=0,c=0,s=r.length,f=r[0].length,h=1,p=0,y=[];for(o=(r=t.aug(r,n))[0].length,l=0;l<s;l++){for(i=r[l][l],c=l,u=l+1;u<f;u++)i<e.abs(r[u][l])&&(i=r[u][l],c=u);if(c!=l)for(u=0;u<o;u++)a=r[l][u],r[l][u]=r[c][u],r[c][u]=a;for(c=l+1;c<s;c++)for(h=r[c][l]/r[l][l],u=l;u<o;u++)r[c][u]=r[c][u]-h*r[l][u]}for(l=s-1;l>=0;l--){for(p=0,c=l+1;c<=s-1;c++)p+=y[c]*r[l][c];y[l]=(r[l][o-1]-p)/r[l][l]}return y},gauss_jordan:function(r,n){var o,i,a,u=t.aug(r,n),l=u.length,c=u[0].length,s=0;for(i=0;i<l;i++){var f=i;for(a=i+1;a<l;a++)e.abs(u[a][i])>e.abs(u[f][i])&&(f=a);var h=u[i];for(u[i]=u[f],u[f]=h,a=i+1;a<l;a++)for(s=u[a][i]/u[i][i],o=i;o<c;o++)u[a][o]-=u[i][o]*s}for(i=l-1;i>=0;i--){for(s=u[i][i],a=0;a<i;a++)for(o=c-1;o>i-1;o--)u[a][o]-=u[i][o]*u[a][i]/s;for(u[i][i]/=s,o=l;o<c;o++)u[i][o]/=s}return u},triaUpSolve:function(e,r){var n,o=e[0].length,i=t.zeros(1,o)[0],a=!1;return null!=r[0].length&&(r=r.map((function(t){return t[0]})),a=!0),t.arange(o-1,-1,-1).forEach((function(a){n=t.arange(a+1,o).map((function(t){return i[t]*e[a][t]})),i[a]=(r[a]-t.sum(n))/e[a][a]})),a?i.map((function(t){return[t]})):i},triaLowSolve:function(e,r){var n,o=e[0].length,i=t.zeros(1,o)[0],a=!1;return null!=r[0].length&&(r=r.map((function(t){return t[0]})),a=!0),t.arange(o).forEach((function(o){n=t.arange(o).map((function(t){return e[o][t]*i[t]})),i[o]=(r[o]-t.sum(n))/e[o][o]})),a?i.map((function(t){return[t]})):i},lu:function(e){var r,n=e.length,o=t.identity(n),i=t.zeros(e.length,e[0].length);return t.arange(n).forEach((function(t){i[0][t]=e[0][t]})),t.arange(1,n).forEach((function(a){t.arange(a).forEach((function(n){r=t.arange(n).map((function(t){return o[a][t]*i[t][n]})),o[a][n]=(e[a][n]-t.sum(r))/i[n][n]})),t.arange(a,n).forEach((function(n){r=t.arange(a).map((function(t){return o[a][t]*i[t][n]})),i[a][n]=e[r.length][n]-t.sum(r)}))})),[o,i]},cholesky:function(r){var n,o=r.length,i=t.zeros(r.length,r[0].length);return t.arange(o).forEach((function(a){n=t.arange(a).map((function(t){return e.pow(i[a][t],2)})),i[a][a]=e.sqrt(r[a][a]-t.sum(n)),t.arange(a+1,o).forEach((function(e){n=t.arange(a).map((function(t){return i[a][t]*i[e][t]})),i[e][a]=(r[a][e]-t.sum(n))/i[a][a]}))})),i},gauss_jacobi:function(r,n,o,i){for(var a,u,l,c,s=0,f=0,h=r.length,p=[],y=[],v=[];s<h;s++)for(p[s]=[],y[s]=[],v[s]=[],f=0;f<h;f++)s>f?(p[s][f]=r[s][f],y[s][f]=v[s][f]=0):s<f?(y[s][f]=r[s][f],p[s][f]=v[s][f]=0):(v[s][f]=r[s][f],p[s][f]=y[s][f]=0);for(l=t.multiply(t.multiply(t.inv(v),t.add(p,y)),-1),u=t.multiply(t.inv(v),n),a=o,c=t.add(t.multiply(l,o),u),s=2;e.abs(t.norm(t.subtract(c,a)))>i;)a=c,c=t.add(t.multiply(l,a),u),s++;return c},gauss_seidel:function(r,n,o,i){for(var a,u,l,c,s,f=0,h=r.length,p=[],y=[],v=[];f<h;f++)for(p[f]=[],y[f]=[],v[f]=[],a=0;a<h;a++)f>a?(p[f][a]=r[f][a],y[f][a]=v[f][a]=0):f<a?(y[f][a]=r[f][a],p[f][a]=v[f][a]=0):(v[f][a]=r[f][a],p[f][a]=y[f][a]=0);for(c=t.multiply(t.multiply(t.inv(t.add(v,p)),y),-1),l=t.multiply(t.inv(t.add(v,p)),n),u=o,s=t.add(t.multiply(c,o),l),f=2;e.abs(t.norm(t.subtract(s,u)))>i;)u=s,s=t.add(t.multiply(c,u),l),f+=1;return s},SOR:function(r,n,o,i,a){for(var u,l,c,s,f,h=0,p=r.length,y=[],v=[],b=[];h<p;h++)for(y[h]=[],v[h]=[],b[h]=[],u=0;u<p;u++)h>u?(y[h][u]=r[h][u],v[h][u]=b[h][u]=0):h<u?(v[h][u]=r[h][u],y[h][u]=b[h][u]=0):(b[h][u]=r[h][u],y[h][u]=v[h][u]=0);for(s=t.multiply(t.inv(t.add(b,t.multiply(y,a))),t.subtract(t.multiply(b,1-a),t.multiply(v,a))),c=t.multiply(t.multiply(t.inv(t.add(b,t.multiply(y,a))),n),a),l=o,f=t.add(t.multiply(s,o),c),h=2;e.abs(t.norm(t.subtract(f,l)))>i;)l=f,f=t.add(t.multiply(s,l),c),h++;return f},householder:function(r){for(var n,o,i,a,u=r.length,l=r[0].length,c=0,s=[],f=[];c<u-1;c++){for(n=0,a=c+1;a<l;a++)n+=r[a][c]*r[a][c];for(n=(r[c+1][c]>0?-1:1)*e.sqrt(n),o=e.sqrt((n*n-r[c+1][c]*n)/2),(s=t.zeros(u,1))[c+1][0]=(r[c+1][c]-n)/(2*o),i=c+2;i<u;i++)s[i][0]=r[i][c]/(2*o);f=t.subtract(t.identity(u,l),t.multiply(t.multiply(s,t.transpose(s)),2)),r=t.multiply(f,t.multiply(r,f))}return r},QR:(r=t.sum,n=t.arange,function(o){var i,a,u,l=o.length,c=o[0].length,s=t.zeros(c,c);for(o=t.copy(o),a=0;a<c;a++){for(s[a][a]=e.sqrt(r(n(l).map((function(t){return o[t][a]*o[t][a]})))),i=0;i<l;i++)o[i][a]=o[i][a]/s[a][a];for(u=a+1;u<c;u++)for(s[a][u]=r(n(l).map((function(t){return o[t][a]*o[t][u]}))),i=0;i<l;i++)o[i][u]=o[i][u]-o[i][a]*s[a][u]}return[o,s]}),lstsq:function(e,r){var n=!1;void 0===r[0].length&&(r=r.map((function(t){return[t]})),n=!0);var o=t.QR(e),i=o[0],a=o[1],u=e[0].length,l=t.slice(i,{col:{end:u}}),c=function(e){var r=(e=t.copy(e)).length,n=t.identity(r);return t.arange(r-1,-1,-1).forEach((function(r){t.sliceAssign(n,{row:r},t.divide(t.slice(n,{row:r}),e[r][r])),t.sliceAssign(e,{row:r},t.divide(t.slice(e,{row:r}),e[r][r])),t.arange(r).forEach((function(o){var i=t.multiply(e[o][r],-1),a=t.slice(e,{row:o}),u=t.multiply(t.slice(e,{row:r}),i);t.sliceAssign(e,{row:o},t.add(a,u));var l=t.slice(n,{row:o}),c=t.multiply(t.slice(n,{row:r}),i);t.sliceAssign(n,{row:o},t.add(l,c))}))})),n}(t.slice(a,{row:{end:u}})),s=t.transpose(l);void 0===s[0].length&&(s=[s]);var f=t.multiply(t.multiply(c,s),r);return void 0===f.length&&(f=[[f]]),n?f.map((function(t){return t[0]})):f},jacobi:function(r){for(var n,o,i,a,u,l,c,s=1,f=r.length,h=t.identity(f,f),p=[];1===s;){for(u=r[0][1],i=0,a=1,n=0;n<f;n++)for(o=0;o<f;o++)n!=o&&u<e.abs(r[n][o])&&(u=e.abs(r[n][o]),i=n,a=o);for(l=r[i][i]===r[a][a]?r[i][a]>0?e.PI/4:-e.PI/4:e.atan(2*r[i][a]/(r[i][i]-r[a][a]))/2,(c=t.identity(f,f))[i][i]=e.cos(l),c[i][a]=-e.sin(l),c[a][i]=e.sin(l),c[a][a]=e.cos(l),h=t.multiply(h,c),r=t.multiply(t.multiply(t.inv(c),r),c),s=0,n=1;n<f;n++)for(o=1;o<f;o++)n!=o&&e.abs(r[n][o])>.001&&(s=1)}for(n=0;n<f;n++)p.push(r[n][n]);return[h,p]},rungekutta:function(t,e,r,n,o,i){var a,u,l;if(2===i)for(;n<=r;)o+=((a=e*t(n,o))+(u=e*t(n+e,o+a)))/2,n+=e;if(4===i)for(;n<=r;)o+=((a=e*t(n,o))+2*(u=e*t(n+e/2,o+a/2))+2*(l=e*t(n+e/2,o+u/2))+e*t(n+e,o+l))/6,n+=e;return o},romberg:function(t,r,n,o){for(var i,a,u,l,c,s=0,f=(n-r)/2,h=[],p=[],y=[];s<o/2;){for(c=t(r),u=r,l=0;u<=n;u+=f,l++)h[l]=u;for(i=h.length,u=1;u<i-1;u++)c+=(u%2!=0?4:2)*t(h[u]);c=f/3*(c+t(n)),y[s]=c,f/=2,s++}for(a=y.length,i=1;1!==a;){for(u=0;u<a-1;u++)p[u]=(e.pow(4,i)*y[u+1]-y[u])/(e.pow(4,i)-1);a=p.length,y=p,p=[],i++}return y},richardson:function(t,r,n,o){function i(t,e){for(var r,n=0,o=t.length;n<o;n++)t[n]===e&&(r=n);return r}for(var a,u,l,c,s,f=e.abs(n-t[i(t,n)+1]),h=0,p=[],y=[];o>=f;)a=i(t,n+o),u=i(t,n),p[h]=(r[a]-2*r[u]+r[2*u-a])/(o*o),o/=2,h++;for(c=p.length,l=1;1!=c;){for(s=0;s<c-1;s++)y[s]=(e.pow(4,l)*p[s+1]-p[s])/(e.pow(4,l)-1);c=y.length,p=y,y=[],l++}return p},simpson:function(t,e,r,n){for(var o,i=(r-e)/n,a=t(e),u=[],l=e,c=0,s=1;l<=r;l+=i,c++)u[c]=l;for(o=u.length;s<o-1;s++)a+=(s%2!=0?4:2)*t(u[s]);return i/3*(a+t(r))},hermite:function(t,e,r,n){for(var o,i=t.length,a=0,u=0,l=[],c=[],s=[],f=[];u<i;u++){for(l[u]=1,o=0;o<i;o++)u!=o&&(l[u]*=(n-t[o])/(t[u]-t[o]));for(c[u]=0,o=0;o<i;o++)u!=o&&(c[u]+=1/(t[u]-t[o]));s[u]=(1-2*(n-t[u])*c[u])*(l[u]*l[u]),f[u]=(n-t[u])*(l[u]*l[u]),a+=s[u]*e[u]+f[u]*r[u]}return a},lagrange:function(t,e,r){for(var n,o,i=0,a=0,u=t.length;a<u;a++){for(o=e[a],n=0;n<u;n++)a!=n&&(o*=(r-t[n])/(t[a]-t[n]));i+=o}return i},cubic_spline:function(e,r,n){for(var o,i,a=e.length,u=0,l=[],c=[],s=[],f=[],h=[],p=[];u<a-1;u++)f[u]=e[u+1]-e[u];for(s[0]=0,u=1;u<a-1;u++)s[u]=3/f[u]*(r[u+1]-r[u])-3/f[u-1]*(r[u]-r[u-1]);for(u=1;u<a-1;u++)l[u]=[],c[u]=[],l[u][u-1]=f[u-1],l[u][u]=2*(f[u-1]+f[u]),l[u][u+1]=f[u],c[u][0]=s[u];for(i=t.multiply(t.inv(l),c),o=0;o<a-1;o++)h[o]=(r[o+1]-r[o])/f[o]-f[o]*(i[o+1][0]+2*i[o][0])/3,p[o]=(i[o+1][0]-i[o][0])/(3*f[o]);for(o=0;o<a&&!(e[o]>n);o++);return r[o-=1]+(n-e[o])*h[o]+t.sq(n-e[o])*i[o]+(n-e[o])*t.sq(n-e[o])*p[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(e){var r,n,o,i,a,u=e.length,l=e[0].length,c=0,s=[],f=[],h=[],p=[],y=[],v=[],b=[];for(c=0;c<u;c++)s[c]=t.sum(e[c])/l;for(c=0;c<l;c++)for(y[c]=[],r=0;r<u;r++)y[c][r]=e[r][c]-s[r];for(y=t.transpose(y),c=0;c<u;c++)for(v[c]=[],r=0;r<u;r++)v[c][r]=t.dot([y[c]],[y[r]])/(l-1);for(a=(o=t.jacobi(v))[0],f=o[1],b=t.transpose(a),c=0;c<f.length;c++)for(r=c;r<f.length;r++)f[c]<f[r]&&(n=f[c],f[c]=f[r],f[r]=n,h=b[c],b[c]=b[r],b[r]=h);for(i=t.transpose(y),c=0;c<u;c++)for(p[c]=[],r=0;r<i.length;r++)p[c][r]=t.dot([b[c]],[i[r]]);return[e,f,b,p]}}),function(e){for(var r=0;r<e.length;r++)!function(e){t.fn[e]=function(r,n){var o=this;return n?(setTimeout((function(){n.call(o,t.fn[e].call(o,r))}),15),this):"number"==typeof t[e](this,r)?t[e](this,r):t(t[e](this,r))}}(e[r])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(n,Math),function(t,e){var r=[].slice,n=t.utils.isNumber,o=t.utils.isArray;function i(t,r,n,o){if(t>1||n>1||t<=0||n<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(t*r+n*o)/(r+o);return(t-n)/e.sqrt(i*(1-i)*(1/r+1/o))}t.extend({zscore:function(){var e=r.call(arguments);return n(e[1])?(e[0]-e[1])/e[2]:(e[0]-t.mean(e[1]))/t.stdev(e[1],e[2])},ztest:function(){var n,i=r.call(arguments);return o(i[1])?(n=t.zscore(i[0],i[1],i[3]),1===i[2]?t.normal.cdf(-e.abs(n),0,1):2*t.normal.cdf(-e.abs(n),0,1)):i.length>2?(n=t.zscore(i[0],i[1],i[2]),1===i[3]?t.normal.cdf(-e.abs(n),0,1):2*t.normal.cdf(-e.abs(n),0,1)):(n=i[0],1===i[1]?t.normal.cdf(-e.abs(n),0,1):2*t.normal.cdf(-e.abs(n),0,1))}}),t.extend(t.fn,{zscore:function(t,e){return(t-this.mean())/this.stdev(e)},ztest:function(r,n,o){var i=e.abs(this.zscore(r,o));return 1===n?t.normal.cdf(-i,0,1):2*t.normal.cdf(-i,0,1)}}),t.extend({tscore:function(){var n=r.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/e.sqrt(n[3])):(n[0]-t.mean(n[1]))/(t.stdev(n[1],!0)/e.sqrt(n[1].length))},ttest:function(){var o,i=r.call(arguments);return 5===i.length?(o=e.abs(t.tscore(i[0],i[1],i[2],i[3])),1===i[4]?t.studentt.cdf(-o,i[3]-1):2*t.studentt.cdf(-o,i[3]-1)):n(i[1])?(o=e.abs(i[0]),1==i[2]?t.studentt.cdf(-o,i[1]-1):2*t.studentt.cdf(-o,i[1]-1)):(o=e.abs(t.tscore(i[0],i[1])),1==i[2]?t.studentt.cdf(-o,i[1].length-1):2*t.studentt.cdf(-o,i[1].length-1))}}),t.extend(t.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/e.sqrt(this.cols()))},ttest:function(r,n){return 1===n?1-t.studentt.cdf(e.abs(this.tscore(r)),this.cols()-1):2*t.studentt.cdf(-e.abs(this.tscore(r)),this.cols()-1)}}),t.extend({anovafscore:function(){var n,o,i,a,u,l,c,s,f=r.call(arguments);if(1===f.length){for(u=new Array(f[0].length),c=0;c<f[0].length;c++)u[c]=f[0][c];f=u}for(o=new Array,c=0;c<f.length;c++)o=o.concat(f[c]);for(i=t.mean(o),n=0,c=0;c<f.length;c++)n+=f[c].length*e.pow(t.mean(f[c])-i,2);for(n/=f.length-1,l=0,c=0;c<f.length;c++)for(a=t.mean(f[c]),s=0;s<f[c].length;s++)l+=e.pow(f[c][s]-a,2);return n/(l/=o.length-f.length)},anovaftest:function(){var e,o,i,a,u=r.call(arguments);if(n(u[0]))return 1-t.centralF.cdf(u[0],u[1],u[2]);var l=t.anovafscore(u);for(e=u.length-1,i=0,a=0;a<u.length;a++)i+=u[a].length;return o=i-e-1,1-t.centralF.cdf(l,e,o)},ftest:function(e,r,n){return 1-t.centralF.cdf(e,r,n)}}),t.extend(t.fn,{anovafscore:function(){return t.anovafscore(this.toArray())},anovaftes:function(){var e,r=0;for(e=0;e<this.length;e++)r+=this[e].length;return t.ftest(this.anovafscore(),this.length-1,r-this.length)}}),t.extend({qscore:function(){var o,i,a,u,l,c=r.call(arguments);return n(c[0])?(o=c[0],i=c[1],a=c[2],u=c[3],l=c[4]):(o=t.mean(c[0]),i=t.mean(c[1]),a=c[0].length,u=c[1].length,l=c[2]),e.abs(o-i)/(l*e.sqrt((1/a+1/u)/2))},qtest:function(){var e,n=r.call(arguments);3===n.length?(e=n[0],n=n.slice(1)):7===n.length?(e=t.qscore(n[0],n[1],n[2],n[3],n[4]),n=n.slice(5)):(e=t.qscore(n[0],n[1],n[2]),n=n.slice(3));var o=n[0],i=n[1];return 1-t.tukey.cdf(e,i,o-i)},tukeyhsd:function(e){for(var r=t.pooledstdev(e),n=e.map((function(e){return t.mean(e)})),o=e.reduce((function(t,e){return t+e.length}),0),i=[],a=0;a<e.length;++a)for(var u=a+1;u<e.length;++u){var l=t.qtest(n[a],n[u],e[a].length,e[u].length,r,o,e.length);i.push([[a,u],l])}return i}}),t.extend({normalci:function(){var n,o=r.call(arguments),i=new Array(2);return n=4===o.length?e.abs(t.normal.inv(o[1]/2,0,1)*o[2]/e.sqrt(o[3])):e.abs(t.normal.inv(o[1]/2,0,1)*t.stdev(o[2])/e.sqrt(o[2].length)),i[0]=o[0]-n,i[1]=o[0]+n,i},tci:function(){var n,o=r.call(arguments),i=new Array(2);return n=4===o.length?e.abs(t.studentt.inv(o[1]/2,o[3]-1)*o[2]/e.sqrt(o[3])):e.abs(t.studentt.inv(o[1]/2,o[2].length-1)*t.stdev(o[2],!0)/e.sqrt(o[2].length)),i[0]=o[0]-n,i[1]=o[0]+n,i},significant:function(t,e){return t<e}}),t.extend(t.fn,{normalci:function(e,r){return t.normalci(e,r,this.toArray())},tci:function(e,r){return t.tci(e,r,this.toArray())}}),t.extend(t.fn,{oneSidedDifferenceOfProportions:function(e,r,n,o){var a=i(e,r,n,o);return t.ztest(a,1)},twoSidedDifferenceOfProportions:function(e,r,n,o){var a=i(e,r,n,o);return t.ztest(a,2)}})}(n,Math),n.models=function(){function t(t,e){var r=t.length,o=e[0].length-1,i=r-o-1,a=n.lstsq(e,t),u=n.multiply(e,a.map((function(t){return[t]}))).map((function(t){return t[0]})),l=n.subtract(t,u),c=n.mean(t),s=n.sum(u.map((function(t){return Math.pow(t-c,2)}))),f=n.sum(t.map((function(t,e){return Math.pow(t-u[e],2)}))),h=s+f;return{exog:e,endog:t,nobs:r,df_model:o,df_resid:i,coef:a,predict:u,resid:l,ybar:c,SST:h,SSE:s,SSR:f,R2:s/h}}function e(e){var r,o,i=(r=e.exog,o=r[0].length,n.arange(o).map((function(e){var i=n.arange(o).filter((function(t){return t!==e}));return t(n.col(r,e).map((function(t){return t[0]})),n.col(r,i))}))),a=Math.sqrt(e.SSR/e.df_resid),u=i.map((function(t){var e=t.SST,r=t.R2;return a/Math.sqrt(e*(1-r))})),l=e.coef.map((function(t,e){return(t-0)/u[e]})),c=l.map((function(t){var r=n.studentt.cdf(t,e.df_resid);return 2*(r>.5?1-r:r)})),s=n.studentt.inv(.975,e.df_resid),f=e.coef.map((function(t,e){var r=s*u[e];return[t-r,t+r]}));return{se:u,t:l,p:c,sigmaHat:a,interval95:f}}return{ols:function(r,o){var i=t(r,o),a=e(i),u=function(t){var e,r,o,i=t.R2/t.df_model/((1-t.R2)/t.df_resid);return{F_statistic:i,pvalue:1-(e=i,r=t.df_model,o=t.df_resid,n.beta.cdf(e/(o/r+e),r/2,o/2))}}(i),l=1-(1-i.R2)*((i.nobs-1)/i.df_resid);return i.t=a,i.f=u,i.adjust_R2=l,i}}}(),n.extend({buildxmatrix:function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;e++){var r=[1];t[e]=r.concat(arguments[e])}return n(t)},builddxmatrix:function(){for(var t=new Array(arguments[0].length),e=0;e<arguments[0].length;e++){var r=[1];t[e]=r.concat(arguments[0][e])}return n(t)},buildjxmatrix:function(t){for(var e=new Array(t.length),r=0;r<t.length;r++)e[r]=t[r];return n.builddxmatrix(e)},buildymatrix:function(t){return n(t).transpose()},buildjymatrix:function(t){return t.transpose()},matrixmult:function(t,e){var r,o,i,a,u;if(t.cols()==e.rows()){if(e.rows()>1){for(a=[],r=0;r<t.rows();r++)for(a[r]=[],o=0;o<e.cols();o++){for(u=0,i=0;i<t.cols();i++)u+=t.toArray()[r][i]*e.toArray()[i][o];a[r][o]=u}return n(a)}for(a=[],r=0;r<t.rows();r++)for(a[r]=[],o=0;o<e.cols();o++){for(u=0,i=0;i<t.cols();i++)u+=t.toArray()[r][i]*e.toArray()[o];a[r][o]=u}return n(a)}},regress:function(t,e){var r=n.xtranspxinv(t),o=t.transpose(),i=n.matrixmult(n(r),o);return n.matrixmult(i,e)},regresst:function(t,e,r){var o=n.regress(t,e),i={anova:{}},a=n.jMatYBar(t,o);i.yBar=a;var u=e.mean();i.anova.residuals=n.residuals(e,a),i.anova.ssr=n.ssr(a,u),i.anova.msr=i.anova.ssr/(t[0].length-1),i.anova.sse=n.sse(e,a),i.anova.mse=i.anova.sse/(e.length-(t[0].length-1)-1),i.anova.sst=n.sst(e,u),i.anova.mst=i.anova.sst/(e.length-1),i.anova.r2=1-i.anova.sse/i.anova.sst,i.anova.r2<0&&(i.anova.r2=0),i.anova.fratio=i.anova.msr/i.anova.mse,i.anova.pvalue=n.anovaftest(i.anova.fratio,t[0].length-1,e.length-(t[0].length-1)-1),i.anova.rmse=Math.sqrt(i.anova.mse),i.anova.r2adj=1-i.anova.mse/i.anova.mst,i.anova.r2adj<0&&(i.anova.r2adj=0),i.stats=new Array(t[0].length);for(var l,c,s,f=n.xtranspxinv(t),h=0;h<o.length;h++)l=Math.sqrt(i.anova.mse*Math.abs(f[h][h])),c=Math.abs(o[h]/l),s=n.ttest(c,e.length-t[0].length-1,r),i.stats[h]=[o[h],l,c,s];return i.regress=o,i},xtranspx:function(t){return n.matrixmult(t.transpose(),t)},xtranspxinv:function(t){var e=n.matrixmult(t.transpose(),t);return n.inv(e)},jMatYBar:function(t,e){var r=n.matrixmult(t,e);return new n(r)},residuals:function(t,e){return n.matrixsubtract(t,e)},ssr:function(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e,2);return r},sse:function(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return r},sst:function(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e,2);return r},matrixsubtract:function(t,e){for(var r=new Array(t.length),o=0;o<t.length;o++){r[o]=new Array(t[o].length);for(var i=0;i<t[o].length;i++)r[o][i]=t[o][i]-e[o][i]}return n(r)}}),n.jStat=n,n)},function(t,e,r){var n=r(1),o=r(0);e.UNIQUE=function(){for(var t=[],e=0;e<arguments.length;++e){for(var r=!1,n=arguments[e],o=0;o<t.length&&!(r=t[o]===n);++o);r||t.push(n)}return t},e.FLATTEN=n.flatten,e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},e.REFERENCE=function(t,e){if(!arguments.length)return o.error;try{for(var r=e.split("."),n=t,i=0;i<r.length;++i){var a=r[i];if("]"===a[a.length-1]){var u=a.indexOf("["),l=a.substring(u+1,a.length-1);n=n[a.substring(0,u)][l]}else n=n[a]}return n}catch(t){}},e.JOIN=function(t,e){return t.join(e)},e.NUMBERS=function(){var t=n.flatten(arguments);return t.filter((function(t){return"number"==typeof t}))}},function(t,e,r){var n=r(0),o=r(10),i=r(5),a=r(1),u=r(15);function l(t){return/^[01]{1,10}$/.test(t)}e.BESSELI=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?n.value:u.besseli(t,e)},e.BESSELJ=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?n.value:u.besselj(t,e)},e.BESSELK=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?n.value:u.besselk(t,e)},e.BESSELY=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?n.value:u.bessely(t,e)},e.BIN2DEC=function(t){if(!l(t))return n.num;var e=parseInt(t,2),r=t.toString();return 10===r.length&&"1"===r.substring(0,1)?parseInt(r.substring(1),2)-512:e},e.BIN2HEX=function(t,e){if(!l(t))return n.num;var r=t.toString();if(10===r.length&&"1"===r.substring(0,1))return(0xfffffffe00+parseInt(r.substring(1),2)).toString(16);var o=parseInt(t,2).toString(16);return void 0===e?o:isNaN(e)?n.value:e<0?n.num:(e=Math.floor(e))>=o.length?i.REPT("0",e-o.length)+o:n.num},e.BIN2OCT=function(t,e){if(!l(t))return n.num;var r=t.toString();if(10===r.length&&"1"===r.substring(0,1))return(1073741312+parseInt(r.substring(1),2)).toString(8);var o=parseInt(t,2).toString(8);return void 0===e?o:isNaN(e)?n.value:e<0?n.num:(e=Math.floor(e))>=o.length?i.REPT("0",e-o.length)+o:n.num},e.BITAND=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?n.value:t<0||e<0||Math.floor(t)!==t||Math.floor(e)!==e||t>0xffffffffffff||e>0xffffffffffff?n.num:t&e},e.BITLSHIFT=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?n.value:t<0||Math.floor(t)!==t||t>0xffffffffffff||Math.abs(e)>53?n.num:e>=0?t<<e:t>>-e},e.BITOR=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?n.value:t<0||e<0||Math.floor(t)!==t||Math.floor(e)!==e||t>0xffffffffffff||e>0xffffffffffff?n.num:t|e},e.BITRSHIFT=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?n.value:t<0||Math.floor(t)!==t||t>0xffffffffffff||Math.abs(e)>53?n.num:e>=0?t>>e:t<<-e},e.BITXOR=function(t,e){return t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?n.value:t<0||e<0||Math.floor(t)!==t||Math.floor(e)!==e||t>0xffffffffffff||e>0xffffffffffff?n.num:t^e},e.COMPLEX=function(t,e,r){if(t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e))return t;if("i"!==(r=void 0===r?"i":r)&&"j"!==r)return n.value;if(0===t&&0===e)return 0;if(0===t)return 1===e?r:e.toString()+r;if(0===e)return t.toString();var o=e>0?"+":"";return t.toString()+o+(1===e?r:e.toString()+r)},e.CONVERT=function(t,e,r){if((t=a.parseNumber(t))instanceof Error)return t;for(var o,i=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],u={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},l={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},c=null,s=null,f=e,h=r,p=1,y=1,v=0;v<i.length;v++)o=null===i[v][2]?[]:i[v][2],(i[v][1]===f||o.indexOf(f)>=0)&&(c=i[v]),(i[v][1]===h||o.indexOf(h)>=0)&&(s=i[v]);if(null===c){var b=u[e.substring(0,2)],m=l[e.substring(0,1)];"da"===e.substring(0,2)&&(m=["dekao",10,"da"]),b?(p=b[2],f=e.substring(2)):m&&(p=m[1],f=e.substring(m[2].length));for(var d=0;d<i.length;d++)o=null===i[d][2]?[]:i[d][2],(i[d][1]===f||o.indexOf(f)>=0)&&(c=i[d])}if(null===s){var g=u[r.substring(0,2)],w=l[r.substring(0,1)];"da"===r.substring(0,2)&&(w=["dekao",10,"da"]),g?(y=g[2],h=r.substring(2)):w&&(y=w[1],h=r.substring(w[2].length));for(var E=0;E<i.length;E++)o=null===i[E][2]?[]:i[E][2],(i[E][1]===h||o.indexOf(h)>=0)&&(s=i[E])}return null===c||null===s||c[3]!==s[3]?n.na:t*c[6]*p/(s[6]*y)},e.DEC2BIN=function(t,e){if((t=a.parseNumber(t))instanceof Error)return t;if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||t>511)return n.num;if(t<0)return"1"+i.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var r=parseInt(t,10).toString(2);return void 0===e?r:isNaN(e)?n.value:e<0?n.num:(e=Math.floor(e))>=r.length?i.REPT("0",e-r.length)+r:n.num},e.DEC2HEX=function(t,e){if((t=a.parseNumber(t))instanceof Error)return t;if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||t>549755813887)return n.num;if(t<0)return(1099511627776+t).toString(16);var r=parseInt(t,10).toString(16);return void 0===e?r:isNaN(e)?n.value:e<0?n.num:(e=Math.floor(e))>=r.length?i.REPT("0",e-r.length)+r:n.num},e.DEC2OCT=function(t,e){if((t=a.parseNumber(t))instanceof Error)return t;if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||t>536870911)return n.num;if(t<0)return(1073741824+t).toString(8);var r=parseInt(t,10).toString(8);return void 0===e?r:isNaN(e)?n.value:e<0?n.num:(e=Math.floor(e))>=r.length?i.REPT("0",e-r.length)+r:n.num},e.DELTA=function(t,e){return e=void 0===e?0:e,t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?n.value:t===e?1:0},e.ERF=function(t,e){return e=void 0===e?0:e,t=a.parseNumber(t),e=a.parseNumber(e),a.anyIsError(t,e)?n.value:o.erf(t)},e.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},e.ERFC=function(t){return isNaN(t)?n.value:o.erfc(t)},e.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},e.GESTEP=function(t,e){return e=e||0,t=a.parseNumber(t),a.anyIsError(e,t)?t:t>=e?1:0},e.HEX2BIN=function(t,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return n.num;var r=10===t.length&&"f"===t.substring(0,1).toLowerCase(),o=r?parseInt(t,16)-1099511627776:parseInt(t,16);if(o<-512||o>511)return n.num;if(r)return"1"+i.REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2);var a=o.toString(2);return void 0===e?a:isNaN(e)?n.value:e<0?n.num:(e=Math.floor(e))>=a.length?i.REPT("0",e-a.length)+a:n.num},e.HEX2DEC=function(t){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return n.num;var e=parseInt(t,16);return e>=549755813888?e-1099511627776:e},e.HEX2OCT=function(t,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return n.num;var r=parseInt(t,16);if(r>536870911&&r<0xffe0000000)return n.num;if(r>=0xffe0000000)return(r-0xffc0000000).toString(8);var o=r.toString(8);return void 0===e?o:isNaN(e)?n.value:e<0?n.num:(e=Math.floor(e))>=o.length?i.REPT("0",e-o.length)+o:n.num},e.IMABS=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(r,o)?n.value:Math.sqrt(Math.pow(r,2)+Math.pow(o,2))},e.IMAGINARY=function(t){if(void 0===t||!0===t||!1===t)return n.value;if(0===t||"0"===t)return 0;if(["i","j"].indexOf(t)>=0)return 1;var e=(t=t.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),r=t.indexOf("-");0===e&&(e=t.indexOf("+",1)),0===r&&(r=t.indexOf("-",1));var o=t.substring(t.length-1,t.length),i="i"===o||"j"===o;return e>=0||r>=0?i?e>=0?isNaN(t.substring(0,e))||isNaN(t.substring(e+1,t.length-1))?n.num:Number(t.substring(e+1,t.length-1)):isNaN(t.substring(0,r))||isNaN(t.substring(r+1,t.length-1))?n.num:-Number(t.substring(r+1,t.length-1)):n.num:i?isNaN(t.substring(0,t.length-1))?n.num:t.substring(0,t.length-1):isNaN(t)?n.num:0},e.IMARGUMENT=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(r,o)?n.value:0===r&&0===o?n.div0:0===r&&o>0?Math.PI/2:0===r&&o<0?-Math.PI/2:0===o&&r>0?0:0===o&&r<0?-Math.PI:r>0?Math.atan(o/r):r<0&&o>=0?Math.atan(o/r)+Math.PI:Math.atan(o/r)-Math.PI},e.IMCONJUGATE=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(r,o))return n.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",0!==o?e.COMPLEX(r,-o,i):t},e.IMCOS=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(r,o))return n.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(r)*(Math.exp(o)+Math.exp(-o))/2,-Math.sin(r)*(Math.exp(o)-Math.exp(-o))/2,i)},e.IMCOSH=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(r,o))return n.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(o)*(Math.exp(r)+Math.exp(-r))/2,Math.sin(o)*(Math.exp(r)-Math.exp(-r))/2,i)},e.IMCOT=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(r,o)?n.value:e.IMDIV(e.IMCOS(t),e.IMSIN(t))},e.IMDIV=function(t,r){var o=e.IMREAL(t),i=e.IMAGINARY(t),u=e.IMREAL(r),l=e.IMAGINARY(r);if(a.anyIsError(o,i,u,l))return n.value;var c=t.substring(t.length-1),s=r.substring(r.length-1),f="i";if(("j"===c||"j"===s)&&(f="j"),0===u&&0===l)return n.num;var h=u*u+l*l;return e.COMPLEX((o*u+i*l)/h,(i*u-o*l)/h,f)},e.IMEXP=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(r,o))return n.value;var i=t.substring(t.length-1);i="i"===i||"j"===i?i:"i";var u=Math.exp(r);return e.COMPLEX(u*Math.cos(o),u*Math.sin(o),i)},e.IMLN=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(r,o))return n.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(r*r+o*o)),Math.atan(o/r),i)},e.IMLOG10=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(r,o))return n.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(r*r+o*o))/Math.log(10),Math.atan(o/r)/Math.log(10),i)},e.IMLOG2=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(r,o))return n.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.log(Math.sqrt(r*r+o*o))/Math.log(2),Math.atan(o/r)/Math.log(2),i)},e.IMPOWER=function(t,r){r=a.parseNumber(r);var o=e.IMREAL(t),i=e.IMAGINARY(t);if(a.anyIsError(r,o,i))return n.value;var u=t.substring(t.length-1);u="i"===u||"j"===u?u:"i";var l=Math.pow(e.IMABS(t),r),c=e.IMARGUMENT(t);return e.COMPLEX(l*Math.cos(r*c),l*Math.sin(r*c),u)},e.IMPRODUCT=function(){var t=arguments[0];if(!arguments.length)return n.value;for(var r=1;r<arguments.length;r++){var o=e.IMREAL(t),i=e.IMAGINARY(t),u=e.IMREAL(arguments[r]),l=e.IMAGINARY(arguments[r]);if(a.anyIsError(o,i,u,l))return n.value;t=e.COMPLEX(o*u-i*l,o*l+i*u)}return t},e.IMREAL=function(t){if(void 0===t||!0===t||!1===t)return n.value;if(0===t||"0"===t)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t)>=0)return 0;var e=t.indexOf("+"),r=t.indexOf("-");0===e&&(e=t.indexOf("+",1)),0===r&&(r=t.indexOf("-",1));var o=t.substring(t.length-1,t.length),i="i"===o||"j"===o;return e>=0||r>=0?i?e>=0?isNaN(t.substring(0,e))||isNaN(t.substring(e+1,t.length-1))?n.num:Number(t.substring(0,e)):isNaN(t.substring(0,r))||isNaN(t.substring(r+1,t.length-1))?n.num:Number(t.substring(0,r)):n.num:i?isNaN(t.substring(0,t.length-1))?n.num:0:isNaN(t)?n.num:t},e.IMSEC=function(t){if(!0===t||!1===t)return n.value;var r=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(r,o)?n.value:e.IMDIV("1",e.IMCOS(t))},e.IMSECH=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(r,o)?n.value:e.IMDIV("1",e.IMCOSH(t))},e.IMSIN=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(r,o))return n.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.sin(r)*(Math.exp(o)+Math.exp(-o))/2,Math.cos(r)*(Math.exp(o)-Math.exp(-o))/2,i)},e.IMSINH=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(r,o))return n.value;var i=t.substring(t.length-1);return i="i"===i||"j"===i?i:"i",e.COMPLEX(Math.cos(o)*(Math.exp(r)-Math.exp(-r))/2,Math.sin(o)*(Math.exp(r)+Math.exp(-r))/2,i)},e.IMSQRT=function(t){var r=e.IMREAL(t),o=e.IMAGINARY(t);if(a.anyIsError(r,o))return n.value;var i=t.substring(t.length-1);i="i"===i||"j"===i?i:"i";var u=Math.sqrt(e.IMABS(t)),l=e.IMARGUMENT(t);return e.COMPLEX(u*Math.cos(l/2),u*Math.sin(l/2),i)},e.IMCSC=function(t){if(!0===t||!1===t)return n.value;var r=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(r,o)?n.num:e.IMDIV("1",e.IMSIN(t))},e.IMCSCH=function(t){if(!0===t||!1===t)return n.value;var r=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(r,o)?n.num:e.IMDIV("1",e.IMSINH(t))},e.IMSUB=function(t,e){var r=this.IMREAL(t),o=this.IMAGINARY(t),i=this.IMREAL(e),u=this.IMAGINARY(e);if(a.anyIsError(r,o,i,u))return n.value;var l=t.substring(t.length-1),c=e.substring(e.length-1),s="i";return("j"===l||"j"===c)&&(s="j"),this.COMPLEX(r-i,o-u,s)},e.IMSUM=function(){if(!arguments.length)return n.value;for(var t=a.flatten(arguments),e=t[0],r=1;r<t.length;r++){var o=this.IMREAL(e),i=this.IMAGINARY(e),u=this.IMREAL(t[r]),l=this.IMAGINARY(t[r]);if(a.anyIsError(o,i,u,l))return n.value;e=this.COMPLEX(o+u,i+l)}return e},e.IMTAN=function(t){if(!0===t||!1===t)return n.value;var r=e.IMREAL(t),o=e.IMAGINARY(t);return a.anyIsError(r,o)?n.value:this.IMDIV(this.IMSIN(t),this.IMCOS(t))},e.OCT2BIN=function(t,e){if(!/^[0-7]{1,10}$/.test(t))return n.num;var r=10===t.length&&"7"===t.substring(0,1),o=r?parseInt(t,8)-1073741824:parseInt(t,8);if(o<-512||o>511)return n.num;if(r)return"1"+i.REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2);var a=o.toString(2);return void 0===e?a:isNaN(e)?n.value:e<0?n.num:(e=Math.floor(e))>=a.length?i.REPT("0",e-a.length)+a:n.num},e.OCT2DEC=function(t){if(!/^[0-7]{1,10}$/.test(t))return n.num;var e=parseInt(t,8);return e>=536870912?e-1073741824:e},e.OCT2HEX=function(t,e){if(!/^[0-7]{1,10}$/.test(t))return n.num;var r=parseInt(t,8);if(r>=536870912)return"ff"+(r+3221225472).toString(16);var o=r.toString(16);return void 0===e?o:isNaN(e)?n.value:e<0?n.num:(e=Math.floor(e))>=o.length?i.REPT("0",e-o.length)+o:n.num}},function(t,e){function r(){}r.prototype={on:function(t,e,r){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:r}),this},once:function(t,e,r){var n=this;function o(){n.off(t,o),e.apply(r,arguments)}return o._=e,this.on(t,o,r)},emit:function(t){for(var e=[].slice.call(arguments,1),r=((this.e||(this.e={}))[t]||[]).slice(),n=0,o=r.length;n<o;n++)r[n].fn.apply(r[n].ctx,e);return this},off:function(t,e){var r=this.e||(this.e={}),n=r[t],o=[];if(n&&e)for(var i=0,a=n.length;i<a;i++)n[i].fn!==e&&n[i].fn._!==e&&o.push(n[i]);return o.length?r[t]=o:delete r[t],this}},t.exports=r,t.exports.TinyEmitter=r},function(t,e,r){var n=r(3),o=r(4),i=r(12),a=r(8);function u(t,e){if(e)for(var r in e)t[r]=e[r];return t}e.BETADIST=o.BETA.DIST,e.BETAINV=o.BETA.INV,e.BINOMDIST=o.BINOM.DIST,e.CEILING=e.ISOCEILING=u(n.CEILING.MATH,n.CEILING),e.CEILINGMATH=n.CEILING.MATH,e.CEILINGPRECISE=n.CEILING.PRECISE,e.CHIDIST=o.CHISQ.DIST,e.CHIDISTRT=o.CHISQ.DIST.RT,e.CHIINV=o.CHISQ.INV,e.CHIINVRT=o.CHISQ.INV.RT,e.CHITEST=o.CHISQ.TEST,e.CONFIDENCE=u(o.CONFIDENCE.NORM,o.CONFIDENCE),e.COVAR=o.COVARIANCE.P,e.COVARIANCEP=o.COVARIANCE.P,e.COVARIANCES=o.COVARIANCE.S,e.CRITBINOM=o.BINOM.INV,e.EXPONDIST=o.EXPON.DIST,e.ERFCPRECISE=i.ERFC.PRECISE,e.ERFPRECISE=i.ERF.PRECISE,e.FDIST=o.F.DIST,e.FDISTRT=o.F.DIST.RT,e.FINVRT=o.F.INV.RT,e.FINV=o.F.INV,e.FLOOR=u(n.FLOOR.MATH,n.FLOOR),e.FLOORMATH=n.FLOOR.MATH,e.FLOORPRECISE=n.FLOOR.PRECISE,e.FTEST=o.F.TEST,e.GAMMADIST=o.GAMMA.DIST,e.GAMMAINV=o.GAMMA.INV,e.GAMMALNPRECISE=o.GAMMALN.PRECISE,e.HYPGEOMDIST=o.HYPGEOM.DIST,e.LOGINV=o.LOGNORM.INV,e.LOGNORMINV=o.LOGNORM.INV,e.LOGNORMDIST=o.LOGNORM.DIST,e.MODE=u(o.MODE.SNGL,o.MODE),e.MODEMULT=o.MODE.MULT,e.MODESNGL=o.MODE.SNGL,e.NEGBINOMDIST=o.NEGBINOM.DIST,e.NETWORKDAYSINTL=a.NETWORKDAYS.INTL,e.NORMDIST=o.NORM.DIST,e.NORMINV=o.NORM.INV,e.NORMSDIST=o.NORM.S.DIST,e.NORMSINV=o.NORM.S.INV,e.PERCENTILE=u(o.PERCENTILE.EXC,o.PERCENTILE),e.PERCENTILEEXC=o.PERCENTILE.EXC,e.PERCENTILEINC=o.PERCENTILE.INC,e.PERCENTRANK=u(o.PERCENTRANK.INC,o.PERCENTRANK),e.PERCENTRANKEXC=o.PERCENTRANK.EXC,e.PERCENTRANKINC=o.PERCENTRANK.INC,e.POISSON=u(o.POISSON.DIST,o.POISSON),e.POISSONDIST=o.POISSON.DIST,e.QUARTILE=u(o.QUARTILE.INC,o.QUARTILE),e.QUARTILEEXC=o.QUARTILE.EXC,e.QUARTILEINC=o.QUARTILE.INC,e.RANK=u(o.RANK.EQ,o.RANK),e.RANKAVG=o.RANK.AVG,e.RANKEQ=o.RANK.EQ,e.SKEWP=o.SKEW.P,e.STDEV=u(o.STDEV.S,o.STDEV),e.STDEVP=o.STDEV.P,e.STDEVS=o.STDEV.S,e.TDIST=o.T.DIST,e.TDISTRT=o.T.DIST.RT,e.TINV=o.T.INV,e.TTEST=o.T.TEST,e.VAR=u(o.VAR.S,o.VAR),e.VARP=o.VAR.P,e.VARS=o.VAR.S,e.WEIBULL=u(o.WEIBULL.DIST,o.WEIBULL),e.WEIBULLDIST=o.WEIBULL.DIST,e.WORKDAYINTL=a.WORKDAY.INTL,e.ZTEST=o.Z.TEST},function(t,e,r){var n;n=function(t){t.version="1.0.2";var e=Math;function r(t,e){for(var r=0,n=0;r<t.length;++r)n=e*n+t[r];return n}function n(t,e,r,n,o){if(0===e)return r;if(1===e)return n;for(var i=2/t,a=n,u=1;u<e;++u)a=n*u*i+o*r,r=n,n=a;return a}function o(t,e,r,o,i){return function(r,a){if(o){if(0===r)return 1==o?-1/0:1/0;if(r<0)return NaN}return 0===a?t(r):1===a?e(r):a<0?NaN:n(r,a|=0,t(r),e(r),i)}}var i,a,u,l,c,s,f,h,p,y,v,b,m,d=function(){var t=.636619772,o=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),u=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function l(n){var l=0,c=0,s=0,f=n*n;if(n<8)l=(c=r(o,f))/(s=r(i,f));else{var h=n-.785398164;c=r(a,f=64/f),s=r(u,f),l=e.sqrt(t/n)*(e.cos(h)*c-e.sin(h)*s*8/n)}return l}var c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),s=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function p(n){var o=0,i=0,a=0,u=n*n,l=e.abs(n)-2.356194491;return Math.abs(n)<8?o=(i=n*r(c,u))/(a=r(s,u)):(i=r(f,u=64/u),a=r(h,u),o=e.sqrt(t/e.abs(n))*(e.cos(l)*i-e.sin(l)*a*8/e.abs(n)),n<0&&(o=-o)),o}return function t(r,o){if(o=Math.round(o),!isFinite(r))return isNaN(r)?r:0;if(o<0)return(o%2?-1:1)*t(r,-o);if(r<0)return(o%2?-1:1)*t(-r,o);if(0===o)return l(r);if(1===o)return p(r);if(0===r)return 0;var i=0;if(r>o)i=n(r,o,l(r),p(r),-1);else{for(var a=!1,u=0,c=0,s=1,f=0,h=2/r,y=2*e.floor((o+e.floor(e.sqrt(40*o)))/2);y>0;y--)f=y*h*s-u,u=s,s=f,e.abs(s)>1e10&&(s*=1e-10,u*=1e-10,i*=1e-10,c*=1e-10),a&&(c+=s),a=!a,y==o&&(i=u);i/=c=2*c-s}return i}}(),g=(i=.636619772,a=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),u=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),c=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),s=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),f=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),h=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),o((function(t){var n=0,o=0,s=0,f=t*t,h=t-.785398164;return t<8?n=(o=r(a,f))/(s=r(u,f))+i*d(t,0)*e.log(t):(o=r(l,f=64/f),s=r(c,f),n=e.sqrt(i/t)*(e.sin(h)*o+e.cos(h)*s*8/t)),n}),(function(t){var n=0,o=0,a=0,u=t*t,l=t-2.356194491;return t<8?n=(o=t*r(s,u))/(a=r(f,u))+i*(d(t,1)*e.log(t)-1/t):(o=r(h,u=64/u),a=r(p,u),n=e.sqrt(i/t)*(e.sin(l)*o+e.cos(l)*a*8/t)),n}),0,1,-1)),w=(y=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),v=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),b=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),m=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function t(n,o){if(0===(o=Math.round(o)))return function(t){return t<=3.75?r(y,t*t/14.0625):e.exp(e.abs(t))/e.sqrt(e.abs(t))*r(v,3.75/e.abs(t))}(n);if(1===o)return function(t){return t<3.75?t*r(b,t*t/14.0625):(t<0?-1:1)*e.exp(e.abs(t))/e.sqrt(e.abs(t))*r(m,3.75/e.abs(t))}(n);if(o<0)return NaN;if(0===e.abs(n))return 0;if(n==1/0)return 1/0;var i,a=0,u=2/e.abs(n),l=0,c=1,s=0;for(i=2*e.round((o+e.round(e.sqrt(40*o)))/2);i>0;i--)s=i*u*c+l,l=c,c=s,e.abs(c)>1e10&&(c*=1e-10,l*=1e-10,a*=1e-10),i==o&&(a=l);return a*=t(n,0)/c,n<0&&o%2?-a:a}),E=function(){var t=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),n=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),i=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),a=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return o((function(o){return o<=2?-e.log(o/2)*w(o,0)+r(t,o*o/4):e.exp(-o)/e.sqrt(o)*r(n,2/o)}),(function(t){return t<=2?e.log(t/2)*w(t,1)+1/t*r(i,t*t/4):e.exp(-t)/e.sqrt(t)*r(a,2/t)}),0,2,1)}();t.besselj=d,t.bessely=g,t.besseli=w,t.besselk=E},"undefined"==typeof DO_NOT_EXPORT_BESSEL?n(e):n({})},function(t,e,r){var n=r(0),o=r(4),i=r(3),a=r(1),u=r(6);function l(t){var e=[];return a.arrayEach(t,(function(t){t&&e.push(t)})),e}function c(t,e){for(var r={},n=1;n<t[0].length;++n)r[n]=!0;var o=e[0].length;for(n=1;n<e.length;++n)e[n].length>o&&(o=e[n].length);for(var i=1;i<t.length;++i)for(var a=1;a<t[i].length;++a){for(var l=!1,c=!1,s=0;s<e.length;++s){var f=e[s];if(!(f.length<o)){var h=f[0];if(t[i][0]===h){c=!0;for(var p=1;p<f.length;++p){if(!l)if(void 0===f[p]||"*"===f[p])l=!0;else{var y=u.parse(f[p]+""),v=[u.createToken(t[i][a],u.TOKEN_TYPE_LITERAL)].concat(y);l=u.compute(v)}}}}}c&&(r[a]=r[a]&&l)}for(var b=[],m=0;m<t[0].length;++m)r[m]&&b.push(m-1);return b}e.FINDFIELD=function(t,e){var r=null;return a.arrayEach(t,(function(t,n){if(t[0]===e)return r=n,!1})),null==r?n.value:r},e.DAVERAGE=function(t,r,o){if(isNaN(r)&&"string"!=typeof r)return n.value;var i=c(t,o),u=[];if("string"==typeof r){var l=e.FINDFIELD(t,r);u=a.rest(t[l])}else u=a.rest(t[r]);var s=0;return a.arrayEach(i,(function(t){s+=u[t]})),0===i.length?n.div0:s/i.length},e.DCOUNT=function(t,r,i){if(isNaN(r)&&"string"!=typeof r)return n.value;var u=c(t,i),l=[];if("string"==typeof r){var s=e.FINDFIELD(t,r);l=a.rest(t[s])}else l=a.rest(t[r]);var f=[];return a.arrayEach(u,(function(t){f.push(l[t])})),o.COUNT(f)},e.DCOUNTA=function(t,r,i){if(isNaN(r)&&"string"!=typeof r)return n.value;var u=c(t,i),l=[];if("string"==typeof r){var s=e.FINDFIELD(t,r);l=a.rest(t[s])}else l=a.rest(t[r]);var f=[];return a.arrayEach(u,(function(t){f.push(l[t])})),o.COUNTA(f)},e.DGET=function(t,r,o){if(isNaN(r)&&"string"!=typeof r)return n.value;var i=c(t,o),u=[];if("string"==typeof r){var l=e.FINDFIELD(t,r);u=a.rest(t[l])}else u=a.rest(t[r]);return 0===i.length?n.value:i.length>1?n.num:u[i[0]]},e.DMAX=function(t,r,o){if(isNaN(r)&&"string"!=typeof r)return n.value;var i=c(t,o),u=[];if("string"==typeof r){var l=e.FINDFIELD(t,r);u=a.rest(t[l])}else u=a.rest(t[r]);var s=u[i[0]];return a.arrayEach(i,(function(t){s<u[t]&&(s=u[t])})),s},e.DMIN=function(t,r,o){if(isNaN(r)&&"string"!=typeof r)return n.value;var i=c(t,o),u=[];if("string"==typeof r){var l=e.FINDFIELD(t,r);u=a.rest(t[l])}else u=a.rest(t[r]);var s=u[i[0]];return a.arrayEach(i,(function(t){s>u[t]&&(s=u[t])})),s},e.DPRODUCT=function(t,r,o){if(isNaN(r)&&"string"!=typeof r)return n.value;var i=c(t,o),u=[];if("string"==typeof r){var s=e.FINDFIELD(t,r);u=a.rest(t[s])}else u=a.rest(t[r]);var f=[];a.arrayEach(i,(function(t){f.push(u[t])})),f=l(f);var h=1;return a.arrayEach(f,(function(t){h*=t})),h},e.DSTDEV=function(t,r,i){if(isNaN(r)&&"string"!=typeof r)return n.value;var u=c(t,i),s=[];if("string"==typeof r){var f=e.FINDFIELD(t,r);s=a.rest(t[f])}else s=a.rest(t[r]);var h=[];return a.arrayEach(u,(function(t){h.push(s[t])})),h=l(h),o.STDEV.S(h)},e.DSTDEVP=function(t,r,i){if(isNaN(r)&&"string"!=typeof r)return n.value;var u=c(t,i),s=[];if("string"==typeof r){var f=e.FINDFIELD(t,r);s=a.rest(t[f])}else s=a.rest(t[r]);var h=[];return a.arrayEach(u,(function(t){h.push(s[t])})),h=l(h),o.STDEV.P(h)},e.DSUM=function(t,r,o){if(isNaN(r)&&"string"!=typeof r)return n.value;var u=c(t,o),l=[];if("string"==typeof r){var s=e.FINDFIELD(t,r);l=a.rest(t[s])}else l=a.rest(t[r]);var f=[];return a.arrayEach(u,(function(t){f.push(l[t])})),i.SUM(f)},e.DVAR=function(t,r,i){if(isNaN(r)&&"string"!=typeof r)return n.value;var u=c(t,i),l=[];if("string"==typeof r){var s=e.FINDFIELD(t,r);l=a.rest(t[s])}else l=a.rest(t[r]);var f=[];return a.arrayEach(u,(function(t){f.push(l[t])})),o.VAR.S(f)},e.DVARP=function(t,r,i){if(isNaN(r)&&"string"!=typeof r)return n.value;var u=c(t,i),l=[];if("string"==typeof r){var s=e.FINDFIELD(t,r);l=a.rest(t[s])}else l=a.rest(t[r]);var f=[];return a.arrayEach(u,(function(t){f.push(l[t])})),o.VAR.P(f)}},function(t,e,r){var n=r(0),o=r(1),i=r(7);e.AND=function(){for(var t=o.flatten(arguments),e=!0,r=0;r<t.length;r++)t[r]||(e=!1);return e},e.CHOOSE=function(){if(arguments.length<2)return n.na;var t=arguments[0];return t<1||t>254||arguments.length<t+1?n.value:arguments[t]},e.FALSE=function(){return!1},e.IF=function(t,e,r){return t?e:r},e.IFERROR=function(t,e){return i.ISERROR(t)?e:t},e.IFNA=function(t,e){return t===n.na?e:t},e.NOT=function(t){return!t},e.OR=function(){for(var t=o.flatten(arguments),e=!1,r=0;r<t.length;r++)t[r]&&(e=!0);return e},e.TRUE=function(){return!0},e.XOR=function(){for(var t=o.flatten(arguments),e=0,r=0;r<t.length;r++)t[r]&&e++;return!!(1&Math.floor(Math.abs(e)))},e.SWITCH=function(){var t;if(arguments.length>0){var e=arguments[0],r=arguments.length-1,o=Math.floor(r/2),i=!1,a=r%2!=0,u=r%2==0?null:arguments[arguments.length-1];if(o)for(var l=0;l<o;l++)if(e===arguments[2*l+1]){t=arguments[2*l+2],i=!0;break}i||(t=a?u:n.na)}else t=n.value;return t}},function(t,e,r){var n=r(0),o=r(8),i=r(1);function a(t){return t&&t.getTime&&!isNaN(t.getTime())}function u(t){return t instanceof Date?t:new Date(t)}e.ACCRINT=function(t,e,r,i,l,c,s){return t=u(t),e=u(e),r=u(r),a(t)&&a(e)&&a(r)?i<=0||l<=0||-1===[1,2,4].indexOf(c)||-1===[0,1,2,3,4].indexOf(s)||r<=t?n.num:(s=s||0,(l=l||0)*i*o.YEARFRAC(t,r,s)):n.value},e.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},e.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},e.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},e.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},e.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},e.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},e.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},e.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},e.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},e.CUMIPMT=function(t,r,o,a,u,l){if(t=i.parseNumber(t),r=i.parseNumber(r),o=i.parseNumber(o),i.anyIsError(t,r,o))return n.value;if(t<=0||r<=0||o<=0)return n.num;if(a<1||u<1||a>u)return n.num;if(0!==l&&1!==l)return n.num;var c=e.PMT(t,r,o,0,l),s=0;1===a&&0===l&&(s=-o,a++);for(var f=a;f<=u;f++)s+=1===l?e.FV(t,f-2,c,o,1)-c:e.FV(t,f-1,c,o,0);return s*=t},e.CUMPRINC=function(t,r,o,a,u,l){if(t=i.parseNumber(t),r=i.parseNumber(r),o=i.parseNumber(o),i.anyIsError(t,r,o))return n.value;if(t<=0||r<=0||o<=0)return n.num;if(a<1||u<1||a>u)return n.num;if(0!==l&&1!==l)return n.num;var c=e.PMT(t,r,o,0,l),s=0;1===a&&(s=0===l?c+o*t:c,a++);for(var f=a;f<=u;f++)s+=l>0?c-(e.FV(t,f-2,c,o,1)-c)*t:c-e.FV(t,f-1,c,o,0)*t;return s},e.DB=function(t,e,r,o,a){if(a=void 0===a?12:a,t=i.parseNumber(t),e=i.parseNumber(e),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,r,o,a))return n.value;if(t<0||e<0||r<0||o<0)return n.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(a))return n.num;if(o>r)return n.num;if(e>=t)return 0;for(var u=(1-Math.pow(e/t,1/r)).toFixed(3),l=t*u*a/12,c=l,s=0,f=o===r?r-1:o,h=2;h<=f;h++)c+=s=(t-c)*u;return 1===o?l:o===r?(t-c)*u:s},e.DDB=function(t,e,r,o,a){if(a=void 0===a?2:a,t=i.parseNumber(t),e=i.parseNumber(e),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,r,o,a))return n.value;if(t<0||e<0||r<0||o<0||a<=0)return n.num;if(o>r)return n.num;if(e>=t)return 0;for(var u=0,l=0,c=1;c<=o;c++)u+=l=Math.min(a/r*(t-u),t-e-u);return l},e.DISC=function(){throw new Error("DISC is not implemented")},e.DOLLARDE=function(t,e){if(t=i.parseNumber(t),e=i.parseNumber(e),i.anyIsError(t,e))return n.value;if(e<0)return n.num;if(e>=0&&e<1)return n.div0;e=parseInt(e,10);var r=parseInt(t,10);r+=t%1*Math.pow(10,Math.ceil(Math.log(e)/Math.LN10))/e;var o=Math.pow(10,Math.ceil(Math.log(e)/Math.LN2)+1);return r=Math.round(r*o)/o},e.DOLLARFR=function(t,e){if(t=i.parseNumber(t),e=i.parseNumber(e),i.anyIsError(t,e))return n.value;if(e<0)return n.num;if(e>=0&&e<1)return n.div0;e=parseInt(e,10);var r=parseInt(t,10);return r+=t%1*Math.pow(10,-Math.ceil(Math.log(e)/Math.LN10))*e},e.DURATION=function(){throw new Error("DURATION is not implemented")},e.EFFECT=function(t,e){return t=i.parseNumber(t),e=i.parseNumber(e),i.anyIsError(t,e)?n.value:t<=0||e<1?n.num:(e=parseInt(e,10),Math.pow(1+t/e,e)-1)},e.FV=function(t,e,r,o,a){if(o=o||0,a=a||0,t=i.parseNumber(t),e=i.parseNumber(e),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,r,o,a))return n.value;var u;if(0===t)u=o+r*e;else{var l=Math.pow(1+t,e);u=1===a?o*l+r*(1+t)*(l-1)/t:o*l+r*(l-1)/t}return-u},e.FVSCHEDULE=function(t,e){if(t=i.parseNumber(t),e=i.parseNumberArray(i.flatten(e)),i.anyIsError(t,e))return n.value;for(var r=e.length,o=t,a=0;a<r;a++)o*=1+e[a];return o},e.INTRATE=function(){throw new Error("INTRATE is not implemented")},e.IPMT=function(t,r,o,a,u,l){if(u=u||0,l=l||0,t=i.parseNumber(t),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),u=i.parseNumber(u),l=i.parseNumber(l),i.anyIsError(t,r,o,a,u,l))return n.value;var c=e.PMT(t,o,a,u,l);return(1===r?1===l?0:-a:1===l?e.FV(t,r-2,c,a,1)-c:e.FV(t,r-1,c,a,0))*t},e.IRR=function(t,e){if(e=e||0,t=i.parseNumberArray(i.flatten(t)),e=i.parseNumber(e),i.anyIsError(t,e))return n.value;for(var r=function(t,e,r){for(var n=r+1,o=t[0],i=1;i<t.length;i++)o+=t[i]/Math.pow(n,(e[i]-e[0])/365);return o},o=function(t,e,r){for(var n=r+1,o=0,i=1;i<t.length;i++){var a=(e[i]-e[0])/365;o-=a*t[i]/Math.pow(n,a+1)}return o},a=[],u=!1,l=!1,c=0;c<t.length;c++)a[c]=0===c?0:a[c-1]+365,t[c]>0&&(u=!0),t[c]<0&&(l=!0);if(!u||!l)return n.num;var s,f,h,p=e=void 0===e?.1:e,y=!0;do{s=p-(h=r(t,a,p))/o(t,a,p),f=Math.abs(s-p),p=s,y=f>1e-10&&Math.abs(h)>1e-10}while(y);return p},e.ISPMT=function(t,e,r,o){return t=i.parseNumber(t),e=i.parseNumber(e),r=i.parseNumber(r),o=i.parseNumber(o),i.anyIsError(t,e,r,o)?n.value:o*t*(e/r-1)},e.MDURATION=function(){throw new Error("MDURATION is not implemented")},e.MIRR=function(t,r,o){if(t=i.parseNumberArray(i.flatten(t)),r=i.parseNumber(r),o=i.parseNumber(o),i.anyIsError(t,r,o))return n.value;for(var a=t.length,u=[],l=[],c=0;c<a;c++)t[c]<0?u.push(t[c]):l.push(t[c]);var s=-e.NPV(o,l)*Math.pow(1+o,a-1),f=e.NPV(r,u)*(1+r);return Math.pow(s/f,1/(a-1))-1},e.NOMINAL=function(t,e){return t=i.parseNumber(t),e=i.parseNumber(e),i.anyIsError(t,e)?n.value:t<=0||e<1?n.num:(e=parseInt(e,10),(Math.pow(t+1,1/e)-1)*e)},e.NPER=function(t,e,r,o,a){if(a=void 0===a?0:a,o=void 0===o?0:o,t=i.parseNumber(t),e=i.parseNumber(e),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,r,o,a))return n.value;var u=e*(1+t*a)-o*t,l=r*t+e*(1+t*a);return Math.log(u/l)/Math.log(1+t)},e.NPV=function(){var t=i.parseNumberArray(i.flatten(arguments));if(t instanceof Error)return t;for(var e=t[0],r=0,n=1;n<t.length;n++)r+=t[n]/Math.pow(1+e,n);return r},e.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},e.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},e.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},e.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},e.PDURATION=function(t,e,r){return t=i.parseNumber(t),e=i.parseNumber(e),r=i.parseNumber(r),i.anyIsError(t,e,r)?n.value:t<=0?n.num:(Math.log(r)-Math.log(e))/Math.log(1+t)},e.PMT=function(t,e,r,o,a){if(o=o||0,a=a||0,t=i.parseNumber(t),e=i.parseNumber(e),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,r,o,a))return n.value;var u;if(0===t)u=(r+o)/e;else{var l=Math.pow(1+t,e);u=1===a?(o*t/(l-1)+r*t/(1-1/l))/(1+t):o*t/(l-1)+r*t/(1-1/l)}return-u},e.PPMT=function(t,r,o,a,u,l){return u=u||0,l=l||0,t=i.parseNumber(t),o=i.parseNumber(o),a=i.parseNumber(a),u=i.parseNumber(u),l=i.parseNumber(l),i.anyIsError(t,o,a,u,l)?n.value:e.PMT(t,o,a,u,l)-e.IPMT(t,r,o,a,u,l)},e.PRICE=function(){throw new Error("PRICE is not implemented")},e.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},e.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},e.PV=function(t,e,r,o,a){return o=o||0,a=a||0,t=i.parseNumber(t),e=i.parseNumber(e),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(t,e,r,o,a)?n.value:0===t?-r*e-o:((1-Math.pow(1+t,e))/t*r*(1+t*a)-o)/Math.pow(1+t,e)},e.RATE=function(t,e,r,o,a,u){if(u=void 0===u?.01:u,o=void 0===o?0:o,a=void 0===a?0:a,t=i.parseNumber(t),e=i.parseNumber(e),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),u=i.parseNumber(u),i.anyIsError(t,e,r,o,a,u))return n.value;var l,c,s,f=0,h=0,p=0,y=u;for(Math.abs(y)<1e-10?r*(1+t*y)+e*(1+y*a)*t+o:r*(h=Math.exp(t*Math.log(1+y)))+e*(1/y+a)*(h-1)+o,l=r+e*t+o,c=r*h+e*(1/y+a)*(h-1)+o,p=s=0,f=y;Math.abs(l-c)>1e-10&&p<50;)y=(c*s-l*f)/(c-l),s=f,f=y,l=c,c=Math.abs(y)<1e-10?r*(1+t*y)+e*(1+y*a)*t+o:r*(h=Math.exp(t*Math.log(1+y)))+e*(1/y+a)*(h-1)+o,++p;return y},e.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},e.RRI=function(t,e,r){return t=i.parseNumber(t),e=i.parseNumber(e),r=i.parseNumber(r),i.anyIsError(t,e,r)?n.value:0===t||0===e?n.num:Math.pow(r/e,1/t)-1},e.SLN=function(t,e,r){return t=i.parseNumber(t),e=i.parseNumber(e),r=i.parseNumber(r),i.anyIsError(t,e,r)?n.value:0===r?n.num:(t-e)/r},e.SYD=function(t,e,r,o){return t=i.parseNumber(t),e=i.parseNumber(e),r=i.parseNumber(r),o=i.parseNumber(o),i.anyIsError(t,e,r,o)?n.value:0===r||o<1||o>r?n.num:(t-e)*(r-(o=parseInt(o,10))+1)*2/(r*(r+1))},e.TBILLEQ=function(t,e,r){return t=i.parseDate(t),e=i.parseDate(e),r=i.parseNumber(r),i.anyIsError(t,e,r)?n.value:r<=0||t>e||e-t>31536e6?n.num:365*r/(360-r*o.DAYS360(t,e,!1))},e.TBILLPRICE=function(t,e,r){return t=i.parseDate(t),e=i.parseDate(e),r=i.parseNumber(r),i.anyIsError(t,e,r)?n.value:r<=0||t>e||e-t>31536e6?n.num:100*(1-r*o.DAYS360(t,e,!1)/360)},e.TBILLYIELD=function(t,e,r){return t=i.parseDate(t),e=i.parseDate(e),r=i.parseNumber(r),i.anyIsError(t,e,r)?n.value:r<=0||t>e||e-t>31536e6?n.num:360*(100-r)/(r*o.DAYS360(t,e,!1))},e.VDB=function(){throw new Error("VDB is not implemented")},e.XNPV=function(t,e,r){if(t=i.parseNumber(t),e=i.parseNumberArray(i.flatten(e)),r=i.parseDateArray(i.flatten(r)),i.anyIsError(t,e,r))return n.value;for(var a=0,u=0;u<e.length;u++)a+=e[u]/Math.pow(1+t,o.DAYS(r[u],r[0])/365);return a},e.YIELD=function(){throw new Error("YIELD is not implemented")},e.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},e.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(t,e,r){var n=r(0),o=r(1);e.MATCH=function(t,e,r){if(!t&&!e)return n.na;if(2===arguments.length&&(r=1),!(e instanceof Array))return n.na;if(-1!==r&&0!==r&&1!==r)return n.na;for(var o,i,a=0;a<e.length;a++)if(1===r){if(e[a]===t)return a+1;e[a]<t&&(i?e[a]>i&&(o=a+1,i=e[a]):(o=a+1,i=e[a]))}else if(0===r){if("string"==typeof t){if(t=t.replace(/\?/g,"."),e[a].toLowerCase().match(t.toLowerCase()))return a+1}else if(e[a]===t)return a+1}else if(-1===r){if(e[a]===t)return a+1;e[a]>t&&(i?e[a]<i&&(o=a+1,i=e[a]):(o=a+1,i=e[a]))}return o||n.na},e.VLOOKUP=function(t,e,r,o){if(!t||!e||!r)return n.na;o=o||!1;for(var i=0;i<e.length;i++){var a=e[i];if(!o&&a[0]===t||a[0]===t||o&&"string"==typeof a[0]&&-1!==a[0].toLowerCase().indexOf(t.toLowerCase()))return r<a.length+1?a[r-1]:n.ref}return n.na},e.HLOOKUP=function(t,e,r,i){if(!t||!e||!r)return n.na;i=i||!1;for(var a=o.transpose(e),u=0;u<a.length;u++){var l=a[u];if(!i&&l[0]===t||l[0]===t||i&&"string"==typeof l[0]&&-1!==l[0].toLowerCase().indexOf(t.toLowerCase()))return r<l.length+1?l[r-1]:n.ref}return n.na}},function(t,e,r){},function(t,e,r){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,l(n.key),n)}}function l(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}r.r(e),r.d(e,"spreadsheet",(function(){return ey}));var c=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";a(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=r):this.el=e,this.data={}}return e=t,(r=[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var r=o(t.split(".")),n=r[0],i=r.slice(1),a=n;return"mousewheel"===a&&/Firefox/i.test(window.navigator.userAgent)&&(a="DOMMouseScroll"),this.el.addEventListener(a,(function(t){e(t);for(var r=0;r<i.length;r+=1){var n=i[r];if("left"===n&&0!==t.button)return;if("right"===n&&2!==t.button)return;"stop"===n&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(r){e.css(r,"".concat(t[r],"px"))})),this;var r=this.el;return{top:r.offsetTop,left:r.offsetLeft,height:r.offsetHeight,width:r.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return 0===arguments.length?this.el.childNodes:(r.forEach((function(e){return t.child(e)})),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var r=e;return"string"==typeof e?r=document.createTextNode(e):e instanceof t&&(r=e.el),this.el.appendChild(r),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var r=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){r.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var r=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){r.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}])&&u(e.prototype,r),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}(),s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new c(t,e)};r(9);function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var p=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function y(t){for(var e="",r=t;r>=p.length;)r/=p.length,r-=1,e+=p[parseInt(r,10)%p.length];return e+=p[t%p.length]}function v(t){for(var e=0,r=0;r!==t.length;++r)e=26*e+t.charCodeAt(r)-64;return e-1}function b(t){for(var e="",r="",n=0;n<t.length;n+=1)t.charAt(n)>="0"&&t.charAt(n)<="9"?r+=t.charAt(n):e+=t.charAt(n);return[v(e),parseInt(r,10)-1]}function m(t,e){return"".concat(y(t)).concat(e+1)}function d(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0};if(0===e&&0===r)return t;var o=b(t),i=f(o,2),a=i[0],u=i[1];return n(a,u)?m(a+e,u+r):t}function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return E(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?E(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,N(n.key),n)}}function N(t){var e=function(t,e){if("object"!=g(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==g(e)?e:e+""}var I=function(){function t(e,r,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;S(this,t),this.sri=e,this.sci=r,this.eri=n,this.eci=o,this.w=i,this.h=a}return e=t,n=[{key:"valueOf",value:function(e){var r=e.split(":"),n=w(b(r[0]),2),o=n[0],i=n[1],a=i,u=o;if(r.length>1){var l=w(b(r[1]),2);u=l[0],a=l[1]}return new t(i,o,a,u)}}],(r=[{key:"set",value:function(t,e,r,n){this.sri=t,this.sci=e,this.eri=r,this.eci=n}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];if(1===n.length){var i=b(n[0]),a=w(i,2);e=a[0],t=a[1]}else 2===n.length&&(t=n[0],e=n[1]);var u=this.sri,l=this.sci,c=this.eri,s=this.eci;return u<=t&&t<=c&&l<=e&&e<=s}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=this.sri,n=this.sci,o=this.eri,i=this.eci,a=r;a<=o;a+=1)if(e(a))for(var u=n;u<=i;u+=1)t(a,u)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var r=this.sri,n=this.sci,o=this.eri,i=this.eci;return new t(e.sri<r?e.sri:r,e.sci<n?e.sci:n,e.eri>o?e.eri:o,e.eci>i?e.eci:i)}},{key:"difference",value:function(e){var r=[],n=function(e,n,o,i){r.push(new t(e,n,o,i))},o=this.sri,i=this.sci,a=this.eri,u=this.eci,l=e.sri-o,c=e.sci-i,s=a-e.eri,f=u-e.eci;return l>0?(n(o,i,e.sri-1,u),s>0?(n(e.eri+1,i,a,u),c>0&&n(e.sri,i,e.eri,e.sci-1),f>0&&n(e.sri,e.eci+1,e.eri,u)):(c>0&&n(e.sri,i,a,e.sci-1),f>0&&n(e.sri,e.eci+1,a,u))):s>0&&(n(e.eri+1,i,a,u),c>0&&n(o,i,e.eri,e.sci-1),f>0&&n(o,e.eci+1,e.eri,u)),c>0?(n(o,i,a,e.sci-1),f>0?(n(o,e.eri+1,a,u),l>0&&n(o,e.sci,e.sri-1,e.eci),s>0&&n(e.sri+1,e.sci,a,e.eci)):(l>0&&n(o,e.sci,e.sri-1,u),s>0&&n(e.sri+1,e.sci,a,u))):f>0&&(n(a,e.eci+1,a,u),l>0&&n(o,i,e.sri-1,e.eci),s>0&&n(e.eri+1,i,a,e.eci)),r}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,r=this.eri,n=this.eci,o=m(e,t);return this.multiple()&&(o="".concat(o,":").concat(m(n,r))),o}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}])&&O(e.prototype,r),n&&O(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}();function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function T(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,P(n.key),n)}}function P(t){var e=function(t,e){if("object"!=A(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==A(e)?e:e+""}var M=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new I(0,0,0,0),this.ri=0,this.ci=0},(e=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&T(t.prototype,e),r&&T(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,C(n.key),n)}}function j(t,e,r){return e&&R(t.prototype,e),r&&R(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function C(t){var e=function(t,e){if("object"!=k(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==k(e)?e:e+""}var x=j((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0}));function D(t){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,L(n.key),n)}}function L(t){var e=function(t,e){if("object"!=D(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==D(e)?e:e+""}var U=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.undoItems=[],this.redoItems=[]},(e=[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var r=this.undoItems,n=this.redoItems;this.canUndo()&&(n.push(JSON.stringify(t)),e(JSON.parse(r.pop())))}},{key:"redo",value:function(t,e){var r=this.undoItems,n=this.redoItems;this.canRedo()&&(r.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}}])&&_(t.prototype,e),r&&_(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B(n.key),n)}}function B(t){var e=function(t,e){if("object"!=F(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==F(e)?e:e+""}var H=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear"},(e=[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&V(t.prototype,e),r&&V(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function G(t){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,X(n.key),n)}}function z(t,e,r){return e&&Y(t.prototype,e),r&&Y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function X(t){var e=function(t,e){if("object"!=G(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==G(e)?e:e+""}var W=function(){return z((function t(e,r,n){q(this,t),this.ci=e,this.operator=r,this.value=n}),[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,r=this.value;return"all"===e||"in"===e&&r.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}])}(),$=function(){return z((function t(e,r){q(this,t),this.ci=e,this.order=r}),[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}])}(),K=function(){return z((function t(){q(this,t),this.ref=null,this.filters=[],this.sort=null}),[{key:"setData",value:function(t){var e=t.ref,r=t.filters,n=t.sort;null!=e&&(this.ref=e,this.filters=r.map((function(t){return new W(t.ci,t.operator,t.value)})),n&&(this.sort=new $(n.ci,n.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,r=this.sort;return{ref:t,filters:e.map((function(t){return t.getData()})),sort:r}}return{}}},{key:"addFilter",value:function(t,e,r){var n=this.getFilter(t);null==n?this.filters.push(new W(t,e,r)):n.set(e,r)}},{key:"setSort",value:function(t,e){this.sort=e?new $(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,r=0;r<e.length;r+=1)if(e[r].ci===t)return e[r];return null}},{key:"filteredRows",value:function(t){var e=new Set,r=new Set;if(this.active())for(var n=this.range(),o=n.sri,i=n.eri,a=this.filters,u=o+1;u<=i;u+=1)for(var l=0;l<a.length;l+=1){var c=a[l],s=t(u,c.ci),f=s?s.text:"";if(!c.includes(f)){e.add(u);break}r.add(u)}return{rset:e,fset:r}}},{key:"items",value:function(t,e){var r={};if(this.active())for(var n=this.range(),o=n.sri,i=n.eri,a=o+1;a<=i;a+=1){var u=e(a,t);if(null===u||/^\s*$/.test(u.text))r[""]=(r[""]||0)+1;else{var l=u.text,c=(r[l]||0)+1;r[l]=c}}return r}},{key:"range",value:function(){return I.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}])}();function Q(t){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function J(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tt(n.key),n)}}function tt(t){var e=function(t,e){if("object"!=Q(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Q(e)?e:e+""}var et=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Z(this,t),this._=e}return e=t,(r=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter((function(e){return!e.within(t)}))}},{key:"getFirstIncludes",value:function(t,e){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(t,e))return n}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter((function(t){return t.intersects(e)})))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}},{key:"union",value:function(t){var e=t;return this._.forEach((function(t){t.intersects(e)&&(e=t.union(e))})),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,r,n){this._.forEach((function(o){var i=o.sri,a=o.sci,u=o.eri,l=o.eci,c=o;"row"===t?i>=e?(c.sri+=r,c.eri+=r):i<e&&e<=u&&(c.eri+=r,n(i,a,r,0)):"column"===t&&(a>=e?(c.sci+=r,c.eci+=r):a<e&&e<=l&&(c.eci+=r,n(i,a,0,r)))}))}},{key:"move",value:function(t,e,r){this._.forEach((function(n){var o=n;o.within(t)&&(o.eri+=e,o.sri+=e,o.sci+=r,o.eci+=r)}))}},{key:"setData",value:function(t){return this._=t.map((function(t){return I.valueOf(t)})),this}},{key:"getData",value:function(){return this._.map((function(t){return t.toString()}))}}])&&J(e.prototype,r),n&&J(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}();var rt=function t(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return n.forEach((function(r){Object.keys(r).forEach((function(n){var o=r[n];"string"==typeof o||"number"==typeof o||"boolean"==typeof o?e[n]=o:"function"!=typeof o&&!Array.isArray(o)&&o instanceof Object?(e[n]=e[n]||{},t(e[n],o)):e[n]=o}))})),e};function nt(t){for(var e="".concat(t),r=0,n=!1,o=0;o<e.length;o+=1)!0===n&&(r+=1),"."===e.charAt(o)&&(n=!0);return r}function ot(t,e,r){if(Number.isNaN(e)||Number.isNaN(r))return e+t+r;var n=nt(e),o=nt(r),i=Number(e),a=Number(r),u=0;if("-"===t)u=i-a;else if("+"===t)u=i+a;else if("*"===t)u=i*a;else{if("/"===t)return nt(u=i/a)>5?u.toFixed(2):u;if("^"===t)return Math.pow(i,a)}return u.toFixed(Math.max(n,o))}var it={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return rt.apply(void 0,[{}].concat(e))},equals:function t(e,r){var n=Object.keys(e);if(n.length!==Object.keys(r).length)return!1;for(var o=0;o<n.length;o+=1){var i=n[o],a=e[i],u=r[i];if(void 0===u)return!1;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a){if(a!==u)return!1}else if(Array.isArray(a)){if(a.length!==u.length)return!1;for(var l=0;l<a.length;l+=1)if(!t(a[l],u[l]))return!1}else if("function"!=typeof a&&!Array.isArray(a)&&a instanceof Object&&!t(a,u))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r+=1)if(t[r]!==e[r])return!1;return!0},sum:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},r=0,n=0;return Object.keys(t).forEach((function(o){r+=e(t[o],o),n+=1})),[r,n]},rangeEach:function(t,e,r){for(var n=t;n<e;n+=1)r(n)},rangeSum:function(t,e,r){for(var n=0,o=t;o<e;o+=1)n+=r(o);return n},rangeReduceIf:function(t,e,r,n,o,i){for(var a=r,u=n,l=t;l<e&&!(a>o);l+=1)a+=u=i(l);return[l,a-u,u]},deleteProperty:function(t,e){var r=t["".concat(e)];return delete t["".concat(e)],r},numberCalc:ot};function at(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ut(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ut(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function lt(t){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ct(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function st(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ct(Object(r),!0).forEach((function(e){ft(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ft(t,e,r){return(e=yt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ht(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yt(n.key),n)}}function yt(t){var e=function(t,e){if("object"!=lt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==lt(e)?e:e+""}var vt=function(){return t=function t(e){var r=e.len,n=e.height,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ht(this,t),this.options=o,this._={},this.len=r,this.height=n},(e=[{key:"getHeight",value:function(t){if(this.isHide(t))return 0;var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var r=this.getOrNew(t);!0===e?r.hide=!0:delete r.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,r){var n=this;return it.rangeSum(t,e,(function(t){return r&&r.has(t)?0:n.getHeight(t)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var r=this.get(t);return void 0!==r&&void 0!==r.cells&&void 0!==r.cells[e]?r.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var r=this.getCell(t,e);return r&&r.merge?r.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var r=this.getOrNew(t);return r.cells[e]=r.cells[e]||{},r.cells[e]}},{key:"setCell",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",o=this.getOrNew(t);"all"===n?o.cells[e]=r:"text"===n?(o.cells[e]=o.cells[e]||{},o.cells[e].text=r.text):"format"===n&&(o.cells[e]=o.cells[e]||{},o.cells[e].style=r.style,r.merge&&(o.cells[e].merge=r.merge))}},{key:"setCellText",value:function(t,e,r){var n=this.getCellOrNew(t,e);if(!1!==n.editable){var o=this.options.valueSetter;if(o){var i,a,u,l,c=o(st(st({},this),{},{text:r,cell:n}));if(c&&"object"===lt(c)&&!Array.isArray(c))u=c.retrievedText,l=c.formattedText;else if(Array.isArray(c)){var s=at(c,2);u=s[0],l=s[1]}else u=c,l="";console.log(u,l,"console"),n.text=null!==(i=u)&&void 0!==i?i:"",n.formattedText=null!==(a=l)&&void 0!==a?a:""}else n.text=r}}},{key:"copyPaste",value:function(t,e,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},a=t.sri,u=t.sci,l=t.eri,c=t.eci,s=e.sri,f=e.sci,h=e.eri,p=e.eci,y=t.size(),v=at(y,2),b=v[0],m=v[1],g=e.size(),w=at(g,2),E=w[0],S=w[1],O=!0,N=0;(h<a||p<u)&&(O=!1,N=h<a?E:S);for(var I=a;I<=l;I+=1)if(this._[I])for(var A=u;A<=c;A+=1)if(this._[I].cells&&this._[I].cells[A])for(var T=s;T<=h;T+=b)for(var P=function(){var t=T+(I-a),e=M+(A-u),y=it.cloneDeep(n._[I].cells[A]);if(o&&y&&y.text&&y.text.length>0){var v=y.text,g=M-f+(T-s)+2;if(O||(g-=N+1),"="===v[0])y.text=v.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){var e=0,r=0;return a===s?e=g-1:r=g-1,/^\d+$/.test(t)?t:d(t,e,r)}));else if(b<=1&&m>1&&(s>l||h<a)||m<=1&&b>1&&(f>c||p<u)||b<=1&&m<=1){var w=/[\\.\d]+$/.exec(v);if(null!==w){var E=Number(w[0])+g-1;y.text=v.substring(0,w.index)+E}}}n.setCell(t,e,y,r),i(t,e,y)},M=f;M<=p;M+=m)P()}},{key:"cutPaste",value:function(t,e){var r=this,n={};this.each((function(o){r.eachCells(o,(function(i){var a=parseInt(o,10),u=parseInt(i,10);t.includes(o,i)&&(a=e.sri+(a-t.sri),u=e.sci+(u-t.sci)),n[a]=n[a]||{cells:{}},n[a].cells[u]=r._[o].cells[i]}))})),this._=n}},{key:"paste",value:function(t,e){var r=this;if(!(t.length<=0)){var n=e.sri,o=e.sci;t.forEach((function(t,e){var i=n+e;t.forEach((function(t,e){var n=o+e;r.setCellText(i,n,t)}))}))}}},{key:"insert",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n={};this.each((function(o,i){var a=parseInt(o,10);a>=t&&(a+=r,e.eachCells(o,(function(e,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return d(e,0,r,(function(e,r){return r>=t}))})))}))),n[a]=i})),this._=n,this.len+=r}},{key:"delete",value:function(t,e){var r=this,n=e-t+1,o={};this.each((function(i,a){var u=parseInt(i,10);u<t?o[u]=a:i>e&&(o[u-n]=a,r.eachCells(i,(function(t,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return d(t,0,-n,(function(t,r){return r>e}))})))})))})),this._=o,this.len-=n}},{key:"insertColumn",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each((function(n,o){var i={};e.eachCells(n,(function(e,n){var o=parseInt(e,10);o>=t&&(o+=r,n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return d(e,r,0,(function(e){return e>=t}))})))),i[o]=n})),o.cells=i}))}},{key:"deleteColumn",value:function(t,e){var r=this,n=e-t+1;this.each((function(o,i){var a={};r.eachCells(o,(function(r,o){var i=parseInt(r,10);i<t?a[i]=o:i>e&&(a[i-n]=o,o.text&&"="===o.text[0]&&(o.text=o.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return d(t,-n,0,(function(t){return t>e}))}))))})),i.cells=a}))}},{key:"deleteCells",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each((function(t,n){e.deleteCell(t,n,r)}))}},{key:"deleteCell",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",n=this.get(t);if(null!==n){var o=this.getCell(t,e);null!==o&&!1!==o.editable&&("all"===r?delete n.cells[e]:"text"===r?(o.text&&delete o.text,o.value&&delete o.value):"format"===r?(void 0!==o.style&&delete o.style,o.merge&&delete o.merge):"merge"===r&&o.merge&&delete o.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],r=this._[e];if(r){var n=r.cells,o=Object.keys(n),i=o[o.length-1];return[parseInt(e,10),parseInt(i,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach((function(e){var r=at(e,2),n=r[0],o=r[1];t(n,o)}))}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach((function(t){var r=at(t,2),n=r[0],o=r[1];e(n,o)}))}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}])&&pt(t.prototype,e),r&&pt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function bt(t){return(bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dt(n.key),n)}}function dt(t){var e=function(t,e){if("object"!=bt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=bt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==bt(e)?e:e+""}var gt=function(){return t=function t(e){var r=e.len,n=e.width,o=e.indexWidth,i=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=r,this.width=n,this.indexWidth=o,this.minWidth=i},(e=[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var r=this.getOrNew(t);!0===e?r.hide=!0:delete r.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var r=this;return it.rangeSum(t,e,(function(t){return r.getWidth(t)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&mt(t.prototype,e),r&&mt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function wt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Et(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Et(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function Et(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var St=["en"],Ot={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More",grid:"Grid"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function Nt(t,e){if(e){var r,n=wt(St);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(!e[o])break;for(var i=e[o],a=t.match(/(?:\\.|[^.])+/g),u=0;u<a.length;u+=1){var l=i[a[u]];if(!l)break;if(u===a.length-1)return l;i=l}}}catch(t){n.e(t)}finally{n.f()}}}function It(t){var e=Nt(t,Ot);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=Nt(t,window.x_spreadsheet.$messages)),e||""}function At(t){return function(){return It(t)}}function Tt(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r?St=[t]:St.unshift(t),e&&(Ot[t]=e)}function Pt(t){return(Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return kt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?kt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Rt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jt(n.key),n)}}function jt(t){var e=function(t,e){if("object"!=Pt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Pt(e)?e:e+""}var Ct={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function xt(t,e){var r="";if(!t){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];r=It.apply(void 0,["validation.".concat(e)].concat(o))}return[t,r]}var Dt=function(){return t=function t(e,r,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.required=r,this.value=n,this.type=e,this.operator=o,this.message=""},(e=[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?it.arrayEquals(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,r=this.operator,n=this.value,o=this.type;if(e&&/^\s*$/.test(t))return xt(!1,"required");if(/^\s*$/.test(t))return[!0];if(Ct[o]&&!Ct[o].test(t))return xt(!1,"notMatch");if("list"===o)return xt(this.values().includes(t),"notIn");if(r){var i=this.parseValue(t);if("be"===r){var a=Mt(n,2),u=a[0],l=a[1];return xt(i>=this.parseValue(u)&&i<=this.parseValue(l),"between",u,l)}if("nbe"===r){var c=Mt(n,2),s=c[0],f=c[1];return xt(i<this.parseValue(s)||i>this.parseValue(f),"notBetween",s,f)}if("eq"===r)return xt(i===this.parseValue(n),"equal",n);if("neq"===r)return xt(i!==this.parseValue(n),"notEqual",n);if("lt"===r)return xt(i<this.parseValue(n),"lessThan",n);if("lte"===r)return xt(i<=this.parseValue(n),"lessThanEqual",n);if("gt"===r)return xt(i>this.parseValue(n),"greaterThan",n);if("gte"===r)return xt(i>=this.parseValue(n),"greaterThanEqual",n)}return[!0]}}])&&Rt(t.prototype,e),r&&Rt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function _t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Lt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ut(t){return(Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ht(n.key),n)}}function Bt(t,e,r){return e&&Vt(t.prototype,e),r&&Vt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ht(t){var e=function(t,e){if("object"!=Ut(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ut(e)?e:e+""}var Gt=function(){function t(e,r,n){Ft(this,t),this.refs=r,this.mode=e,this.validator=n}return Bt(t,[{key:"includes",value:function(t,e){for(var r=this.refs,n=0;n<r.length;n+=1){if(I.valueOf(r[n]).includes(t,e))return!0}return!1}},{key:"addRef",value:function(t){this.remove(I.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach((function(r){var n=I.valueOf(r);n.intersects(t)?n.difference(t).forEach((function(t){return e.push(t.toString())})):e.push(r)})),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,r=this.validator;return{refs:t,mode:e,type:r.type,required:r.required,operator:r.operator,value:r.value}}}],[{key:"valueOf",value:function(e){var r=e.refs,n=e.mode,o=e.type,i=e.required,a=e.operator,u=e.value;return new t(n,r,new Dt(o,i,u,a))}}])}(),qt=function(){return Bt((function t(){Ft(this,t),this._=[],this.errors=new Map}),[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,r){var n=this.get(t,e),o="".concat(t,"_").concat(e),i=this.errors;if(null!==n){var a=_t(n.validator.validate(r),2),u=a[0],l=a[1];u?i.delete(o):i.set(o,l)}else i.delete(o);return!0}},{key:"add",value:function(t,e,r){var n=r.type,o=r.required,i=r.value,a=r.operator,u=new Dt(n,o,i,a),l=this.getByValidator(u);null!==l?l.addRef(e):this._.push(new Gt(t,[e],u))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var r=this._[e];if(r.validator.equals(t))return r}return null}},{key:"get",value:function(t,e){for(var r=0;r<this._.length;r+=1){var n=this._[r];if(n.includes(t,e))return n}return null}},{key:"remove",value:function(t){this.each((function(e){e.remove(t)}))}},{key:"each",value:function(t){this._.forEach((function(e){return t(e)}))}},{key:"getData",value:function(){return this._.filter((function(t){return t.refs.length>0})).map((function(t){return t.getData()}))}},{key:"setData",value:function(t){this._=t.map((function(t){return Gt.valueOf(t)}))}}])}();function Yt(t){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Xt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?zt(Object(r),!0).forEach((function(e){Wt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Wt(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=Yt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Yt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Yt(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Kt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var Qt=function(t){var e={"border-top":{},"border-right":{},"border-bottom":{},"border-left":{}},r={},n={};for(var o in t)if(t.hasOwnProperty(o)){var i=o.split("-");if(3===i.length&&"border"===i[0]&&["style","width","color"].includes(i[2])){var a="border-"+i[1];e[a]||(e[a]={}),e[a][i[2]]=t[o]}else if(2===i.length&&"border"===i[0]&&["style","width","color"].includes(i[1])){var u,l,c=[];if("color"===i[1]&&null!==(u=t[o])&&void 0!==u&&u.includes("rgb"))(c=t[o].replaceAll(" ","").split(")")).pop(),c=c.map((function(t){return"".concat(t,")")}));else c=null===(l=t[o])||void 0===l?void 0:l.split(" ");1===c.length?(e["border-top"][i[1]]=c[0],e["border-bottom"][i[1]]=c[0],e["border-left"][i[1]]=c[0],e["border-right"][i[1]]=c[0]):2===c.length?(e["border-top"][i[1]]=c[0],e["border-bottom"][i[1]]=c[0],e["border-left"][i[1]]=c[1],e["border-right"][i[1]]=c[1]):3===c.length?(e["border-top"][i[1]]=c[0],e["border-right"][i[1]]=c[1],e["border-left"][i[1]]=c[1],e["border-bottom"][i[1]]=c[2]):4===c.length&&(e["border-top"][i[1]]=c[0],e["border-right"][i[1]]=c[1],e["border-bottom"][i[1]]=c[2],e["border-left"][i[1]]=c[3])}else r[o]=t[o]}return Object.keys(e).forEach((function(t){var r=e[t];if(3===Object.keys(r).length){var o="0px"===r.width?"none":"".concat(r.width," ").concat(r.style," ").concat(r.color);n[t]=o}})),Xt(Xt({},n),r)};function Zt(t){return(Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,te(n.key),n)}}function te(t){var e=function(t,e){if("object"!=Zt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Zt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Zt(e)?e:e+""}var ee=function(){return t=function t(e,r){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e,this.settings=r,this.gridLine=null===(n=r.showGrid)||void 0===n||n},(e=[{key:"setData",value:function(t){this.gridLine=t.gridLine}},{key:"getData",value:function(t){return this}},{key:"setGrid",value:function(t){this.gridLine=t}},{key:"getGrid",value:function(){return this.gridLine}}])&&Jt(t.prototype,e),r&&Jt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function re(t){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ne(t){return function(t){if(Array.isArray(t))return le(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ue(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ie(n.key),n)}}function ie(t){var e=function(t,e){if("object"!=re(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=re(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==re(e)?e:e+""}function ae(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||ue(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(t,e){if(t){if("string"==typeof t)return le(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?le(t,e):void 0}}function le(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var ce={mode:"edit",view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}};function se(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=this.merges,o=e.clone(),i=t.size(),a=ae(i,2),u=a[0],l=a[1],c=e.size(),s=ae(c,2),f=s[0],h=s[1];return u>f&&(o.eri=e.sri+u-1),l>h&&(o.eci=e.sci+l-1),!n.intersects(o)||(r(It("error.pasteForMergedCell")),!1)}function fe(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.rows,i=this.merges;"all"!==r&&"format"!==r||(o.deleteCells(e,r),i.deleteWithin(e)),o.copyPaste(t,e,r,n,(function(t,e,r){if(r&&r.merge){var n=ae(r.merge,2),o=n[0],a=n[1];if(o<=0&&a<=0)return;i.add(new I(t,e,t+o,e+a))}}))}function he(t,e){var r=this.clipboard,n=this.rows,o=this.merges;n.cutPaste(t,e),o.move(t,e.sri-t.sri,e.sci-t.sci),r.clear()}function pe(t,e,r){var n=this.styles,o=this.rows.getCellOrNew(t,e),i={};void 0!==o.style&&(i=it.cloneDeep(n[o.style])),i=it.merge(i,{border:r}),o.style=this.addStyle(i)}function ye(t){var e=this,r=t.mode,n=t.style,o=t.color,i=this.styles,a=this.selector,u=this.rows,l=a.range,c=l.sri,s=l.sci,f=l.eri,h=l.eci,p=!this.isSingleSelected();if(p||"inside"!==r&&"horizontal"!==r&&"vertical"!==r)if("outside"!==r||p){if("none"===r)a.range.each((function(t,r){var n=u.getCell(t,r);if(n&&void 0!==n.style){var o=it.cloneDeep(i[n.style]);delete o.border,n.style=e.addStyle(o)}}));else if("all"===r||"inside"===r||"outside"===r||"horizontal"===r||"vertical"===r)for(var y=[],v=c;v<=f;v+=1)for(var b=s;b<=h;b+=1){for(var m=[],d=0;d<y.length;d+=1){var g=ae(y[d],4),w=g[0],E=g[1],S=g[2],O=g[3];if(v===w+S+1&&m.push(d),w<=v&&v<=w+S&&b===E){b+=O+1;break}}if(m.forEach((function(t){return y.splice(t,1)})),b>h)break;var N=u.getCell(v,b),I=0,A=0;if(N&&N.merge){var T=ae(N.merge,2);I=T[0],A=T[1],y.push([v,b,I,A])}var P=I>0&&v+I===f,M=A>0&&b+A===h,k={};"all"===r?k={bottom:[n,o],top:[n,o],left:[n,o],right:[n,o]}:"inside"===r?(!M&&b<h&&(k.right=[n,o]),!P&&v<f&&(k.bottom=[n,o])):"horizontal"===r?!P&&v<f&&(k.bottom=[n,o]):"vertical"===r?!M&&b<h&&(k.right=[n,o]):"outside"===r&&p&&(c===v&&(k.top=[n,o]),(P||f===v)&&(k.bottom=[n,o]),s===b&&(k.left=[n,o]),(M||h===b)&&(k.right=[n,o])),Object.keys(k).length>0&&pe.call(this,v,b,k),b+=A}else if("top"===r||"bottom"===r)for(var R=s;R<=h;R+=1)"top"===r&&(pe.call(this,c,R,{top:[n,o]}),R+=u.getCellMerge(c,R)[1]),"bottom"===r&&(pe.call(this,f,R,{bottom:[n,o]}),R+=u.getCellMerge(f,R)[1]);else if("left"===r||"right"===r)for(var j=c;j<=f;j+=1)"left"===r&&(pe.call(this,j,s,{left:[n,o]}),j+=u.getCellMerge(j,s)[0]),"right"===r&&(pe.call(this,j,h,{right:[n,o]}),j+=u.getCellMerge(j,h)[0])}else pe.call(this,c,s,{top:[n,o],bottom:[n,o],left:[n,o],right:[n,o]})}function ve(t,e){var r=this.rows,n=this.freezeTotalHeight(),o=r.height;n+r.height<t&&(o-=e);for(var i=this.exceptRowSet,a=0,u=o,l=r.height;a<r.len&&!(u>t);a+=1)i.has(a)||(u+=l=r.getHeight(a));return(u-=l)<=0?{ri:-1,top:0,height:l}:{ri:a-1,top:u,height:l}}function be(t,e){var r=this.cols,n=this.freezeTotalWidth(),o=r.indexWidth;n+r.indexWidth<t&&(o-=e);var i=ae(it.rangeReduceIf(0,r.len,o,r.indexWidth,t,(function(t){return r.getWidth(t)})),3),a=i[0],u=i[1],l=i[2];return u<=0?{ci:-1,left:0,width:r.indexWidth}:{ci:a-1,left:u,width:l}}var me=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=it.merge(ce,r||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new et,this.rows=new vt(this.settings.row,this.settings),this.cols=new gt(this.settings.col),this.sheetConfig=new ee(this.name,this.settings),this.validations=new qt,this.hyperlinks={},this.comments={},this.selector=new M,this.scroll=new x,this.history=new U,this.clipboard=new H,this.autoFilter=new K,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map},(e=[{key:"addValidation",value:function(t,e,r){var n=this;this.changeData((function(){n.validations.add(t,e,r)}))}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData((function(){t.validations.remove(e)}))}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,r=t.ci,n=this.validations.get(e,r);return n?n.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,r=t.ci,n=t.range,o=this.validations.get(e,r),i={ref:n.toString()};return null!==o&&(i.mode=o.mode,i.validator=o.validator),i}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),(function(e){t.setData(e)}))}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),(function(e){t.setData(e)}))}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"copyToSystemClipboard",value:function(t){for(var e=[],r=this.selector.range,n=r.sri,o=r.eri,i=r.sci,a=r.eci,u=n;u<=o;u+=1){for(var l=[],c=i;c<=a;c+=1){var s=this.getCell(u,c);l.push(s&&s.text||"")}e.push(l)}e=e.map((function(t){return t.join("\t")})).join("\n"),t&&(t.clipboardData.clearData(),t.clipboardData.setData("text/plain",e),t.preventDefault()),navigator.clipboard&&navigator.clipboard.writeText(e).then((function(){}),(function(t){console.log("text copy to the system clipboard error  ",e,t)}))}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.clipboard,o=this.selector;return!n.isClear()&&!!se.call(this,n.range,o.range,r)&&(this.changeData((function(){n.isCopy()?fe.call(t,n.range,o.range,e):n.isCut()&&he.call(t,n.range,o.range)})),!0)}},{key:"pasteFromSystemClipboard",value:function(t,e,r){var n,o=this,i=this.selector,a=null==t||null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text/html");navigator.clipboard.read().then((function(t){t.forEach((function(t){var n,u;if(null!=t&&null!==(n=t.types)&&void 0!==n&&n.includes("text/html")){var l,c,s=(new DOMParser).parseFromString(a,"text/html"),f=null==s||null===(l=s.getElementsByTagName("style"))||void 0===l?void 0:l[0],h=null==s||null===(c=s.getElementsByTagName("body"))||void 0===c?void 0:c[0],p=null==h?void 0:h.querySelectorAll("table");null==p||p.forEach((function(t){var e=null==t?void 0:t.querySelector("tbody"),r=null==e?void 0:e.querySelectorAll("tr"),n=i.ri;null==r||r.forEach((function(t){var e=i.ci,r=null==t?void 0:t.querySelectorAll("td");null==r||r.forEach((function(t){var r,i=null!==(r=null==t?void 0:t.innerText)&&void 0!==r?r:"",a=null==t?void 0:t.getAttribute("class"),u=function(t){if(t){var e={},r={},n={},o=t.split(";"),i={};o.forEach((function(t){var e=$t(t.split(":"),2),r=e[0],n=e[1];r&&n&&(i[r.trim()]=n.trim())}));var a=Qt(i);return Object.entries(a).forEach((function(t){var o,i,a,u=$t(t,2),l=u[0],c=u[1];switch(l){case"background":case"background-color":e.bgcolor=c;break;case"color":e.color=c;break;case"text-decoration":"underline"===c?e.underline=!0:"line-through"===c&&(e.strike=!0);break;case"text-align":e.align=c;break;case"vertical-align":e.valign=c;break;case"font-weight":var s=parseInt(c);r.bold=NaN!==s&&s>400||"bold"===c;break;case"font-size":r.size=null!==(o=null===(i=c.split("px"))||void 0===i?void 0:i[0])&&void 0!==o?o:"";break;case"font-style":r.italic="italic"===c;break;case"font-family":r.name=c;break;case"border":case"border-top":case"border-bottom":case"border-left":case"border-right":var f=null!==(a=String(c).match(/[^\s\(]+(\(.+\))?/g))&&void 0!==a?a:[],h=[];if(f.length>2){var p,y=Number(null===(p=f[0])||void 0===p||null===(p=p.split("px"))||void 0===p?void 0:p[0]);h=["solid"===f[1]?y<=1?"thin":y<=2?"medium":"thick":f[1],["black","initial"].includes(f[2])?"#000000":f[2]]}if("border"===l)n={top:h,bottom:h,left:h,right:h};else{var v=l.split("-")[1];n[v]=h}}})),e.font=r,Object.keys(n).length&&(e.border=n),e}return{}}(function(t,e){for(var r,n,o=(null==t||null===(r=t.sheet)||void 0===r?void 0:r.cssRules)||(null==t||null===(n=t.sheet)||void 0===n?void 0:n.rules),i=0;i<(null==o?void 0:o.length);i++){var a=o[i];if(a.selectorText===".".concat(e))return a.style.cssText}return""}(f,a));o.setCellText(n,e,i,"input");var l=o.getCell(n,e);l&&(l.style=o.addStyle(u)),e+=1})),n+=1}))})),e(),r(o.rows.getData())}else null!=t&&null!==(u=t.types)&&void 0!==u&&u.includes("text/plain")&&navigator.clipboard.readText().then((function(t){var n=o.parseClipboardContent(t),a=i.ri;n.forEach((function(t){var e=i.ci;t.forEach((function(t){o.setCellText(a,e,t,"input"),e+=1})),a+=1})),e(),r(o.rows.getData())}))}))})).catch((function(t){console.error("Failed to read clipboard contents: ",t)}))}},{key:"parseClipboardContent",value:function(t){var e=[],r=t.split("\n"),n=0;return r.forEach((function(t){e[n]=t.split("\t"),n+=1})),e}},{key:"pasteFromText",value:function(t){var e=[];if((e=/\r\n/.test(t)?t.split("\r\n").map((function(t){return t.replace(/"/g,"").split("\t")})):t.split("\n").map((function(t){return t.replace(/"/g,"").split("\t")}))).length){var r=this.rows,n=this.selector;this.changeData((function(){r.paste(e,n.range)}))}}},{key:"autofill",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=this.selector.range;return!!se.call(this,o,t,n)&&(this.changeData((function(){fe.call(r,o,t,e,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var r=this.selector,n=this.rows,o=this.cols,i=this.merges,a=r.range,u=a.sri,l=a.sci,c=a.eri,s=a.eci,f=r.ri,h=r.ci,p=t,y=e;return t<0&&(p=n.len-1),e<0&&(y=o.len-1),p>f?(u=f,c=p):(u=p,c=f),y>h?(l=h,s=y):(l=y,s=h),r.range=i.union(new I(u,l,c,s)),r.range=i.union(r.range),r.range}},{key:"calSelectedRangeByStart",value:function(t,e){var r=this.selector,n=this.rows,o=this.cols,i=this.merges.getFirstIncludes(t,e);return null===i&&(i=new I(t,e,t,e),-1===t&&(i.sri=0,i.eri=n.len-1),-1===e&&(i.sci=0,i.eci=o.len-1)),r.range=i,i}},{key:"setSelectedCellAttr",value:function(t,e){var r=this;this.changeData((function(){var n=r.selector,o=r.styles,i=r.rows;if("merge"===t)e?r.merge():r.unmerge();else if("border"===t)ye.call(r,e);else if("formula"===t){var a=n.ri,u=n.ci,l=n.range;if(n.multiple()){var c=ae(n.size(),2),s=c[0],f=c[1],h=l.sri,p=l.sci,y=l.eri,v=l.eci;if(s>1)for(var b=p;b<=v;b+=1)i.getCellOrNew(y+1,b).text="=".concat(e,"(").concat(m(b,h),":").concat(m(b,y),")");else f>1&&(i.getCellOrNew(a,v+1).text="=".concat(e,"(").concat(m(p,a),":").concat(m(v,a),")"))}else i.getCellOrNew(a,u).text="=".concat(e,"()")}else n.range.each((function(n,a){var u=i.getCellOrNew(n,a),l={};if(void 0!==u.style&&(l=it.cloneDeep(o[u.style])),"format"===t)l.format=e,u.style=r.addStyle(l);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var c={};c[t.split("-")[1]]=e,l.font=Object.assign(l.font||{},c),u.style=r.addStyle(l)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t?(l[t]=e,u.style=r.addStyle(l)):u[t]=e}))}))}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",r=this.autoFilter,n=this.selector,o=this.rows,i=n.ri,a=n.ci,u=i;this.unsortedRowMap.has(i)&&(u=this.unsortedRowMap.get(i));var l=o.getCell(u,a),c=l?l.text:"";if(this.setCellText(u,a,t,e),r.active()){var s=r.getFilter(a);if(s){var f=s.value.findIndex((function(t){return t===c}));f>=0&&s.value.splice(f,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,r=t.ci,n=e;return this.unsortedRowMap.has(e)&&(n=this.unsortedRowMap.get(e)),this.rows.getCell(n,r)}},{key:"xyInSelectedRect",value:function(t,e){var r=this.getSelectedRect(),n=r.left,o=r.top,i=r.width,a=r.height,u=t-this.cols.indexWidth,l=e-this.rows.height;return u>n&&u<n+i&&l>o&&l<o+a}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,r=this.rows,n=this.cols,o=this.exceptRowSet,i=t.sri,a=t.sci,u=t.eri,l=t.eci;if(i<0&&a<0)return{left:0,l:0,top:0,t:0,scroll:e};var c=n.sumWidth(0,a),s=r.sumHeight(0,i,o),f=r.sumHeight(i,u+1,o),h=n.sumWidth(a,l+1),p=c-e.x,y=s-e.y,v=this.freezeTotalHeight(),b=this.freezeTotalWidth();return b>0&&b>c&&(p=c),v>0&&v>s&&(y=s),{l:c,t:s,left:p,top:y,height:f,width:h,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var r=this.scroll,n=this.merges,o=this.rows,i=this.cols,a=ve.call(this,e,r.y),u=a.ri,l=a.top,c=a.height,s=be.call(this,t,r.x),f=s.ci,h=s.left,p=s.width;if(-1===f&&(p=i.totalWidth()),-1===u&&(c=o.totalHeight()),u>=0||f>=0){var y=n.getFirstIncludes(u,f);if(y){u=y.sri,f=y.sci;var v=this.cellRect(u,f);h=v.left,l=v.top,p=v.width,c=v.height}}return{ri:u,ci:f,left:h,top:l,width:p,height:c}}},{key:"isSingleSelected",value:function(){var t=this.selector.range,e=t.sri,r=t.sci,n=t.eri,o=t.eci,i=this.getCell(e,r);if(i&&i.merge){var a=ae(i.merge,2),u=a[0],l=a[1];if(e+u===n&&r+l===o)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,r=t.sci,n=t.eri,o=t.eci,i=this.getCell(e,r);if(i&&i.merge){var a=ae(i.merge,2),u=a[0],l=a[1];if(e+u===n&&r+l===o)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,r=this.rows;if(!this.isSingleSelected()){var n=ae(e.size(),2),o=n[0],i=n[1];if(o>1||i>1){var a=e.range,u=a.sri,l=a.sci;this.changeData((function(){var n=r.getCellOrNew(u,l);n.merge=[o-1,i-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(u,l,n)}))}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSingleSelected()){var r=e.range,n=r.sri,o=r.sci;this.changeData((function(){t.rows.deleteCell(n,o,"merge"),t.merges.deleteWithin(e.range)}))}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,r=this.selector;this.changeData((function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=r.range.toString()}))}},{key:"setAutoFilter",value:function(t,e,r,n){var o=this.autoFilter;o.addFilter(t,r,n),o.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,r=this.rows;if(e.active()){var n=e.sort,o=e.filteredRows((function(t,e){return r.getCell(t,e)})),i=o.rset,a=o.fset,u=Array.from(a),l=Array.from(a);n&&u.sort((function(t,e){return"asc"===n.order?t-e:"desc"===n.order?e-t:0})),this.exceptRowSet=i,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,u.forEach((function(e,r){t.sortedRowMap.set(l[r],e),t.unsortedRowMap.set(e,l[r])}))}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=this.selector;this.changeData((function(){t.rows.deleteCells(r.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(r.range)}))}},{key:"insert",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData((function(){var n=e.selector.range,o=n.sri,i=n.sci,a=e.rows,u=e.merges,l=e.cols,c=o;"row"===t?a.insert(o,r):"column"===t&&(a.insertColumn(i,r),c=i,l.len+=r,Object.keys(l._).reverse().forEach((function(t){var e=parseInt(t,10);e>=i&&(l._[e+r]=l._[e],delete l._[e])}))),u.shift(t,c,r,(function(t,e,r,n){var o=a.getCell(t,e);o.merge[0]+=r,o.merge[1]+=n}))}))}},{key:"delete",value:function(t){var e=this;this.changeData((function(){var r=e.rows,n=e.merges,o=e.selector,i=e.cols,a=o.range,u=o.range,l=u.sri,c=u.sci,s=u.eri,f=u.eci,h=ae(o.range.size(),2),p=h[0],y=h[1],v=l,b=p;"row"===t?r.delete(l,s):"column"===t&&(r.deleteColumn(c,f),v=a.sci,b=y,i.len-=f-c+1,Object.keys(i._).forEach((function(t){var e=parseInt(t,10);e>=c&&(e>f&&(i._[e-(f-c+1)]=i._[e]),delete i._[e])}))),n.shift(t,v,-b,(function(t,e,n,o){var i=r.getCell(t,e);i.merge[0]+=n,i.merge[1]+=o,0===i.merge[0]&&0===i.merge[1]&&delete i.merge}))}))}},{key:"scrollx",value:function(t,e){var r=this.scroll,n=this.freeze,o=this.cols,i=ae(n,2)[1],a=ae(it.rangeReduceIf(i,o.len,0,0,t,(function(t){return o.getWidth(t)})),3),u=a[0],l=a[1],c=a[2],s=l;t>0&&(s+=c),r.x!==s&&(r.ci=t>0?u:0,r.x=s,e())}},{key:"scrolly",value:function(t,e){var r=this.scroll,n=this.freeze,o=this.rows,i=ae(n,1)[0],a=ae(it.rangeReduceIf(i,o.len,0,0,t,(function(t){return o.getHeight(t)})),3),u=a[0],l=a[1],c=a[2],s=l;t>0&&(s+=c),r.y!==s&&(r.ri=t>0?u:0,r.y=s,e())}},{key:"cellRect",value:function(t,e){var r=this.rows,n=this.cols,o=n.sumWidth(0,e),i=r.sumHeight(0,t),a=r.getCell(t,e),u=n.getWidth(e),l=r.getHeight(t);if(null!==a&&a.merge){var c=ae(a.merge,2),s=c[0],f=c[1];if(s>0)for(var h=1;h<=s;h+=1)l+=r.getHeight(t+h);if(f>0)for(var p=1;p<=f;p+=1)u+=n.getWidth(e+p)}return{left:o,top:i,width:u,height:l,cell:a}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var r=this.getCell(t,e);return r&&r.text?r.text:""}},{key:"getCellStyle",value:function(t,e){var r=this.getCell(t,e);return r&&void 0!==r.style?this.styles[r.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var r=this.styles,n=this.rows.getCell(t,e),o=n&&void 0!==n.style?r[n.style]:{};return it.merge(this.defaultStyle(),o)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,r=t.ci;return this.getCellStyleOrDefault(e,r)}},{key:"setCellText",value:function(t,e,r,n){var o=this.rows,i=this.history,a=this.validations;"finished"===n?(o.setCellText(t,e,""),i.add(this.getData()),o.setCellText(t,e,r)):(o.setCellText(t,e,r),this.change(this.getData())),a.validate(t,e,r)}},{key:"freezeIsActive",value:function(){var t=ae(this.freeze,2),e=t[0],r=t[1];return e>0||r>0}},{key:"setFreeze",value:function(t,e){var r=this;this.changeData((function(){r.freeze=[t,e]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var r=this;this.changeData((function(){r.rows.setHeight(t,e)}))}},{key:"setColWidth",value:function(t,e){var r=this;this.changeData((function(){r.cols.setWidth(t,e)}))}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,r=t.showToolbar,n=t.showBottomBar,o=e.height();return n&&(o-=41),r&&(o-=41),o}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=ae(this.freeze,2),e=t[0],r=t[1];return new I(0,0,e-1,r-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,r=ae(t.maxCell(),2),n=r[0],o=r[1],i=t.sumHeight(0,n+1),a=e.sumWidth(0,o+1);return new I(0,0,n,o,a,i)}},{key:"exceptRowTotalHeight",value:function(t,e){var r=this.exceptRowSet,n=this.rows,o=Array.from(r),i=0;return o.forEach((function(r){if(r<t||r>e){var o=n.getHeight(r);i+=o}})),i}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,r=this.cols,n=this.freeze,o=this.exceptRowSet,i=t.ri,a=t.ci;i<=0&&(i=ae(n,1)[0]),a<=0&&(a=ae(n,2)[1]);for(var u=0,l=0,c=[e.len,r.len],s=c[0],f=c[1],h=i;h<e.len&&(o.has(h)||(l+=e.getHeight(h),s=h),!(l>this.viewHeight()));h+=1);for(var p=a;p<r.len&&(f=p,!((u+=r.getWidth(p))>this.viewWidth()));p+=1);return new I(i,a,s,f,u,l)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach((function(t){return e(t)}))}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,r=this.selector,n=ae(r.size(),2),o=n[0],i=n[1],a=r.range,u=a.sri,l=a.sci,c=a.eri,s=a.eci;if(o===t.len)for(var f=l;f<=s;f+=1)e.setHide(f,!0);else if(i===e.len)for(var h=u;h<=c;h+=1)t.setHide(h,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,r){for(var n=0,o=this.rows,i=this.exceptRowSet,a=ne(i),u=0,l=0;l<a.length;l+=1)a[l]<t&&(u+=1);for(var c=t+u;c<=e+u;c+=1)if(i.has(c))u+=1;else{var s=o.getHeight(c);if(s>0&&(r(c,n,s),(n+=s)>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,r){for(var n=0,o=this.cols,i=t;i<=e;i+=1){var a=o.getWidth(i);if(a>0&&(r(i,n,a),(n+=a)>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,r=0;r<e.length;r+=1){var n=e[r];if(it.equals(n,t))return r}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach((function(r){if("merges"===r||"rows"===r||"cols"===r||"validations"===r||"sheetConfig"===r)e[r].setData(t[r]);else if("freeze"===r){var n=ae(b(t[r]),2),o=n[0],i=n[1];e.freeze=[i,o]}else"autofilter"===r?e.autoFilter.setData(t[r]):void 0!==t[r]&&(e[r]=t[r])})),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,r=this.styles,n=this.merges,o=this.rows,i=this.cols,a=this.validations,u=this.autoFilter,l=this.sheetConfig;return{name:t,freeze:m(e[1],e[0]),styles:r,merges:n.getData(),rows:o.getData(),cols:i.getData(),validations:a.getData(),autofilter:u.getData(),sheetConfig:l.getData()}}}])&&oe(t.prototype,e),r&&oe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function de(t){return function(t){if(Array.isArray(t))return we(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ge(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(t,e){if(t){if("string"==typeof t)return we(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?we(t,e):void 0}}function we(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ee(t,e,r){t.addEventListener(e,r)}function Se(t,e,r){t.removeEventListener(e,r)}function Oe(t){t.xclickoutside&&(Se(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function Ne(t,e){t.xclickoutside=function(r){2===r.detail||t.contains(r.target)||(e?e(t):(t.hide(),Oe(t)))},Ee(window.document.body,"click",t.xclickoutside)}function Ie(t,e,r){Ee(t,"mousemove",e),t.xEvtUp=function(n){Se(t,"mousemove",e),Se(t,"mouseup",t.xEvtUp),r(n)},Ee(t,"mouseup",t.xEvtUp)}function Ae(t,e,r,n){Math.abs(t)>Math.abs(e)?n(t>0?"right":"left",t,r):n(e>0?"down":"up",e,r)}function Te(){var t=new Map;function e(e,r){var n;return t.has(e)&&(n=t.get(e),Array.isArray(n)&&n.push(r)||!1)||t.set(e,[].concat(r))}function r(e,r){var n,o;return t.has(e)&&(n=t.get(e),(o=n.indexOf(r))>=0&&n.splice(o,1)&&0===t.get(e).length&&t.delete(e))}return{get current(){return t},on:e,once:function(t,n){return e(t,(function e(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];n.call.apply(n,[null].concat(i)),r(t,e)}))},fire:function(e,r){return t.has(e)&&function(){var n,o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=ge(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(t.get(e));try{for(o.s();!(n=o.n()).done;){var i=n.value;i.call.apply(i,[null].concat(de(r)))}}catch(t){o.e(t)}finally{o.f()}}()},removeListener:r,removeAllListeners:function(){t.clear()}}}var Pe="x-spreadsheet";window.devicePixelRatio;function Me(t){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Re(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,je(n.key),n)}}function je(t){var e=function(t,e){if("object"!=Me(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Me(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Me(e)?e:e+""}var Ce=function(){return t=function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;ke(this,t),this.moving=!1,this.vertical=r,this.el=s("div","".concat(Pe,"-resizer ").concat(r?"vertical":"horizontal")).children(this.unhideHoverEl=s("div","".concat(Pe,"-resizer-hover")).on("dblclick.stop",(function(t){return e.mousedblclickHandler(t)})).css("position","absolute").hide(),this.hoverEl=s("div","".concat(Pe,"-resizer-hover")).on("mousedown.stop",(function(t){return e.mousedownHandler(t)})),this.lineEl=s("div","".concat(Pe,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=n,this.unhideFn=function(){}},(e=[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var r=this.moving,n=this.vertical,o=this.hoverEl,i=this.lineEl,a=this.el,u=this.unhideHoverEl;if(!r){this.cRect=t;var l=t.left,c=t.top,s=t.width,f=t.height;a.offset({left:n?l+s-5:l,top:n?c:c+f-5}).show(),o.offset({width:n?5:s,height:n?f:5}),i.offset({width:n?0:e.width,height:n?e.height:0}),u.offset({left:n?5-s:l,top:n?c:5-f,width:n?5:s,height:n?f:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,r=t,n=this.el,o=this.lineEl,i=this.cRect,a=this.vertical,u=this.minDistance,l=a?i.width:i.height;o.show(),Ie(window,(function(t){e.moving=!0,null!==r&&1===t.buttons&&(a?(l+=t.movementX)>u&&n.css("left","".concat(i.left+l,"px")):(l+=t.movementY)>u&&n.css("top","".concat(i.top+l,"px")),r=t)}),(function(){r=null,o.hide(),e.moving=!1,e.hide(),e.finishedFn&&(l<u&&(l=u),e.finishedFn(i,l))}))}}])&&Re(t.prototype,e),r&&Re(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function xe(t){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function De(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_e(n.key),n)}}function _e(t){var e=function(t,e){if("object"!=xe(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=xe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==xe(e)?e:e+""}var Le=function(){return t=function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=e,this.moveFn=null,this.el=s("div","".concat(Pe,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=s("div","")).on("mousemove.stop",(function(){})).on("scroll.stop",(function(t){var e=t.target,n=e.scrollTop,o=e.scrollLeft;r.moveFn&&r.moveFn(r.vertical?n:o,t)}))},(e=[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var r=t-1;if(e>r){var n=this.vertical?"height":"width";this.el.css(n,"".concat(r-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(n,"".concat(e,"px"))}else this.el.hide();return this}}])&&De(t.prototype,e),r&&De(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Ue(t){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ve(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,He(n.key),n)}}function Be(t,e,r){return e&&Ve(t.prototype,e),r&&Ve(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function He(t){var e=function(t,e){if("object"!=Ue(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ue(e)?e:e+""}var Ge=10,qe=function(){return Be((function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Fe(this,t),this.useHideInput=r,this.autoFocus=n,this.inputChange=function(){},this.cornerEl=s("div","".concat(Pe,"-selector-corner")),this.areaEl=s("div","".concat(Pe,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=s("div","".concat(Pe,"-selector-clipboard")).hide(),this.autofillEl=s("div","".concat(Pe,"-selector-autofill")).hide(),this.el=s("div","".concat(Pe,"-selector")).css("z-index","".concat(Ge)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),r&&(this.hideInput=s("input","").on("compositionend",(function(t){e.inputChange(t.target.value)})),this.el.child(this.hideInputDiv=s("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=s("div","hide-input").child(this.hideInput))),Ge+=1}),[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,r=t.top,n={width:t.width-3+.8,height:t.height-3+.8,left:e-.8,top:r-.8};this.areaEl.offset(n).show(),this.useHideInput&&(this.hideInputDiv.offset(n),this.autoFocus?this.hideInput.val("").focus():this.hideInput.val(""))}},{key:"setClipboardOffset",value:function(t){var e=t.left,r=t.top,n=t.width,o=t.height;this.clipboardEl.offset({left:e,top:r,width:n-5,height:o-5})}},{key:"showAutofill",value:function(t){var e=t.left,r=t.top,n=t.width,o=t.height;this.autofillEl.offset({width:n-3,height:o-3,left:e,top:r}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}])}();function Ye(t){var e=this.data,r=t.left,n=t.top,o=t.width,i=t.height,a=t.scroll,u=t.l,l=t.t,c=e.freezeTotalWidth(),s=e.freezeTotalHeight(),f=r-c;c>u&&(f-=a.x);var h=n-s;return s>l&&(h-=a.y),{left:f,top:h,width:o,height:i}}function ze(t){var e=this.data,r=t.left,n=t.width,o=t.height,i=t.l,a=t.t,u=t.scroll,l=e.freezeTotalWidth(),c=r-l;return l>i&&(c-=u.x),{left:c,top:a,width:n,height:o}}function Xe(t){var e=this.data,r=t.top,n=t.width,o=t.height,i=t.l,a=t.t,u=t.scroll,l=e.freezeTotalHeight(),c=r-l;return l>a&&(c-=u.y),{left:i,top:c,width:n,height:o}}function We(t){this.br.setAreaOffset(Ye.call(this,t))}function $e(t){this.tl.setAreaOffset(t)}function Ke(t){this.t.setAreaOffset(ze.call(this,t))}function Qe(t){this.l.setAreaOffset(Xe.call(this,t))}function Ze(t){this.l.setClipboardOffset(Xe.call(this,t))}function Je(t){this.br.setClipboardOffset(Ye.call(this,t))}function tr(t){this.tl.setClipboardOffset(t)}function er(t){this.t.setClipboardOffset(ze.call(this,t))}function rr(t){We.call(this,t),$e.call(this,t),Ke.call(this,t),Qe.call(this,t)}function nr(t){Je.call(this,t),tr.call(this,t),er.call(this,t),Ze.call(this,t)}var or=function(){return Be((function t(e){var r=this;Fe(this,t);var n=e.settings.autoFocus;this.inputChange=function(){},this.data=e,this.br=new qe(!0,n),this.t=new qe,this.l=new qe,this.tl=new qe,this.br.inputChange=function(t){r.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=s("div","".concat(Pe,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,Ge+=1}),[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,r=this.t,n=this.l,o=this.br,i=t.freezeTotalHeight(),a=t.freezeTotalWidth();i>0||a>0?(e.setOffset({width:a,height:i}),r.setOffset({left:a,height:i}),n.setOffset({top:i,width:a}),o.setOffset({left:a,top:i})):(e.hide(),r.hide(),n.hide(),o.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();rr.call(this,t),nr.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();We.call(this,t),Ke.call(this,t),Je.call(this,e),er.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();We.call(this,t),Qe.call(this,t),Je.call(this,e),Ze.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,o=n.calSelectedRangeByStart(t,e),i=o.sri,a=o.sci;if(r){var u=t,l=e;t<0&&(u=0),e<0&&(l=0),n.selector.setIndexes(u,l),this.indexes=[u,l]}this.moveIndexes=[i,a],this.range=o,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.data,o=this.lastri,i=this.lastci;if(r){if(t===o&&e===i)return;this.lastri=t,this.lastci=e}this.range=n.calSelectedRangeByEnd(t,e),rr.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,r=t.eci;this.setEnd(e,r)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var r=this.range,n=r.sri,o=r.sci,i=r.eri,a=r.eci,u=t,l=e,c=n-t,s=i-t,f=a-e;if(o-e>0)this.arange=new I(n,l,i,o-1);else if(c>0)this.arange=new I(u,o,n-1,a);else if(f<0)this.arange=new I(n,a+1,i,l);else{if(!(s<0))return void(this.arange=null);this.arange=new I(i+1,o,u,a)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var p=this.br,y=this.l,v=this.t,b=this.tl;p.showAutofill(Ye.call(this,h)),y.showAutofill(Xe.call(this,h)),v.showAutofill(ze.call(this,h)),b.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideAutofill()}))}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();nr.call(this,e),["br","l","t","tl"].forEach((function(e){t[e].showClipboard()}))}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideClipboard()}))}}])}();function ir(t){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ar(t){return function(t){if(Array.isArray(t))return ur(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ur(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ur(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ur(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function lr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sr(n.key),n)}}function sr(t){var e=function(t,e){if("object"!=ir(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ir(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ir(e)?e:e+""}function fr(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}function hr(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}function pr(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}function yr(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:t.stopPropagation();break;case 38:fr.call(this,t);break;case 39:t.stopPropagation();break;case 40:hr.call(this,t);break;case 13:case 9:pr.call(this,t);break;default:t.stopPropagation()}}var vr=function(){return t=function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";lr(this,t),this.filterItems=[],this.items=e,this.el=s("div","".concat(Pe,"-suggest")).css("width",n).hide(),this.itemClick=r,this.itemIndex=-1},(e=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),Oe(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,r=this,n=this.items;if(/^\s*$/.test(t)||(n=n.filter((function(e){return(e.key||e).startsWith(t.toUpperCase())}))),n=n.map((function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var n=s("div","".concat(Pe,"-item")).child(e).on("click.stop",(function(){r.itemClick(t),r.hide()}));return t.label&&n.child(s("div","label").html(t.label)),n})),this.filterItems=n,!(n.length<=0)){var o=this.el;(e=o.html("")).children.apply(e,ar(n)).show(),Ne(o.parent(),(function(){r.hide()}))}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",(function(t){return yr.call(e,t)}))}}])&&cr(t.prototype,e),r&&cr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function br(t){return(br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dr(n.key),n)}}function dr(t){var e=function(t,e){if("object"!=br(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=br(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==br(e)?e:e+""}function gr(t,e,r){return e=wr(e),function(t,e){if(e&&("object"==br(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],wr(t).constructor):e.apply(t,r))}function wr(t){return(wr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Er(t,e){return(Er=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Sr=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=gr(this,e,["div","".concat(Pe,"-icon")])).iconNameEl=s("div","".concat(Pe,"-icon-img ").concat(t)),r.child(r.iconNameEl),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Er(t,e)}(e,t),r=e,(n=[{key:"setName",value:function(t){this.iconNameEl.className("".concat(Pe,"-icon-img ").concat(t))}}])&&mr(r.prototype,n),o&&mr(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(c);function Or(t){return(Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nr(t){return function(t){if(Array.isArray(t))return Ir(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ir(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ir(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ir(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ar(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tr(n.key),n)}}function Tr(t){var e=function(t,e){if("object"!=Or(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Or(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Or(e)?e:e+""}function Pr(t,e){t.setMonth(t.getMonth()+e)}function Mr(t,e){var r=new Date(t);return r.setDate(e-t.getDay()+1),r}var kr=function(){return t=function t(e){var r,n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=s("div","calendar-header-left"),this.bodyEl=s("tbody",""),this.buildAll(),this.el=s("div","x-spreadsheet-calendar").children(s("div","calendar-header").children(this.headerLeftEl,s("div","calendar-header-right").children(s("a","calendar-prev").on("click.stop",(function(){return n.prev()})).child(new Sr("chevron-left")),s("a","calendar-next").on("click.stop",(function(){return n.next()})).child(new Sr("chevron-right")))),s("table","calendar-body").children(s("thead","").child((r=s("tr","")).children.apply(r,Nr(It("calendar.weeks").map((function(t){return s("th","cell").child(t)}))))),this.bodyEl)),this.selectChange=function(){}},(e=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){Pr(this.value,-1),this.buildAll()}},{key:"next",value:function(){Pr(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(It("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,r=this.value,n=this.cvalue,o=this.bodyEl,i=function(t,e,r){for(var n=new Date(t,e,1,23,59,59),o=[[],[],[],[],[],[]],i=0;i<6;i+=1)for(var a=0;a<7;a+=1){var u=Mr(n,7*i+a),l=u.getMonth()!==e,c=u.getMonth()===r.getMonth()&&u.getDate()===r.getDate();o[i][a]={d:u,disabled:l,active:c}}return o}(r.getFullYear(),r.getMonth(),n).map((function(t){var r,n=t.map((function(t){var r="cell";return t.disabled&&(r+=" disabled"),t.active&&(r+=" active"),s("td","").child(s("div",r).on("click.stop",(function(){e.selectChange(t.d)})).child(t.d.getDate().toString()))}));return(r=s("tr","")).children.apply(r,Nr(n))}));(t=o.html("")).children.apply(t,Nr(i))}}])&&Ar(t.prototype,e),r&&Ar(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Rr(t){return(Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Cr(n.key),n)}}function Cr(t){var e=function(t,e){if("object"!=Rr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Rr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Rr(e)?e:e+""}var xr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new kr(new Date),this.el=s("div","".concat(Pe,"-datepicker")).child(this.calendar.el).hide()},(e=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(r){t(r),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&jr(t.prototype,e),r&&jr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Dr(t){return(Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _r(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Lr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?_r(Object(r),!0).forEach((function(e){Ur(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_r(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Ur(t,e,r){return(e=Br(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Br(n.key),n)}}function Br(t){var e=function(t,e){if("object"!=Dr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Dr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Dr(e)?e:e+""}function Hr(t){return function(t){if(Array.isArray(t))return Gr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Gr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Gr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function qr(){var t=this.inputText;if(!/^\s*$/.test(t)){var e=this.textlineEl,r=this.textEl,n=this.areaOffset,o=t.split("\n"),i=Math.max.apply(Math,Hr(o.map((function(t){return t.length})))),a=e.offset().width/t.length,u=(i+1)*a+5,l=this.viewFn().width-n.left-a,c=o.length;if(u>n.width){var s=u;u>l&&(s=l,c+=parseInt(u/l,10),c+=u%l>0?1:0),r.css("width","".concat(s,"px"))}(c*=this.rowHeight)>n.height&&r.css("height","".concat(c,"px"))}}function Yr(t,e){var r=t.target,n=r.value,o=r.selectionEnd,i="".concat(n.slice(0,o)).concat(e).concat(n.slice(o));r.value=i,r.setSelectionRange(o+1,o+1),this.inputText=i,this.textlineEl.html(i),qr.call(this)}function zr(t){var e=t.keyCode,r=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&r&&(Yr.call(this,t,"\n"),t.stopPropagation()),13!==e||r||t.preventDefault()}function Xr(t){var e=t.target.value,r=this.suggest,n=this.textlineEl,o=this.validator,i=this.cell;if(null!==i)if("editable"in i&&!0===i.editable||void 0===i.editable){if(this.inputText=e,o)"list"===o.type?r.search(e):r.hide();else{var a=e.lastIndexOf("=");-1!==a?r.search(e.substring(a+1)):r.hide()}n.html(e),qr.call(this),this.change("input",e)}else t.target.value=i.text||"";else{if(this.inputText=e,o)"list"===o.type?r.search(e):r.hide();else{var u=e.lastIndexOf("=");-1!==u?r.search(e.substring(u+1)):r.hide()}n.html(e),qr.call(this),this.change("input",e)}}function Wr(t){var e=this.textEl.el;setTimeout((function(){e.focus(),e.setSelectionRange(t,t)}),0)}function $r(t,e){var r=this.textEl,n=this.textlineEl;r.el.blur(),r.val(t),n.html(t),Wr.call(this,e)}function Kr(t){var e=this.inputText,r=this.validator,n=0;if(r&&"list"===r.type)this.inputText=t,n=this.inputText.length;else{var o=e.lastIndexOf("="),i=e.substring(0,o+1),a=e.substring(o+1);a=-1!==a.indexOf(")")?a.substring(a.indexOf(")")):"",this.inputText="".concat(i+t.key,"("),n=this.inputText.length,this.inputText+=")".concat(a)}$r.call(this,this.inputText,n)}function Qr(){this.suggest.setItems(this.formulas)}function Zr(t){var e=t.getMonth()+1,r=t.getDate();return e<10&&(e="0".concat(e)),r<10&&(r="0".concat(r)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(r)}var Jr=function(){return function(t,e,r){return e&&Vr(t.prototype,e),r&&Vr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(e,r,n){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Fr(this,t),this.options=i,this.viewFn=r,this.rowHeight=n,this.formulas=e,this.suggest=new vr(e,(function(t){Kr.call(o,t)})),this.datepicker=new xr,this.datepicker.change((function(t){o.setText(Zr(t)),o.clear()})),this.areaEl=s("div","".concat(Pe,"-editor-area")).children(this.textEl=s("textarea","").on("input",(function(t){return Xr.call(o,t)})).on("paste.stop",(function(){})).on("keydown",(function(t){return zr.call(o,t)})),this.textlineEl=s("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),this.el=s("div","".concat(Pe,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}),[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),Qr.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",r=this.textEl,n=this.areaEl,o=this.suggest,i=this.freeze,a=this.el;if(t){this.areaOffset=t;var u=t.left,l=t.top,c=t.width,s=t.height,f=t.l,h=t.t,p={left:0,top:0};i.w>f&&i.h>h||(i.w<f&&i.h<h?(p.left=i.w,p.top=i.h):i.w>f?p.top=i.h:i.h>h&&(p.left=i.w)),a.offset(p),n.offset({left:u-p.left-.8,top:l-p.top-.8}),r.offset({width:c-9+.8,height:s-3+.8});var y={left:0};y[e]=s,o.setOffset(y),o.hide()}}},{key:"setCell",value:function(t,e){if(!t||!1!==t.editable){var r=this.options.editValueFormatter,n=this.el,o=this.datepicker,i=this.suggest;n.show(),this.cell=t;var a,u="";if(r)u=null!==(a=r(Lr(Lr({},this),{},{cell:t})))&&void 0!==a?a:t&&t.text||"";else u=t&&t.text||"";if(this.setText(u),this.validator=e,e){var l=e.type;"date"===l&&(o.show(),/^\s*$/.test(u)||o.setValue(u)),"list"===l&&(i.setItems(e.values()),i.search(""))}}}},{key:"setText",value:function(t){this.inputText=t,$r.call(this,t,t.length),qr.call(this)}}])}();function tn(t){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function en(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rn(n.key),n)}}function rn(t){var e=function(t,e){if("object"!=tn(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=tn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==tn(e)?e:e+""}function nn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function on(t,e,r){return e=an(e),function(t,e){if(e&&("object"==tn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],an(t).constructor):e.apply(t,r))}function an(t){return(an=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function un(t,e){return(un=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ln=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return nn(this,e),(r=on(this,e,["div","".concat(Pe,"-button ").concat(n)])).child(It("button.".concat(t))),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&un(t,e)}(e,t),r=e,n&&en(r.prototype,n),o&&en(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(c);function cn(t){return function(t){if(Array.isArray(t))return hn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||fn(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||fn(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fn(t,e){if(t){if("string"==typeof t)return hn(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hn(t,e):void 0}}function hn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function pn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function yn(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?pn(Object(r),!0).forEach((function(e){vn(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pn(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function vn(t,e,r){return(e=wn(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bn(t){return(bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wn(n.key),n)}}function gn(t,e,r){return e&&dn(t.prototype,e),r&&dn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wn(t){var e=function(t,e){if("object"!=bn(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=bn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==bn(e)?e:e+""}function En(){return window.devicePixelRatio||1}function Sn(){return En()-.5}function On(t){return parseInt(t*En(),10)}function Nn(t){var e=On(t);return e>0?e-.5:.5}var In=function(){return gn((function t(e,r,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;mn(this,t),this.x=e,this.y=r,this.width=n,this.height=o,this.padding=i,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}),[{key:"setBorders",value:function(t){var e=t.top,r=t.bottom,n=t.left,o=t.right;e&&(this.borderTop=e),o&&(this.borderRight=o),r&&(this.borderBottom=r),n&&(this.borderLeft=n)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,r=this.padding,n=this.x;return"left"===t?n+=r:"center"===t?n+=e/2:"right"===t&&(n+=e-r),n}},{key:"texty",value:function(t,e){var r=this.height,n=this.padding,o=this.y;return"top"===t?o+=n:"middle"===t?o+=r/2-e/2:"bottom"===t&&(o+=r-n-e),o}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,r=this.width;return[[t+r,e],[t+r,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,r=this.width,n=this.height;return[[t,e+n],[t+r,e+n]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}])}();function An(t,e,r,n,o,i,a){var u={x:0,y:0};"underline"===t?u.y="bottom"===o?0:"top"===o?-(i+2):-i/2:"strike"===t&&("bottom"===o?u.y=i/2:"top"===o&&(u.y=-(i/2+2))),"center"===n?u.x=a/2:"right"===n&&(u.x=a),this.line([e-u.x,r-u.y],[e-u.x+a,r-u.y])}var Tn=function(){return gn((function t(e,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};mn(this,t),this.options=o,this.el=e,this.ctx=e.getContext("2d"),this.resize(r,n),this.ctx.scale(En(),En()),this.numberRegexObject={",":/^[+-]?[0-9,]*(\.[0-9,]*)?$/,".":/^[+-]?[0-9.]*(\,[0-9.]*)?$/,"'":/^[+-]?[0-9']*(\.[0-9']*)?$/}}),[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=On(t),this.el.height=On(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,r=t.height;return this.ctx.clearRect(0,0,e,r),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(On(t),On(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,r,n){return this.ctx.clearRect(t,e,r,n),this}},{key:"fillRect",value:function(t,e,r,n){return this.ctx.fillRect(On(t)-.5,On(e)-.5,On(r),On(n)),this}},{key:"fillText",value:function(t,e,r){return this.ctx.fillText(t,On(e),On(r)),this}},{key:"textConfigOperation",value:function(t,e){if(t){var r,n,o=this.options.valueFormatter,i=null!==(r=this.options.numberConfig)&&void 0!==r?r:{};if(o)t=null!==(n=o(yn(yn({},this),{},{value:t,cellMeta:e})))&&void 0!==n?n:t;var a=i.zeroReplacer,u=i.groupingSymbol;if(a)if(this.numberRegexObject[null!=u?u:","].test(t))!parseFloat(t)&&(t=a)}return t}},{key:"text",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};t=this.textConfigOperation(t,i);var a=this.ctx,u=n.align,l=n.valign,c=n.font,s=n.color,f=n.strike,h=n.underline,p=e.textx(u);a.save(),a.beginPath(),this.attr({textAlign:u,textBaseline:l,font:"".concat(c.italic?"italic":""," ").concat(c.bold?"bold":""," ").concat(On(c.size),"px ").concat(c.name),fillStyle:s,strokeStyle:s});var y="".concat(t).split("\n"),v=e.innerWidth(),b=[];y.forEach((function(t){var e=a.measureText(t).width;if(o&&e>On(v)){for(var r={w:0,len:0,start:0},n=0;n<t.length;n+=1)r.w>=On(v)&&(b.push(t.substr(r.start,r.len)),r={w:0,len:0,start:n}),r.len+=1,r.w+=a.measureText(t[n]).width+1;r.len>0&&b.push(t.substr(r.start,r.len))}else b.push(t)}));var m=(b.length-1)*(c.size+2),d=e.texty(l,m);return b.forEach((function(t){var e=a.measureText(t).width;r.fillText(t,p,d),f&&An.call(r,"strike",p,d,u,l,c.size,e),h&&An.call(r,"underline",p,d,u,l,c.size,e),d+=c.size+2})),a.restore(),this}},{key:"border",value:function(t,e){var r=this.ctx;return r.lineWidth=Sn,r.strokeStyle=e,"medium"===t?r.lineWidth=On(2)-.5:"thick"===t?r.lineWidth=On(3):"dashed"===t?r.setLineDash([On(3),On(2)]):"dotted"===t?r.setLineDash([On(1),On(1)]):"double"===t&&r.setLineDash([On(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=arguments.length<=0?void 0:arguments[0],r=sn(e,2),n=r[0],o=r[1];t.moveTo(Nn(n),Nn(o));for(var i=1;i<arguments.length;i+=1){var a=i<0||arguments.length<=i?void 0:arguments[i],u=sn(a,2),l=u[0],c=u[1];t.lineTo(Nn(l),Nn(c))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var r=t.borderTop,n=t.borderRight,o=t.borderBottom,i=t.borderLeft;r&&(this.border.apply(this,cn(r)),this.line.apply(this,cn(t.topxys()))),n&&(this.border.apply(this,cn(n)),this.line.apply(this,cn(t.rightxys()))),o&&(this.border.apply(this,cn(o)),this.line.apply(this,cn(t.bottomxys()))),i&&(this.border.apply(this,cn(i)),this.line.apply(this,cn(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,r=t.x,n=t.y,o=r+t.width-15,i=n+t.height-15;e.save(),e.beginPath(),e.moveTo(On(o),On(i)),e.lineTo(On(o+8),On(i)),e.lineTo(On(o+4),On(i+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,r=t.x,n=t.y,o=r+t.width-1;e.save(),e.beginPath(),e.moveTo(On(o-8),On(n-1)),e.lineTo(On(o),On(n-1)),e.lineTo(On(o),On(n+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,r=t.x,n=t.y,o=r+t.width-1;e.save(),e.beginPath(),e.moveTo(On(o-8),On(n-1)),e.lineTo(On(o),On(n-1)),e.lineTo(On(o),On(n+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var r=this.ctx,n=t.x,o=t.y,i=t.width,a=t.height,u=t.bgcolor;r.save(),r.beginPath(),r.fillStyle=u||"#fff",r.rect(Nn(n+1),Nn(o+1),On(i-2),On(a-2)),r.clip(),r.fill(),e(),r.restore()}}])}(),Pn=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],Mn=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function kn(t){for(var e=0;e<Mn.length;e+=1){var r=Mn[e];if(r.pt===t)return r.px}return t}var Rn,jn=r(13);function Cn(t){var e;return"number"==typeof t?e=t:"string"==typeof t&&(e=t.indexOf(".")>-1?parseFloat(t):parseInt(t,10)),e}function xn(t){return-1*Cn(t)}function Dn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var _n=(Dn(Rn={},"ERROR","#ERROR!"),Dn(Rn,"DIV/0","#DIV/0!"),Dn(Rn,"NAME","#NAME?"),Dn(Rn,"N/A","#N/A"),Dn(Rn,"NULL","#NULL!"),Dn(Rn,"NUM","#NUM!"),Dn(Rn,"REF","#REF!"),Dn(Rn,"VALUE","#VALUE!"),Rn);function Ln(t){var e;return t=(t+"").replace(/#|!|\?/g,""),_n[t]&&(e=_n[t]),e||null}function Un(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var o=r.reduce((function(t,e){return t+Cn(e)}),Cn(t));if(isNaN(o))throw Error("VALUE");return o}Un.SYMBOL="+";function Fn(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.reduce((function(t,e){return t+e.toString()}),"")}Fn.SYMBOL="&";function Vn(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var o=r.reduce((function(t,e){return t/Cn(e)}),Cn(t));if(o===1/0)throw Error("DIV/0");if(isNaN(o))throw Error("VALUE");return o}Vn.SYMBOL="/";function Bn(t,e){return t===e}Bn.SYMBOL="=";var Hn=r(2),Gn=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXP","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKEWP","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"],qn=Gn;function Yn(t){return function(){var e,r=(t=t.toUpperCase()).split("."),n=!1;if(1===r.length)Hn[r[0]]&&(n=!0,e=Hn[r[0]].apply(Hn,arguments));else{for(var o=r.length,i=0,a=Hn;i<o;)if(a=a[r[i]],i++,!a){a=null;break}a&&(n=!0,e=a.apply(void 0,arguments))}if(!n)throw Error("NAME");return e}}Yn.isFactory=!0,Yn.SYMBOL=qn;function zn(t,e){return t>e}zn.SYMBOL=">";function Xn(t,e){return t>=e}Xn.SYMBOL=">=";function Wn(t,e){return t<e}Wn.SYMBOL="<";function $n(t,e){return t<=e}$n.SYMBOL="<=";function Kn(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var o=r.reduce((function(t,e){return t-Cn(e)}),Cn(t));if(isNaN(o))throw Error("VALUE");return o}Kn.SYMBOL="-";function Qn(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var o=r.reduce((function(t,e){return t*Cn(e)}),Cn(t));if(isNaN(o))throw Error("VALUE");return o}Qn.SYMBOL="*";function Zn(t,e){return t!==e}Zn.SYMBOL="<>";function Jn(t,e){var r=Math.pow(Cn(t),Cn(e));if(isNaN(r))throw Error("VALUE");return r}function to(t){return function(t){if(Array.isArray(t))return eo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return eo(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eo(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eo(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}Jn.SYMBOL="^";var ro=Object.create(null);function no(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t=t.toUpperCase(),!ro[t])throw Error("NAME");return ro[t].apply(ro,to(e))}function oo(t,e){Array.isArray(t)||(t=[t.toUpperCase()]),t.forEach((function(t){e.isFactory?ro[t]=e(t):ro[t]=e}))}oo(Un.SYMBOL,Un),oo(Fn.SYMBOL,Fn),oo(Vn.SYMBOL,Vn),oo(Bn.SYMBOL,Bn),oo(Jn.SYMBOL,Jn),oo(Yn.SYMBOL,Yn),oo(zn.SYMBOL,zn),oo(Xn.SYMBOL,Xn),oo(Wn.SYMBOL,Wn),oo($n.SYMBOL,$n),oo(Qn.SYMBOL,Qn),oo(Zn.SYMBOL,Zn),oo(Kn.SYMBOL,Kn);var io=function(t,e,r,n){for(r=r||{},n=t.length;n--;r[t[n]]=e);return r},ao=[1,5],uo=[1,8],lo=[1,6],co=[1,7],so=[1,9],fo=[1,14],ho=[1,15],po=[1,16],yo=[1,12],vo=[1,13],bo=[1,17],mo=[1,19],go=[1,20],wo=[1,21],Eo=[1,22],So=[1,23],Oo=[1,24],No=[1,25],Io=[1,26],Ao=[1,27],To=[1,28],Po=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],Mo=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],ko=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],Ro=[5,10,11,13,14,15,16,17,29,30],jo=[5,10,13,14,15,16,29,30],Co=[5,10,11,13,14,15,16,17,18,19,29,30],xo=[13,29,30],Do={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function(t,e,r,n,o,i,a){var u=i.length-1;switch(o){case 1:return i[u-1];case 2:this.$=n.callVariable(i[u][0]);break;case 3:this.$=n.toNumber(i[u]);break;case 4:this.$=n.trimEdges(i[u]);break;case 5:this.$=n.evaluateByOperator("&",[i[u-2],i[u]]);break;case 6:this.$=n.evaluateByOperator("=",[i[u-2],i[u]]);break;case 7:this.$=n.evaluateByOperator("+",[i[u-2],i[u]]);break;case 8:this.$=i[u-1];break;case 9:this.$=n.evaluateByOperator("<=",[i[u-3],i[u]]);break;case 10:this.$=n.evaluateByOperator(">=",[i[u-3],i[u]]);break;case 11:this.$=n.evaluateByOperator("<>",[i[u-3],i[u]]);break;case 12:this.$=n.evaluateByOperator("NOT",[i[u-2],i[u]]);break;case 13:this.$=n.evaluateByOperator(">",[i[u-2],i[u]]);break;case 14:this.$=n.evaluateByOperator("<",[i[u-2],i[u]]);break;case 15:this.$=n.evaluateByOperator("-",[i[u-2],i[u]]);break;case 16:this.$=n.evaluateByOperator("*",[i[u-2],i[u]]);break;case 17:this.$=n.evaluateByOperator("/",[i[u-2],i[u]]);break;case 18:this.$=n.evaluateByOperator("^",[i[u-2],i[u]]);break;case 19:var l=n.invertNumber(i[u]);this.$=l,isNaN(this.$)&&(this.$=0);break;case 20:l=n.toNumber(i[u]);this.$=l,isNaN(this.$)&&(this.$=0);break;case 21:this.$=n.callFunction(i[u-2]);break;case 22:this.$=n.callFunction(i[u-3],i[u-1]);break;case 26:case 27:case 28:this.$=n.cellValue(i[u]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=n.rangeValue(i[u-2],i[u]);break;case 38:case 42:this.$=[i[u]];break;case 39:this.$=n.trimEdges(t).split(",");break;case 40:case 41:i[u-2].push(i[u]),this.$=i[u-2];break;case 43:this.$=Array.isArray(i[u-2])?i[u-2]:[i[u-2]],this.$.push(i[u]);break;case 44:this.$=i[u];break;case 45:this.$=1*(i[u-2]+"."+i[u]);break;case 46:this.$=.01*i[u-1];break;case 47:this.$=n.throwError(i[u])}},table:[{2:11,3:1,4:2,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{1:[3]},{5:[1,18],9:mo,10:go,11:wo,14:Eo,15:So,16:Oo,17:No,18:Io,19:Ao,20:To},io(Po,[2,2],{32:[1,29]}),io(Po,[2,3],{34:[1,30]}),io(Po,[2,4]),{2:11,4:31,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{2:11,4:32,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{2:11,4:33,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{12:[1,34]},io(Po,[2,23]),io(Po,[2,24],{2:35,35:bo}),io(Mo,[2,42]),io(ko,[2,44],{32:[1,36]}),io(Po,[2,26],{27:[1,37]}),io(Po,[2,27],{27:[1,38]}),io(Po,[2,28],{27:[1,39]}),io([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{2:11,4:41,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{2:11,4:42,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{2:11,4:45,6:3,7:4,8:ao,10:[1,43],11:uo,12:lo,15:[1,44],17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{2:11,4:47,6:3,7:4,8:ao,10:[1,46],11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{2:11,4:48,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{2:11,4:49,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{2:11,4:50,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{2:11,4:51,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{2:11,4:52,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{31:[1,53]},io(ko,[2,46]),{9:mo,10:go,11:wo,13:[1,54],14:Eo,15:So,16:Oo,17:No,18:Io,19:Ao,20:To},io(Ro,[2,19],{9:mo,18:Io,19:Ao,20:To}),io(Ro,[2,20],{9:mo,18:Io,19:Ao,20:To}),{2:11,4:57,6:3,7:4,8:ao,11:uo,12:lo,13:[1,55],17:co,21:so,22:56,23:10,24:fo,25:ho,26:po,28:[1,58],31:yo,33:vo,35:bo},io(Po,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},io(Po,[2,5]),io([5,10,13,29,30],[2,6],{9:mo,11:wo,14:Eo,15:So,16:Oo,17:No,18:Io,19:Ao,20:To}),io(Ro,[2,7],{9:mo,18:Io,19:Ao,20:To}),{2:11,4:69,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{2:11,4:70,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},io(jo,[2,14],{9:mo,11:wo,17:No,18:Io,19:Ao,20:To}),{2:11,4:71,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},io(jo,[2,13],{9:mo,11:wo,17:No,18:Io,19:Ao,20:To}),io([5,10,13,16,29,30],[2,12],{9:mo,11:wo,14:Eo,15:So,17:No,18:Io,19:Ao,20:To}),io(Ro,[2,15],{9:mo,18:Io,19:Ao,20:To}),io(Co,[2,16],{9:mo,20:To}),io(Co,[2,17],{9:mo,20:To}),io([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:mo}),io(Mo,[2,43]),io(Po,[2,8]),io(Po,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},io(xo,[2,38],{9:mo,10:go,11:wo,14:Eo,15:So,16:Oo,17:No,18:Io,19:Ao,20:To}),io(xo,[2,39]),io(ko,[2,45]),io(Po,[2,29]),io(Po,[2,30]),io(Po,[2,31]),io(Po,[2,32]),io(Po,[2,33]),io(Po,[2,34]),io(Po,[2,35]),io(Po,[2,36]),io(Po,[2,37]),io(jo,[2,9],{9:mo,11:wo,17:No,18:Io,19:Ao,20:To}),io(jo,[2,11],{9:mo,11:wo,17:No,18:Io,19:Ao,20:To}),io(jo,[2,10],{9:mo,11:wo,17:No,18:Io,19:Ao,20:To}),io(Po,[2,22]),{2:11,4:75,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},{2:11,4:76,6:3,7:4,8:ao,11:uo,12:lo,17:co,21:so,23:10,24:fo,25:ho,26:po,31:yo,33:vo,35:bo},io(xo,[2,40],{9:mo,10:go,11:wo,14:Eo,15:So,16:Oo,17:No,18:Io,19:Ao,20:To}),io(xo,[2,41],{9:mo,10:go,11:wo,14:Eo,15:So,16:Oo,17:No,18:Io,19:Ao,20:To})],defaultActions:{18:[2,1]},parseError:function(t,e){if(!e.recoverable){var r=new Error(t);throw r.hash=e,r}this.trace(t)},parse:function(t){var e=this,r=[0],n=[null],o=[],i=this.table,a="",u=0,l=0,c=0,s=2,f=1,h=o.slice.call(arguments,1),p=Object.create(this.lexer),y={yy:{}};for(var v in this.yy)Object.prototype.hasOwnProperty.call(this.yy,v)&&(y.yy[v]=this.yy[v]);p.setInput(t,y.yy),y.yy.lexer=p,y.yy.parser=this,void 0===p.yylloc&&(p.yylloc={});var b=p.yylloc;o.push(b);var m=p.options&&p.options.ranges;function d(t){r.length=r.length-2*t,n.length=n.length-t,o.length=o.length-t}"function"==typeof y.yy.parseError?this.parseError=y.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var g,w,E,S,O,N,I,A,T,P=function(){var t;return"number"!=typeof(t=p.lex()||f)&&(t=e.symbols_[t]||t),t},M={};;){if(E=r[r.length-1],this.defaultActions[E]?S=this.defaultActions[E]:(null==g&&(g=P()),S=i[E]&&i[E][g]),void 0===S||!S.length||!S[0]){var k,R=function(t){for(var e=r.length-1,n=0;;){if(s.toString()in i[t])return n;if(0===t||e<2)return!1;t=r[e-=2],++n}},j="";if(c)w!==f&&(k=R(E));else{for(N in k=R(E),T=[],i[E])this.terminals_[N]&&N>s&&T.push("'"+this.terminals_[N]+"'");j=p.showPosition?"Parse error on line "+(u+1)+":\n"+p.showPosition()+"\nExpecting "+T.join(", ")+", got '"+(this.terminals_[g]||g)+"'":"Parse error on line "+(u+1)+": Unexpected "+(g==f?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(j,{text:p.match,token:this.terminals_[g]||g,line:p.yylineno,loc:b,expected:T,recoverable:!1!==k})}if(3==c){if(g===f||w===f)throw new Error(j||"Parsing halted while starting to recover from another error.");l=p.yyleng,a=p.yytext,u=p.yylineno,b=p.yylloc,g=P()}if(!1===k)throw new Error(j||"Parsing halted. No suitable error recovery rule available.");d(k),w=g==s?null:g,g=s,E=r[r.length-1],S=i[E]&&i[E][s],c=3}if(S[0]instanceof Array&&S.length>1)throw new Error("Parse Error: multiple actions possible at state: "+E+", token: "+g);switch(S[0]){case 1:r.push(g),n.push(p.yytext),o.push(p.yylloc),r.push(S[1]),g=null,w?(g=w,w=null):(l=p.yyleng,a=p.yytext,u=p.yylineno,b=p.yylloc,c>0&&c--);break;case 2:if(I=this.productions_[S[1]][1],M.$=n[n.length-I],M._$={first_line:o[o.length-(I||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(I||1)].first_column,last_column:o[o.length-1].last_column},m&&(M._$.range=[o[o.length-(I||1)].range[0],o[o.length-1].range[1]]),void 0!==(O=this.performAction.apply(M,[a,l,u,y.yy,S[1],n,o].concat(h))))return O;I&&(r=r.slice(0,-1*I*2),n=n.slice(0,-1*I),o=o.slice(0,-1*I)),r.push(this.productions_[S[1]][0]),n.push(M.$),o.push(M._$),A=i[r[r.length-2]][r[r.length-1]],r.push(A);break;case 3:return!0}}return!0}},_o={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,r=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var r,n,o;if(this.options.backtrack_lexer&&(o={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(o.yylloc.range=this.yylloc.range.slice(0))),(n=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],r=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var i in o)this[i]=o[i];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),i=0;i<o.length;i++)if((r=this._input.match(this.rules[o[i]]))&&(!e||r[0].length>e[0].length)){if(e=r,n=i,this.options.backtrack_lexer){if(!1!==(t=this.test_match(r,o[i])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,o[n]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,r,n){switch(r){case 0:break;case 1:case 2:return 8;case 3:return 21;case 4:return 35;case 5:return 24;case 6:case 7:return 26;case 8:return 25;case 9:return 21;case 10:case 11:return 31;case 12:return 33;case 13:return 28;case 14:return 9;case 15:return" ";case 16:return 32;case 17:return 27;case 18:return 29;case 19:return 30;case 20:return 18;case 21:return 19;case 22:return 17;case 23:return 11;case 24:return 20;case 25:return 12;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 16;case 30:return'"';case 31:return"'";case 32:return"!";case 33:return 10;case 34:return 34;case 35:return"#";case 36:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:!0}}};function Lo(){this.yy={}}function Uo(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t=t.substring(e,t.length-e)}function Fo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Vo(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vo(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vo(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Bo(t){var e=parseInt(t,10);return e=isNaN(e)?-1:Math.max(e-1,-1)}Do.lexer=_o,Lo.prototype=Do,Do.Parser=Lo;var Ho="ABCDEFGHIJKLMNOPQRSTUVWXYZ".length;function Go(t){var e=0;if("string"==typeof t)for(var r=0,n=(t=t.toUpperCase()).length-1;r<t.length;r+=1,n-=1)e+=Math.pow(Ho,n)*("ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(t[r])+1);return--e}var qo=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/;function Yo(t){if("string"!=typeof t||!qo.test(t))return[];var e=Fo(t.toUpperCase().match(qo),5),r=e[1],n=e[2],o=e[3],i=e[4];return[{index:Bo(i),label:i,isAbsolute:"$"===o},{index:Go(n),label:n,isAbsolute:"$"===r}]}function zo(t,e){var r=(t.isAbsolute?"$":"")+function(t){var e="";return t>=0&&(e="".concat(t+1)),e}(t.index);return(e.isAbsolute?"$":"")+function(t){for(var e="";t>=0;)e=String.fromCharCode(t%Ho+97)+e,t=Math.floor(t/Ho)-1;return e.toUpperCase()}(e.index)+r}function Xo(t){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return $o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ko(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Qo(t,e){return(Qo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Zo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ti(t);if(e){var o=ti(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Jo(this,r)}}function Jo(t,e){return!e||"object"!==Xo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ti(t){return(ti=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ei=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qo(t,e)}(i,t);var e,r,n,o=Zo(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).parser=new Lo,t.parser.yy={toNumber:Cn,trimEdges:Uo,invertNumber:xn,throwError:function(e){return t._throwError(e)},callVariable:function(e){return t._callVariable(e)},evaluateByOperator:no,callFunction:function(e,r){return t._callFunction(e,r)},cellValue:function(e){return t._callCellValue(e)},rangeValue:function(e,r){return t._callRangeValue(e,r)}},t.variables=Object.create(null),t.functions=Object.create(null),t.setVariable("TRUE",!0).setVariable("FALSE",!1).setVariable("NULL",null),t}return e=i,(r=[{key:"parse",value:function(t){var e=null,r=null;try{e=""===t?"":this.parser.parse(t)}catch(t){var n=Ln(t.message);r=n||Ln("ERROR")}return e instanceof Error&&(r=Ln(e.message)||Ln("ERROR"),e=null),{error:r,result:e}}},{key:"setVariable",value:function(t,e){return this.variables[t]=e,this}},{key:"getVariable",value:function(t){return this.variables[t]}},{key:"_callVariable",value:function(t){var e=this.getVariable(t);if(this.emit("callVariable",t,(function(t){void 0!==t&&(e=t)})),void 0===e)throw Error("NAME");return e}},{key:"setFunction",value:function(t,e){return this.functions[t]=e,this}},{key:"getFunction",value:function(t){return this.functions[t]}},{key:"_callFunction",value:function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.getFunction(t);return n&&(e=n(r)),this.emit("callFunction",t,r,(function(t){void 0!==t&&(e=t)})),void 0===e?no(t,r):e}},{key:"_callCellValue",value:function(t){var e=Wo(Yo(t=t.toUpperCase()),2),r=e[0],n=e[1],o=void 0;return this.emit("callCellValue",{label:t,row:r,column:n},(function(t){o=t})),o}},{key:"_callRangeValue",value:function(t,e){t=t.toUpperCase(),e=e.toUpperCase();var r=Wo(Yo(t),2),n=r[0],o=r[1],i=Wo(Yo(e),2),a=i[0],u=i[1],l={},c={};n.index<=a.index?(l.row=n,c.row=a):(l.row=a,c.row=n),o.index<=u.index?(l.column=o,c.column=u):(l.column=u,c.column=o),l.label=zo(l.row,l.column),c.label=zo(c.row,c.column);var s=[];return this.emit("callRangeValue",l,c,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];s=t})),s}},{key:"_throwError",value:function(t){if(function(t){var e=!1;for(var r in _n)if(Object.prototype.hasOwnProperty.call(_n,r)&&_n[r]===t){e=!0;break}return e}(t))throw Error(t);throw Error("ERROR")}}])&&Ko(e.prototype,r),n&&Ko(e,n),i}(jn);function ri(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ni(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ni(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ni(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var oi=function(t,e,r){if(null!=t&&t.length){try{return t.replaceAll(" ","").replace(/\$?[A-Za-z]+\$?[1-9][0-9]*:\$?[A-Za-z]+\$?[1-9][0-9]*/gi,(function(t){var e=function(t){if(t.length){var e,r=null==t||null===(e=t.toUpperCase())||void 0===e?void 0:e.split(":");if(2===r.length){for(var n=ri(b(r[1]),2),o=n[0],i=n[1],a=ri(b(r[0]),2),u=a[0],l=a[1],c=[],s=u;s<=o;s+=1)for(var f=l;f<=i;f+=1)c.push(m(s,f));return null==c?void 0:c.join(",")}}return""}(t);if(null!=e&&e.length)return e})).replace(/\b[A-Za-z]+[1-9][0-9]*\b/g,(function(t){var n=ri(b(t),2),o=n[0],i=n[1],a=e(o,i);return a?a.startsWith("=")?r(a,[],e):a:0}))}catch(e){return t}}return t},ii=function t(e,r,n){if("="===e[0]){var o=e.substring(1);try{var i,a=new ei,u=oi(o,n,t),l=a.parse(u);return null!==(i=null==l?void 0:l.error)&&void 0!==i?i:null==l?void 0:l.result}catch(t){return"#Error"}}return e},ai=Gn.map((function(t){return{key:t,title:t,render:function(){return""}}})),ui=ai,li={};function ci(t){return function(t){if(Array.isArray(t))return hi(t)}(t)||pi(t)||fi(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function si(t){return function(t){if(Array.isArray(t))return t}(t)||pi(t)||fi(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fi(t,e){if(t){if("string"==typeof t)return hi(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hi(t,e):void 0}}function hi(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function pi(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}ai.forEach((function(t){li[t.key]=t}));var yi=function(t){return t},vi=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=si(Number(t).toFixed(2).toString().split("\\.")),r=e[0],n=e.slice(1);return[r.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(ci(n))}return t},bi=[{key:"normal",title:At("format.normal"),type:"string",render:yi},{key:"text",title:At("format.text"),type:"string",render:yi},{key:"number",title:At("format.number"),type:"number",label:"1,000.12",render:vi},{key:"percent",title:At("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:At("format.rmb"),type:"number",label:"10.00",render:function(t){return"".concat(vi(t))}},{key:"usd",title:At("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(vi(t))}},{key:"eur",title:At("format.eur"),type:"number",label:"10.00",render:function(t){return"".concat(vi(t))}},{key:"date",title:At("format.date"),type:"date",label:"26/09/2008",render:yi},{key:"time",title:At("format.time"),type:"date",label:"15:59:00",render:yi},{key:"datetime",title:At("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:yi},{key:"duration",title:At("format.duration"),type:"date",label:"24:01:00",render:yi}],mi={};function di(t){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return wi(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wi(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wi(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ei(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Si(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Oi(n.key),n)}}function Oi(t){var e=function(t,e){if("object"!=di(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=di(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==di(e)?e:e+""}bi.forEach((function(t){mi[t.key]=t}));var Ni={fillStyle:"#f4f5f8"},Ii={fillStyle:"#fff",lineWidth:Sn,strokeStyle:"#e6e6e6"};function Ai(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=t.cellRect(e,r),i=o.left,a=o.top,u=o.width,l=o.height;return new In(i,a+n,u,l,5)}function Ti(t,e,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=e.sortedRowMap,a=e.rows,u=e.cols;if(!a.isHide(r)&&!u.isHide(n)){var l=r;i.has(r)&&(l=i.get(r));var c=e.getCell(l,n);if(null!==c){var s=!1;"editable"in c&&!1===c.editable&&(s=!0);var f=e.getCellStyleOrDefault(l,n),h=Ai(e,r,n,o);h.bgcolor=f.bgcolor,void 0!==f.border&&(h.setBorders(f.border),t.strokeBorders(h)),t.rect(h,(function(){var o="";o=e.settings.evalPaused?c.text||"":ii(c.text||"",li,(function(t,r){return e.getCellTextOrDefault(r,t)})),f.format&&(o=mi[f.format].render(o));var i=Object.assign({},f.font);i.size=kn(i.size),t.text(o,h,{align:f.align,valign:f.valign,font:i,color:f.color,strike:f.strike,underline:f.underline},f.textwrap,{data:e,rindex:r,cindex:n}),e.validations.getError(r,n)&&t.error(h),s&&t.frozen(h)}))}}}function Pi(t){var e=this.data,r=this.draw;if(t){var n=e.autoFilter;if(!n.active())return;var o=n.hrange();t.intersects(o)&&o.each((function(t,n){var o=Ai(e,t,n);r.dropdown(o)}))}}function Mi(t,e,r,n,o){var i=this.draw,a=this.data;i.save(),i.translate(e,r).translate(n,o);var u=a.exceptRowSet,l=a.exceptRowTotalHeight(t.sri,t.eri);i.save(),i.translate(0,-l),t.each((function(t,e){Ti(i,a,t,e)}),(function(t){return function(t){var e=u.has(t);if(e){var r=a.rows.getHeight(t);i.translate(0,-r)}return!e}(t)})),i.restore();var c=new Set;i.save(),i.translate(0,-l),a.eachMergesInView(t,(function(t){var e=t.sri,r=t.sci,n=t.eri;if(u.has(e)){if(!c.has(e)){c.add(e);var o=a.rows.sumHeight(e,n+1);i.translate(0,-o)}}else Ti(i,a,e,r)})),i.restore(),Pi.call(this,t),i.restore()}function ki(t,e,r,n){var o=this.draw;o.save(),o.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(t,e,r,n),o.restore()}function Ri(t,e,r,n,o,i){var a=this,u=this.draw,l=this.data,c=e.h,s=e.w,f=i+n,h=o+r;u.save(),u.attr(Ni),"all"!==t&&"left"!==t||u.fillRect(0,f,r,c),"all"!==t&&"top"!==t||u.fillRect(h,0,s,n);var p=l.selector.range,v=p.sri,b=p.sci,m=p.eri,d=p.eci;u.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(On(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:Sn(),strokeStyle:"#e6e6e6"}),"all"!==t&&"left"!==t||(l.rowEach(e.sri,e.eri,(function(t,e,n){var o=f+e,i=t;u.line([0,o],[r,o]),v<=i&&i<m+1&&ki.call(a,0,o,r,n),u.fillText(i+1,r/2,o+n/2),t>0&&l.rows.isHide(t-1)&&(u.save(),u.attr({strokeStyle:"#c6c6c6"}),u.line([5,o+5],[r-5,o+5]),u.restore())})),u.line([0,c+f],[r,c+f]),u.line([r,f],[r,c+f])),"all"!==t&&"top"!==t||(l.colEach(e.sci,e.eci,(function(t,e,r){var o=h+e,i=t;u.line([o,0],[o,n]),b<=i&&i<d+1&&ki.call(a,o,0,r,n),u.fillText(y(i),o+r/2,n/2),t>0&&l.cols.isHide(t-1)&&(u.save(),u.attr({strokeStyle:"#c6c6c6"}),u.line([o+5,5],[o+5,n-5]),u.restore())})),u.line([s+h,0],[s+h,n]),u.line([0,n],[s+h,n])),u.restore()}function ji(t,e){var r=this.draw;r.save(),r.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),r.restore()}function Ci(t,e,r,n,o){var i=t.sri,a=t.sci,u=t.eri,l=t.eci,c=t.w,s=t.h,f=this.gridStatus,h=this.draw,p=this.data,y=p.settings;h.save(),h.attr(Ii).translate(e+n,r+o),y.showGrid&&f?(p.rowEach(i,u,(function(t,e,r){t!==i&&h.line([0,e],[c,e]),t===u&&h.line([0,e+r],[c,e+r])})),p.colEach(a,l,(function(t,e,r){t!==a&&h.line([e,0],[e,s]),t===l&&h.line([e+r,0],[e+r,s])})),h.restore()):h.restore()}function xi(t,e,r,n){var o=this.draw,i=this.data,a=i.viewWidth()-t,u=i.viewHeight()-e;o.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),o.line([0,n],[a,n]),o.line([r,0],[r,u]),o.restore()}var Di=function(){return t=function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Ei(this,t),this.options=n,this.el=e,this.draw=new Tn(e,r.viewWidth(),r.viewHeight(),n),this.data=r,this.gridStatus=n.initialGridStatus},(e=[{key:"getGridStatus",value:function(){return this.gridStatus}},{key:"setGridStatus",value:function(t){this.gridStatus=t,this.render()}},{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data,e=t.rows,r=t.cols.indexWidth,n=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var o=t.viewRange(),i=t.freezeTotalWidth(),a=t.freezeTotalHeight(),u=t.scroll,l=u.x,c=u.y;Ci.call(this,o,r,n,i,a),Mi.call(this,o,r,n,-l,-c),Ri.call(this,"all",o,r,n,i,a),ji.call(this,r,n);var s=gi(t.freeze,2),f=s[0],h=s[1];if(f>0||h>0){if(f>0){var p=o.clone();p.sri=0,p.eri=f-1,p.h=a,Ci.call(this,p,r,n,i,0),Mi.call(this,p,r,n,-l,0),Ri.call(this,"top",p,r,n,i,0)}if(h>0){var y=o.clone();y.sci=0,y.eci=h-1,y.w=i,Ci.call(this,y,r,n,0,a),Ri.call(this,"left",y,r,n,0,a),Mi.call(this,y,r,n,0,-c)}var v=t.freezeViewRange();Ci.call(this,v,r,n,0,0),Ri.call(this,"all",v,r,n,0,0),Mi.call(this,v,r,n,0,0),xi.call(this,r,n,i,a)}}},{key:"clear",value:function(){this.draw.clear()}}])&&Si(t.prototype,e),r&&Si(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function _i(t){return(_i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Li(t){return function(t){if(Array.isArray(t))return Ui(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ui(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ui(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ui(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Fi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vi(n.key),n)}}function Vi(t){var e=function(t,e){if("object"!=_i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_i(e)?e:e+""}var Bi=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],Hi=["landscape","portrait"];function Gi(t){return parseInt(96*t,10)}function qi(t){"cancel"===t?this.el.hide():this.toPrint()}function Yi(t){var e=this.paper,r=t.target.value,n=Bi[r];e.w=Gi(n[1]),e.h=Gi(n[2]),this.preview()}function zi(t){var e=this.paper,r=t.target.value,n=Hi[r];e.orientation=n,this.preview()}var Xi=function(){return t=function t(e){var r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paper={w:Gi(Bi[0][1]),h:Gi(Bi[0][2]),padding:50,orientation:Hi[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=s("div","".concat(Pe,"-print")).children(s("div","".concat(Pe,"-print-bar")).children(s("div","-title").child("Print settings"),s("div","-right").children(s("div","".concat(Pe,"-buttons")).children(new ln("cancel").on("click",qi.bind(this,"cancel")),new ln("next","primary").on("click",qi.bind(this,"next"))))),s("div","".concat(Pe,"-print-content")).children(this.contentEl=s("div","-content"),s("div","-sider").child(s("form","").children(s("fieldset","").children(s("label","").child("".concat(It("print.size"))),(r=s("select","")).children.apply(r,Li(Bi.map((function(t,e){return s("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))})))).on("change",Yi.bind(this))),s("fieldset","").children(s("label","").child("".concat(It("print.orientation"))),(n=s("select","")).children.apply(n,Li(Hi.map((function(t,e){return s("option","").attr("value",e).child("".concat(It("print.orientations")[e]))})))).on("change",zi.bind(this))))))).hide()},(e=[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,r=this.paper,n=r.width,o=r.height,i=r.padding,a=n-2*i,u=o-2*i,l=e.contentRange(),c=parseInt(l.h/u,10)+1,f=a/l.w,h=i,p=i;f>1&&(h+=(a-l.w)/2);var y=0,v=0;this.contentEl.html(""),this.canvases=[];for(var b={sri:0,sci:0,eri:0,eci:0},m=function(){var r=0,i=0,a=s("div","".concat(Pe,"-canvas-card")),c=s("canvas","".concat(Pe,"-canvas"));t.canvases.push(c.el);var m=new Tn(c.el,n,o);for(m.save(),m.translate(h,p),f<1&&m.scale(f,f);y<=l.eri;y+=1){var d=e.rows.getHeight(y);if(!((r+=d)<u)){i=-(r-d);break}for(var g=0;g<=l.eci;g+=1)Ti(m,e,y,g,v),b.eci=g}b.eri=y,m.restore(),m.save(),m.translate(h,p),f<1&&m.scale(f,f);var w=v;e.eachMergesInView(b,(function(t){var r=t.sri,n=t.sci;Ti(m,e,r,n,w)})),m.restore(),b.sri=b.eri,b.sci=b.eci,v+=i,t.contentEl.child(s("div","".concat(Pe,"-canvas-card-wraper")).child(a.child(c)))},d=0;d<c;d+=1)m();this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=s("iframe","").hide().el;window.document.body.appendChild(e);var r=e.contentWindow,n=r.document,o=document.createElement("style");o.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),n.head.appendChild(o),this.canvases.forEach((function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),n.body.appendChild(e)})),r.print()}}])&&Fi(t.prototype,e),r&&Fi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Wi(t){return(Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $i(t){return function(t){if(Array.isArray(t))return Ki(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ki(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ki(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ki(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Qi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ji(n.key),n)}}function Ji(t){var e=function(t,e){if("object"!=Wi(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Wi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Wi(e)?e:e+""}var ta=[{key:"copy",title:At("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:At("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:At("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:At("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:At("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:At("contextmenu.insertRow")},{key:"insert-column",title:At("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:At("contextmenu.deleteRow")},{key:"delete-column",title:At("contextmenu.deleteColumn")},{key:"delete-cell-text",title:At("contextmenu.deleteCellText")},{key:"hide",title:At("contextmenu.hide")},{key:"divider"},{key:"validation",title:At("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:At("contextmenu.cellprintable")},{key:"cell-non-printable",title:At("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:At("contextmenu.celleditable")},{key:"cell-non-editable",title:At("contextmenu.cellnoneditable")}];function ea(t){var e=this;return"divider"===t.key?s("div","".concat(Pe,"-item divider")):s("div","".concat(Pe,"-item")).on("click",(function(){e.itemClick(t.key),e.hide()})).children(t.title(),s("div","label").child(t.label||""))}function ra(){var t=this;return ta.map((function(e){return ea.call(t,e)}))}var na=function(){return t=function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Qi(this,t),this.menuItems=ra.call(this),this.el=(r=s("div","".concat(Pe,"-contextmenu"))).children.apply(r,$i(this.menuItems)).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=n,this.setMode("range")},(e=[{key:"setMode",value:function(t){var e=this.menuItems[12];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){var t=this.el;t.hide(),Oe(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var r=this.el,n=r.show().offset().width,o=this.viewFn(),i=o.height/2,a=t;o.width-t<=n&&(a-=n),r.css("left","".concat(a,"px")),e>i?r.css("bottom","".concat(o.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):r.css("top","".concat(e,"px")).css("max-height","".concat(o.height-e,"px")).css("bottom","auto"),Ne(r)}}}])&&Zi(t.prototype,e),r&&Zi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function oa(t){return(oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ia(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aa(n.key),n)}}function aa(t){var e=function(t,e){if("object"!=oa(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=oa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==oa(e)?e:e+""}var ua=function(){return t=function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip="",e&&(this.tip=It("toolbar.".concat(e.replace(/-[a-z]/g,(function(t){return t[1].toUpperCase()}))))),r&&(this.tip+=" (".concat(r,")")),this.tag=e,this.shortcut=r,this.value=n,this.el=this.element(),this.change=function(){}},(e=[{key:"element",value:function(){var t=this,e=this.tip;return s("div","".concat(Pe,"-toolbar-btn")).on("mouseenter",(function(e){t.tip&&function(t,e){if(!e.classList.contains("active")){var r=e.getBoundingClientRect(),n=r.left,o=r.top,i=r.width,a=r.height,u=s("div","".concat(Pe,"-tooltip")).html(t).show();document.body.appendChild(u.el);var l=u.box();u.css("left","".concat(n+i/2-l.width/2,"px")).css("top","".concat(o+a+2,"px")),Ee(e,"mouseleave",(function(){document.body.contains(u.el)&&document.body.removeChild(u.el)})),Ee(e,"click",(function(){document.body.contains(u.el)&&document.body.removeChild(u.el)}))}}(t.tip,e.target)})).attr("data-tooltip",e)}},{key:"setState",value:function(){}}])&&ia(t.prototype,e),r&&ia(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function la(t){return(la="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ca(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sa(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fa(n.key),n)}}function fa(t){var e=function(t,e){if("object"!=la(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=la(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==la(e)?e:e+""}function ha(t,e,r){return e=va(e),function(t,e){if(e&&("object"==la(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],va(t).constructor):e.apply(t,r))}function pa(){return(pa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=ya(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(null,arguments)}function ya(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=va(t)););return t}function va(t){return(va=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ba(t,e){return(ba=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ma=function(t){function e(){return ca(this,e),ha(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ba(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,r=this.tag;return this.dd=this.dropdown(),this.dd.change=function(e){return t.change(r,t.getValue(e))},pa(va(e.prototype),"element",this).call(this).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}])&&sa(r.prototype,n),o&&sa(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ua);function da(t){return(da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ga(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wa(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ea(n.key),n)}}function Ea(t){var e=function(t,e){if("object"!=da(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=da(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==da(e)?e:e+""}function Sa(t,e,r){return e=Oa(e),function(t,e){if(e&&("object"==da(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Oa(t).constructor):e.apply(t,r))}function Oa(t){return(Oa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Na(t,e){return(Na=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ia=function(t){function e(t,r,n,o){var i,a;ga(this,e),(a=Sa(this,e,["div","".concat(Pe,"-dropdown ").concat(o)])).title=t,a.change=function(){},a.headerClick=function(){},"string"==typeof t?a.title=s("div","".concat(Pe,"-dropdown-title")).child(t):n&&a.title.addClass("arrow-left"),a.contentEl=s("div","".concat(Pe,"-dropdown-content")).css("width",r).css("max-height","400px").css("overflow-y","auto").hide();for(var u=arguments.length,l=new Array(u>4?u-4:0),c=4;c<u;c++)l[c-4]=arguments[c];return(i=a).setContentChildren.apply(i,l),a.headerEl=s("div","".concat(Pe,"-dropdown-header")),a.headerEl.on("click",(function(){"block"!==a.contentEl.css("display")?a.show():a.hide()})).children(a.title,n?s("div","".concat(Pe,"-icon arrow-right")).child(s("div","".concat(Pe,"-icon-img arrow-down"))):""),a.children(a.headerEl,a.contentEl),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Na(t,e)}(e,t),r=e,(n=[{key:"setContentChildren",value:function(){var t;this.contentEl.html(""),arguments.length>0&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),Ne(this.parent(),(function(){t.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),Oe(this.parent())}}])&&wa(r.prototype,n),o&&wa(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(c);function Aa(t){return(Aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ta(t){return function(t){if(Array.isArray(t))return Pa(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Pa(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pa(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pa(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ma(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ka(n.key),n)}}function ka(t){var e=function(t,e){if("object"!=Aa(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Aa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Aa(e)?e:e+""}function Ra(t,e,r){return e=ja(e),function(t,e){if(e&&("object"==Aa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],ja(t).constructor):e.apply(t,r))}function ja(t){return(ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ca(t,e){return(Ca=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var xa=function(t){function e(t,r){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=new Sr("align-".concat(r)),i=t.map((function(t){return(e="align-".concat(t),s("div","".concat(Pe,"-item")).child(new Sr(e))).on("click",(function(){n.setTitle(t),n.change(t)}));var e}));return n=Ra(this,e,[o,"auto",!0,"bottom-left"].concat(Ta(i)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ca(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&Ma(r.prototype,n),o&&Ma(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Ia);function Da(t){return(Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,La(n.key),n)}}function La(t){var e=function(t,e){if("object"!=Da(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Da(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Da(e)?e:e+""}function Ua(t,e,r){return e=Fa(e),function(t,e){if(e&&("object"==Da(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Fa(t).constructor):e.apply(t,r))}function Fa(t){return(Fa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Va(t,e){return(Va=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ba=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ua(this,e,["align","",t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Va(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){var t=this.value;return new xa(["left","center","right"],t)}}])&&_a(r.prototype,n),o&&_a(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ma);function Ha(t){return(Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ga(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qa(n.key),n)}}function qa(t){var e=function(t,e){if("object"!=Ha(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ha(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ha(e)?e:e+""}function Ya(t,e,r){return e=za(e),function(t,e){if(e&&("object"==Ha(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],za(t).constructor):e.apply(t,r))}function za(t){return(za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xa(t,e){return(Xa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Wa=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ya(this,e,["valign","",t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xa(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){var t=this.value;return new xa(["top","middle","bottom"],t)}}])&&Ga(r.prototype,n),o&&Ga(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ma);function $a(t){return($a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ka(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qa(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Za(n.key),n)}}function Za(t){var e=function(t,e){if("object"!=$a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=$a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==$a(e)?e:e+""}function Ja(t,e,r){return e=ru(e),function(t,e){if(e&&("object"==$a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],ru(t).constructor):e.apply(t,r))}function tu(){return(tu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=eu(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(null,arguments)}function eu(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=ru(t)););return t}function ru(t){return(ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nu(t,e){return(nu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ou=function(t){function e(){return Ka(this,e),Ja(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nu(t,e)}(e,t),r=e,(n=[{key:"element",value:function(){var t=this,r=this.tag;return tu(ru(e.prototype),"element",this).call(this).child(new Sr(r)).on("click",(function(){return t.click()}))}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}])&&Qa(r.prototype,n),o&&Qa(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ua);function iu(t){return(iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function au(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uu(n.key),n)}}function uu(t){var e=function(t,e){if("object"!=iu(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=iu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==iu(e)?e:e+""}function lu(t,e,r){return e=cu(e),function(t,e){if(e&&("object"==iu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],cu(t).constructor):e.apply(t,r))}function cu(t){return(cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function su(t,e){return(su=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var fu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),lu(this,e,["autofilter"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&su(t,e)}(e,t),r=e,(n=[{key:"setState",value:function(){}}])&&au(r.prototype,n),o&&au(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ou);function hu(t){return(hu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yu(n.key),n)}}function yu(t){var e=function(t,e){if("object"!=hu(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=hu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==hu(e)?e:e+""}function vu(t,e,r){return e=bu(e),function(t,e){if(e&&("object"==hu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],bu(t).constructor):e.apply(t,r))}function bu(t){return(bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mu(t,e){return(mu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var du=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),vu(this,e,["font-bold","Ctrl+B"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mu(t,e)}(e,t),r=e,n&&pu(r.prototype,n),o&&pu(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ou);function gu(t){return(gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Eu(n.key),n)}}function Eu(t){var e=function(t,e){if("object"!=gu(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=gu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==gu(e)?e:e+""}function Su(t,e,r){return e=Iu(e),function(t,e){if(e&&("object"==gu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Iu(t).constructor):e.apply(t,r))}function Ou(){return(Ou="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=Nu(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(null,arguments)}function Nu(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Iu(t)););return t}function Iu(t){return(Iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Au(t,e){return(Au=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Tu=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Su(this,e,["grid",null,t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Au(t,e)}(e,t),r=e,(n=[{key:"setClickCallback",value:function(t){this.callBack=t}},{key:"click",value:function(){var t;Ou(Iu(e.prototype),"click",this).call(this),null===(t=this.callBack)||void 0===t||t.call(this,this.active())}},{key:"active",value:function(){return this.el.hasClass("active")}}])&&wu(r.prototype,n),o&&wu(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ou);function Pu(t){return(Pu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ku(n.key),n)}}function ku(t){var e=function(t,e){if("object"!=Pu(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Pu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Pu(e)?e:e+""}function Ru(t,e,r){return e=ju(e),function(t,e){if(e&&("object"==Pu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],ju(t).constructor):e.apply(t,r))}function ju(t){return(ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cu(t,e){return(Cu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var xu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ru(this,e,["font-italic","Ctrl+I"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cu(t,e)}(e,t),r=e,n&&Mu(r.prototype,n),o&&Mu(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ou);function Du(t){return(Du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lu(n.key),n)}}function Lu(t){var e=function(t,e){if("object"!=Du(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Du(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Du(e)?e:e+""}function Uu(t,e,r){return e=Fu(e),function(t,e){if(e&&("object"==Du(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Fu(t).constructor):e.apply(t,r))}function Fu(t){return(Fu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vu(t,e){return(Vu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Bu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Uu(this,e,["strike","Ctrl+U"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vu(t,e)}(e,t),r=e,n&&_u(r.prototype,n),o&&_u(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ou);function Hu(t){return(Hu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qu(n.key),n)}}function qu(t){var e=function(t,e){if("object"!=Hu(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Hu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Hu(e)?e:e+""}function Yu(t,e,r){return e=zu(e),function(t,e){if(e&&("object"==Hu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],zu(t).constructor):e.apply(t,r))}function zu(t){return(zu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xu(t,e){return(Xu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Wu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Yu(this,e,["underline","Ctrl+U"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xu(t,e)}(e,t),r=e,n&&Gu(r.prototype,n),o&&Gu(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ou);function $u(t){return($u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ku(t){return function(t){if(Array.isArray(t))return Qu(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Qu(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qu(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qu(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Zu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tl(n.key),n)}}function Ju(t,e,r){return e&&Zu(t.prototype,e),r&&Zu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function tl(t){var e=function(t,e){if("object"!=$u(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=$u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==$u(e)?e:e+""}var el=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],rl=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],nl=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function ol(t){var e=this;return s("td","").child(s("div","".concat(Pe,"-color-palette-cell")).on("click.stop",(function(){return e.change(t)})).css("background-color",t))}var il=Ju((function t(){var e,r,n,o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=s("div","".concat(Pe,"-color-palette")),this.change=function(){};var i=s("table","").children((e=s("tbody","")).children.apply(e,[(r=s("tr","".concat(Pe,"-theme-color-placeholders"))).children.apply(r,Ku(el.map((function(t){return ol.call(o,t)}))))].concat(Ku(rl.map((function(t){var e;return(e=s("tr","".concat(Pe,"-theme-colors"))).children.apply(e,Ku(t.map((function(t){return ol.call(o,t)}))))}))),[(n=s("tr","".concat(Pe,"-standard-colors"))).children.apply(n,Ku(nl.map((function(t){return ol.call(o,t)}))))])));this.el.child(i)}));function al(t){return(al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ul(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ll(n.key),n)}}function ll(t){var e=function(t,e){if("object"!=al(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=al(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==al(e)?e:e+""}function cl(t,e,r){return e=sl(e),function(t,e){if(e&&("object"==al(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],sl(t).constructor):e.apply(t,r))}function sl(t){return(sl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fl(t,e){return(fl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var hl=function(t){function e(t,r){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=new Sr(t).css("height","16px").css("border-bottom","3px solid ".concat(r)),i=new il;return i.change=function(t){n.setTitle(t),n.change(t)},n=cl(this,e,[o,"auto",!1,"bottom-left",i.el])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fl(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&ul(r.prototype,n),o&&ul(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Ia);function pl(t){return(pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yl(t){return function(t){if(Array.isArray(t))return vl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return vl(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vl(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vl(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function bl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ml(n.key),n)}}function ml(t){var e=function(t,e){if("object"!=pl(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=pl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==pl(e)?e:e+""}function dl(t,e,r){return e=gl(e),function(t,e){if(e&&("object"==pl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],gl(t).constructor):e.apply(t,r))}function gl(t){return(gl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wl(t,e){return(wl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var El=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],Sl=function(t){function e(t){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Sr("line-type"),o=0,i=El.map((function(e,n){return s("div","".concat(Pe,"-item state ").concat(t===e[0]?"checked":"")).on("click",(function(){i[o].toggle("checked"),i[n].toggle("checked"),o=n,r.hide(),r.change(e)})).child(s("div","".concat(Pe,"-line-type")).html(e[1]))}));return r=dl(this,e,[n,"auto",!1,"bottom-left"].concat(yl(i)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wl(t,e)}(e,t),r=e,n&&bl(r.prototype,n),o&&bl(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Ia);function Ol(t){return(Ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nl(t){return function(t){if(Array.isArray(t))return Tl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Al(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Il(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||Al(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Al(t,e){if(t){if("string"==typeof t)return Tl(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Tl(t,e):void 0}}function Tl(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Pl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kl(n.key),n)}}function Ml(t,e,r){return e&&Pl(t.prototype,e),r&&Pl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function kl(t){var e=function(t,e){if("object"!=Ol(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ol(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ol(e)?e:e+""}function Rl(){var t;return s("table","").child((t=s("tbody","")).children.apply(t,arguments))}function jl(t){var e=this;return s("td","").child(s("div","".concat(Pe,"-border-palette-cell")).child(new Sr("border-".concat(t))).on("click",(function(){e.mode=t;var r=e.mode,n=e.style,o=e.color;e.change({mode:r,style:n,color:o})})))}var Cl=Ml((function t(){var e,r,n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new hl("line-color",this.color),this.ddColor.change=function(t){n.color=t},this.ddType=new Sl(this.style),this.ddType.change=function(t){var e=Il(t,1)[0];n.style=e},this.el=s("div","".concat(Pe,"-border-palette"));var o=Rl(s("tr","").children(s("td","".concat(Pe,"-border-palette-left")).child(Rl((e=s("tr","")).children.apply(e,Nl(["all","inside","horizontal","vertical","outside"].map((function(t){return jl.call(n,t)})))),(r=s("tr","")).children.apply(r,Nl(["left","top","right","bottom","none"].map((function(t){return jl.call(n,t)})))))),s("td","".concat(Pe,"-border-palette-right")).children(s("div","".concat(Pe,"-toolbar-btn")).child(this.ddColor.el),s("div","".concat(Pe,"-toolbar-btn")).child(this.ddType.el))));this.el.child(o)}));function xl(t){return(xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_l(n.key),n)}}function _l(t){var e=function(t,e){if("object"!=xl(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=xl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==xl(e)?e:e+""}function Ll(t,e,r){return e=Ul(e),function(t,e){if(e&&("object"==xl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Ul(t).constructor):e.apply(t,r))}function Ul(t){return(Ul=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fl(t,e){return(Fl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Vl=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=new Sr("border-all"),n=new Cl;return n.change=function(e){t.change(e),t.hide()},t=Ll(this,e,[r,"auto",!1,"bottom-left",n.el])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fl(t,e)}(e,t),r=e,n&&Dl(r.prototype,n),o&&Dl(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Ia);function Bl(t){return(Bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Gl(n.key),n)}}function Gl(t){var e=function(t,e){if("object"!=Bl(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Bl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Bl(e)?e:e+""}function ql(t,e,r){return e=Yl(e),function(t,e){if(e&&("object"==Bl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Yl(t).constructor):e.apply(t,r))}function Yl(t){return(Yl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zl(t,e){return(zl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Xl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ql(this,e,["border"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zl(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){return new Vl}}])&&Hl(r.prototype,n),o&&Hl(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ma);function Wl(t){return(Wl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Kl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ql(n.key),n)}}function Ql(t){var e=function(t,e){if("object"!=Wl(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Wl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Wl(e)?e:e+""}function Zl(t,e,r){return e=ec(e),function(t,e){if(e&&("object"==Wl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],ec(t).constructor):e.apply(t,r))}function Jl(){return(Jl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=tc(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}}).apply(null,arguments)}function tc(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=ec(t)););return t}function ec(t){return(ec=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rc(t,e){return(rc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var nc=function(t){function e(){return $l(this,e),Zl(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rc(t,e)}(e,t),r=e,(n=[{key:"element",value:function(){var t=this;return Jl(ec(e.prototype),"element",this).call(this).child(new Sr(this.tag)).on("click",(function(){return t.change(t.tag)}))}},{key:"setState",value:function(t){this.el.disabled(t)}}])&&Kl(r.prototype,n),o&&Kl(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ua);function oc(t){return(oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ic(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ac(n.key),n)}}function ac(t){var e=function(t,e){if("object"!=oc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=oc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==oc(e)?e:e+""}function uc(t,e,r){return e=lc(e),function(t,e){if(e&&("object"==oc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],lc(t).constructor):e.apply(t,r))}function lc(t){return(lc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cc(t,e){return(cc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var sc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),uc(this,e,["clearformat"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cc(t,e)}(e,t),r=e,n&&ic(r.prototype,n),o&&ic(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(nc);function fc(t){return(fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pc(n.key),n)}}function pc(t){var e=function(t,e){if("object"!=fc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=fc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==fc(e)?e:e+""}function yc(t,e,r){return e=vc(e),function(t,e){if(e&&("object"==fc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],vc(t).constructor):e.apply(t,r))}function vc(t){return(vc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bc(t,e){return(bc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var mc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),yc(this,e,["paintformat"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bc(t,e)}(e,t),r=e,(n=[{key:"setState",value:function(){}}])&&hc(r.prototype,n),o&&hc(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ou);function dc(t){return(dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wc(n.key),n)}}function wc(t){var e=function(t,e){if("object"!=dc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=dc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==dc(e)?e:e+""}function Ec(t,e,r){return e=Sc(e),function(t,e){if(e&&("object"==dc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Sc(t).constructor):e.apply(t,r))}function Sc(t){return(Sc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oc(t,e){return(Oc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Nc=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ec(this,e,["color",void 0,t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Oc(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new hl(t,e)}}])&&gc(r.prototype,n),o&&gc(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ma);function Ic(t){return(Ic="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ac(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tc(n.key),n)}}function Tc(t){var e=function(t,e){if("object"!=Ic(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ic(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ic(e)?e:e+""}function Pc(t,e,r){return e=Mc(e),function(t,e){if(e&&("object"==Ic(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Mc(t).constructor):e.apply(t,r))}function Mc(t){return(Mc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kc(t,e){return(kc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Rc=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Pc(this,e,["bgcolor",void 0,t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kc(t,e)}(e,t),r=e,(n=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new hl(t,e)}}])&&Ac(r.prototype,n),o&&Ac(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ma);function jc(t){return(jc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cc(t){return function(t){if(Array.isArray(t))return xc(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return xc(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xc(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xc(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Dc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_c(n.key),n)}}function _c(t){var e=function(t,e){if("object"!=jc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=jc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==jc(e)?e:e+""}function Lc(t,e,r){return e=Uc(e),function(t,e){if(e&&("object"==jc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Uc(t).constructor):e.apply(t,r))}function Uc(t){return(Uc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fc(t,e){return(Fc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Vc=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Mn.map((function(e){return s("div","".concat(Pe,"-item")).on("click",(function(){t.setTitle("".concat(e.pt)),t.change(e)})).child("".concat(e.pt))}));return t=Lc(this,e,["10","60px",!0,"bottom-left"].concat(Cc(r)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fc(t,e)}(e,t),r=e,n&&Dc(r.prototype,n),o&&Dc(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Ia);function Bc(t){return(Bc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Gc(n.key),n)}}function Gc(t){var e=function(t,e){if("object"!=Bc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Bc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Bc(e)?e:e+""}function qc(t,e,r){return e=Yc(e),function(t,e){if(e&&("object"==Bc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Yc(t).constructor):e.apply(t,r))}function Yc(t){return(Yc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zc(t,e){return(zc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Xc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),qc(this,e,["font-size"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zc(t,e)}(e,t),r=e,(n=[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new Vc}}])&&Hc(r.prototype,n),o&&Hc(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ma);function Wc(t){return(Wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $c(t){return function(t){if(Array.isArray(t))return Kc(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Kc(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kc(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kc(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Qc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zc(n.key),n)}}function Zc(t){var e=function(t,e){if("object"!=Wc(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Wc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Wc(e)?e:e+""}function Jc(t,e,r){return e=ts(e),function(t,e){if(e&&("object"==Wc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],ts(t).constructor):e.apply(t,r))}function ts(t){return(ts=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function es(t,e){return(es=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var rs=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Pn.map((function(e){return s("div","".concat(Pe,"-item")).on("click",(function(){t.setTitle(e.title),t.change(e)})).child(e.title)}));return t=Jc(this,e,[Pn[0].title,"160px",!0,"bottom-left"].concat($c(r)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&es(t,e)}(e,t),r=e,n&&Qc(r.prototype,n),o&&Qc(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Ia);function ns(t){return(ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function os(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,is(n.key),n)}}function is(t){var e=function(t,e){if("object"!=ns(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ns(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ns(e)?e:e+""}function as(t,e,r){return e=us(e),function(t,e){if(e&&("object"==ns(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],us(t).constructor):e.apply(t,r))}function us(t){return(us=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ls(t,e){return(ls=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var cs=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),as(this,e,["font-name"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ls(t,e)}(e,t),r=e,(n=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new rs}}])&&os(r.prototype,n),o&&os(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ma);function ss(t){return(ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fs(t){return function(t){if(Array.isArray(t))return hs(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return hs(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hs(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hs(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ps(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ys(n.key),n)}}function ys(t){var e=function(t,e){if("object"!=ss(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ss(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ss(e)?e:e+""}function vs(t,e,r){return e=bs(e),function(t,e){if(e&&("object"==ss(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],bs(t).constructor):e.apply(t,r))}function bs(t){return(bs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ms(t,e){return(ms=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ds=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=bi.slice(0);return r.splice(2,0,{key:"divider"}),r.splice(8,0,{key:"divider"}),r=r.map((function(e){var r=s("div","".concat(Pe,"-item"));return"divider"===e.key?r.addClass("divider"):(r.child(e.title()).on("click",(function(){t.setTitle(e.title()),t.change(e)})),e.label&&r.child(s("div","label").html(e.label))),r})),t=vs(this,e,["Normal","220px",!0,"bottom-left"].concat(fs(r)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ms(t,e)}(e,t),r=e,(n=[{key:"setTitle",value:function(t){for(var e=0;e<bi.length;e+=1)bi[e].key===t&&this.title.html(bi[e].title());this.hide()}}])&&ps(r.prototype,n),o&&ps(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Ia);function gs(t){return(gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ws(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Es(n.key),n)}}function Es(t){var e=function(t,e){if("object"!=gs(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=gs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==gs(e)?e:e+""}function Ss(t,e,r){return e=Os(e),function(t,e){if(e&&("object"==gs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Os(t).constructor):e.apply(t,r))}function Os(t){return(Os=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ns(t,e){return(Ns=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Is=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ss(this,e,["format"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ns(t,e)}(e,t),r=e,(n=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new ds}}])&&ws(r.prototype,n),o&&ws(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ma);function As(t){return(As="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ts(t){return function(t){if(Array.isArray(t))return Ps(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ps(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ps(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ps(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ms(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ks(n.key),n)}}function ks(t){var e=function(t,e){if("object"!=As(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=As(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==As(e)?e:e+""}function Rs(t,e,r){return e=js(e),function(t,e){if(e&&("object"==As(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],js(t).constructor):e.apply(t,r))}function js(t){return(js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cs(t,e){return(Cs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var xs=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=ai.map((function(e){return s("div","".concat(Pe,"-item")).on("click",(function(){t.hide(),t.change(e)})).child(e.key)}));return t=Rs(this,e,[new Sr("formula"),"180px",!0,"bottom-left"].concat(Ts(r)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cs(t,e)}(e,t),r=e,n&&Ms(r.prototype,n),o&&Ms(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Ia);function Ds(t){return(Ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ls(n.key),n)}}function Ls(t){var e=function(t,e){if("object"!=Ds(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ds(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ds(e)?e:e+""}function Us(t,e,r){return e=Fs(e),function(t,e){if(e&&("object"==Ds(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Fs(t).constructor):e.apply(t,r))}function Fs(t){return(Fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vs(t,e){return(Vs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Bs=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Us(this,e,["formula"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vs(t,e)}(e,t),r=e,(n=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new xs}}])&&_s(r.prototype,n),o&&_s(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ma);function Hs(t){return(Hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gs(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qs(n.key),n)}}function qs(t){var e=function(t,e){if("object"!=Hs(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Hs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Hs(e)?e:e+""}function Ys(t,e,r){return e=zs(e),function(t,e){if(e&&("object"==Hs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],zs(t).constructor):e.apply(t,r))}function zs(t){return(zs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xs(t,e){return(Xs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ws=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ys(this,e,["freeze"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xs(t,e)}(e,t),r=e,n&&Gs(r.prototype,n),o&&Gs(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ou);function $s(t){return($s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ks(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qs(n.key),n)}}function Qs(t){var e=function(t,e){if("object"!=$s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=$s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==$s(e)?e:e+""}function Zs(t,e,r){return e=Js(e),function(t,e){if(e&&("object"==$s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Js(t).constructor):e.apply(t,r))}function Js(t){return(Js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tf(t,e){return(tf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ef=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Zs(this,e,["merge"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tf(t,e)}(e,t),r=e,(n=[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}])&&Ks(r.prototype,n),o&&Ks(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ou);function rf(t){return(rf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,of(n.key),n)}}function of(t){var e=function(t,e){if("object"!=rf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=rf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==rf(e)?e:e+""}function af(t,e,r){return e=uf(e),function(t,e){if(e&&("object"==rf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],uf(t).constructor):e.apply(t,r))}function uf(t){return(uf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lf(t,e){return(lf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var cf=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),af(this,e,["redo","Ctrl+Y"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lf(t,e)}(e,t),r=e,n&&nf(r.prototype,n),o&&nf(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(nc);function sf(t){return(sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ff(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hf(n.key),n)}}function hf(t){var e=function(t,e){if("object"!=sf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=sf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==sf(e)?e:e+""}function pf(t,e,r){return e=yf(e),function(t,e){if(e&&("object"==sf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],yf(t).constructor):e.apply(t,r))}function yf(t){return(yf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vf(t,e){return(vf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var bf=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),pf(this,e,["undo","Ctrl+Z"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vf(t,e)}(e,t),r=e,n&&ff(r.prototype,n),o&&ff(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(nc);function mf(t){return(mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function df(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gf(n.key),n)}}function gf(t){var e=function(t,e){if("object"!=mf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=mf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==mf(e)?e:e+""}function wf(t,e,r){return e=Ef(e),function(t,e){if(e&&("object"==mf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Ef(t).constructor):e.apply(t,r))}function Ef(t){return(Ef=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sf(t,e){return(Sf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Of=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),wf(this,e,["print","Ctrl+P"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sf(t,e)}(e,t),r=e,n&&df(r.prototype,n),o&&df(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(nc);function Nf(t){return(Nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function If(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Af(n.key),n)}}function Af(t){var e=function(t,e){if("object"!=Nf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Nf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Nf(e)?e:e+""}function Tf(t,e,r){return e=Pf(e),function(t,e){if(e&&("object"==Nf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Pf(t).constructor):e.apply(t,r))}function Pf(t){return(Pf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mf(t,e){return(Mf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var kf=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Tf(this,e,["textwrap"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mf(t,e)}(e,t),r=e,n&&If(r.prototype,n),o&&If(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ou);function Rf(t){return(Rf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xf(n.key),n)}}function Cf(t,e,r){return e&&jf(t.prototype,e),r&&jf(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function xf(t){var e=function(t,e){if("object"!=Rf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Rf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Rf(e)?e:e+""}function Df(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _f(t,e,r){return e=Lf(e),function(t,e){if(e&&("object"==Rf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Lf(t).constructor):e.apply(t,r))}function Lf(t){return(Lf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Uf(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ff(t,e)}function Ff(t,e){return(Ff=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Vf=function(t){function e(){var t;Df(this,e);var r=new Sr("ellipsis"),n=s("div","".concat(Pe,"-toolbar-more"));return(t=_f(this,e,[r,"auto",!1,"bottom-right",n])).moreBtns=n,t.contentEl.css("max-width","420px"),t}return Uf(e,t),Cf(e)}(Ia),Bf=function(t){function e(){var t;return Df(this,e),(t=_f(this,e,["more"])).el.hide(),t}return Uf(e,t),Cf(e,[{key:"dropdown",value:function(){return new Vf}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])}(ma);function Hf(t){return(Hf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qf(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Yf(n.key),n)}}function Yf(t){var e=function(t,e){if("object"!=Hf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Hf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Hf(e)?e:e+""}function zf(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Xf(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Xf(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xf(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Wf(){return s("div","".concat(Pe,"-toolbar-divider"))}function $f(){var t=this;this.btns2=[],this.items.forEach((function(e){if(Array.isArray(e))e.forEach((function(e){var r=e.el,n=r.box(),o=r.computedStyle(),i=o.marginLeft,a=o.marginRight;t.btns2.push([r,n.width+parseInt(i,10)+parseInt(a,10)])}));else{var r=e.box(),n=e.computedStyle(),o=n.marginLeft,i=n.marginRight;t.btns2.push([e,r.width+parseInt(o,10)+parseInt(i,10)])}}))}function Kf(){var t,e,r=this.el,n=this.btns,o=this.moreEl,i=this.btns2,a=o.dd,u=a.moreBtns,l=a.contentEl;r.css("width","".concat(this.widthFn(),"px"));var c=r.box(),s=160,f=12,h=[],p=[];i.forEach((function(t,e){var r=zf(t,2),n=r[0],o=r[1];s+=o,e===i.length-1||s<c.width?h.push(n):(f+=o,p.push(n))})),(t=n.html("")).children.apply(t,h),(e=u.html("")).children.apply(e,p),l.css("width","".concat(f,"px")),p.length>0?o.show():o.hide()}function Qf(t){var e=this,r=new ua;r.el.on("click",(function(){t.onClick&&t.onClick(e.data.getData(),e.data)})),r.tip=t.tip||"";var n=t.el;if(t.icon&&(n=s("img").attr("src",t.icon)),n){var o=s("div","".concat(Pe,"-icon"));o.child(n),r.el.child(o)}return r}var Zf=function(){return t=function t(e,r){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Gf(this,t),this.data=e,this.change=function(){},this.widthFn=r,this.isHide=o;var i=e.defaultStyle();this.items=[[this.undoEl=new bf,this.redoEl=new cf,new Of,this.paintformatEl=new mc,this.clearformatEl=new sc],Wf(),[this.formatEl=new Is],Wf(),[this.fontEl=new cs,this.fontSizeEl=new Xc],Wf(),[this.boldEl=new du,this.italicEl=new xu,this.underlineEl=new Wu,this.strikeEl=new Bu,this.textColorEl=new Nc(i.color)],Wf(),[this.fillColorEl=new Rc(i.bgcolor),this.borderEl=new Xl,this.mergeEl=new ef,this.gridEl=new Tu],Wf(),[this.alignEl=new Ba(i.align),this.valignEl=new Wa(i.valign),this.textwrapEl=new kf],Wf(),[this.freezeEl=new Ws,this.autofilterEl=new fu,this.formulaEl=new Bs]];var a=e.settings.extendToolbar,u=void 0===a?{}:a;if(u.left&&u.left.length>0){this.items.unshift(Wf());var l=u.left.map(Qf.bind(this));this.items.unshift(l)}if(u.right&&u.right.length>0){this.items.push(Wf());var c=u.right.map(Qf.bind(this));this.items.push(c)}this.items.push([this.moreEl=new Bf]),this.el=s("div","".concat(Pe,"-toolbar")),this.btns=s("div","".concat(Pe,"-toolbar-btns")),this.items.forEach((function(t){Array.isArray(t)?t.forEach((function(t){n.btns.child(t.el),t.change=function(){n.change.apply(n,arguments)}})):n.btns.child(t.el)})),this.el.child(this.btns),o?this.el.hide():(this.reset(),setTimeout((function(){$f.call(n),Kf.call(n)}),0),Ee(window,"resize",(function(){Kf.call(n)})))},(e=[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());var r=e.font,n=e.format;this.formatEl.setState(n),this.fontEl.setState(r.name),this.fontSizeEl.setState(r.size),this.boldEl.setState(r.bold),this.italicEl.setState(r.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}])&&qf(t.prototype,e),r&&qf(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Jf(t){return(Jf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function th(t){return function(t){if(Array.isArray(t))return eh(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return eh(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?eh(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eh(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function rh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oh(n.key),n)}}function oh(t){var e=function(t,e){if("object"!=Jf(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Jf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Jf(e)?e:e+""}var ih=function(){return t=function t(e,r){var n,o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";rh(this,t),this.title=e,this.el=s("div","".concat(Pe,"-modal")).css("width",i).children(s("div","".concat(Pe,"-modal-header")).children(new Sr("close").on("click.stop",(function(){return o.hide()})),this.title),(n=s("div","".concat(Pe,"-modal-content"))).children.apply(n,th(r))).hide()},(e=[{key:"show",value:function(){var t=this;this.dimmer=s("div","".concat(Pe,"-dimmer active")),document.body.appendChild(this.dimmer.el);var e=this.el.show().box(),r=e.width,n=e.height,o=document.documentElement,i=o.clientHeight,a=o.clientWidth;this.el.offset({left:(a-r)/2,top:(i-n)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},Ee(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),document.body.removeChild(this.dimmer.el),Se(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&nh(t.prototype,e),r&&nh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function ah(t){return(ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lh(n.key),n)}}function lh(t){var e=function(t,e){if("object"!=ah(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ah(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ah(e)?e:e+""}var ch=function(){return t=function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=s("div","".concat(Pe,"-form-input")),this.input=s("input","").css("width",e).on("input",(function(t){return n.vchange(t)})).attr("placeholder",r),this.el.child(this.input)},(e=[{key:"focus",value:function(){var t=this;setTimeout((function(){t.input.el.focus()}),10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&uh(t.prototype,e),r&&uh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function sh(t){return(sh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ph(n.key),n)}}function ph(t){var e=function(t,e){if("object"!=sh(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=sh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==sh(e)?e:e+""}var yh=function(){return t=function t(e,r,n){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};fh(this,t),this.key=e,this.getTitle=i,this.vchange=function(){},this.el=s("div","".concat(Pe,"-form-select")),this.suggest=new vr(r.map((function(t){return{key:t,title:o.getTitle(t)}})),(function(t){o.itemClick(t.key),a(t.key),o.vchange(t.key)}),n,this.el),this.el.children(this.itemEl=s("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",(function(){return o.show()}))},(e=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}])&&hh(t.prototype,e),r&&hh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function vh(t){return(vh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mh(n.key),n)}}function mh(t){var e=function(t,e){if("object"!=vh(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=vh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==vh(e)?e:e+""}var dh={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},gh=function(){return t=function t(e,r,n,o){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label="",this.rule=r,n&&(this.label=s("label","label").css("width","".concat(o,"px")).html(n)),this.tip=s("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return i.validate()},this.el=s("div","".concat(Pe,"-form-field")).children(this.label,e.el,this.tip)},(e=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,r=this.tip,n=this.el,o=t.val();return e.required&&/^\s*$/.test(o)?(r.html(It("validation.required")),n.addClass("error"),!1):!e.type&&!e.pattern||(e.pattern||dh[e.type]).test(o)?(n.removeClass("error"),!0):(r.html(It("validation.notMatch")),n.addClass("error"),!1)}}])&&bh(t.prototype,e),r&&bh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function wh(t){return(wh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Eh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Sh(n.key),n)}}function Sh(t){var e=function(t,e){if("object"!=wh(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=wh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==wh(e)?e:e+""}function Oh(t,e,r){return e=Nh(e),function(t,e){if(e&&("object"==wh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Nh(t).constructor):e.apply(t,r))}function Nh(t){return(Nh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ih(t,e){return(Ih=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ah=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=new gh(new yh("cell",["cell"],"100%",(function(t){return It("dataValidation.modeType.".concat(t))})),{required:!0},"".concat(It("dataValidation.range"),":"),100),n=new gh(new ch("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),o=new gh(new yh("list",["list","number","date","phone","email"],"100%",(function(t){return It("dataValidation.type.".concat(t))}),(function(e){return t.criteriaSelected(e)})),{required:!0},"".concat(It("dataValidation.criteria"),":"),100),i=new gh(new yh("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(function(t){return It("dataValidation.operator.".concat(t))}),(function(e){return t.criteriaOperatorSelected(e)})),{required:!0}).hide(),a=new gh(new ch("70px","10"),{required:!0}).hide(),u=new gh(new ch("70px","100"),{required:!0,type:"number"}).hide(),l=new gh(new ch("120px","a,b,c"),{required:!0}),c=new gh(new ch("70px","10"),{required:!0,type:"number"}).hide();return(t=Oh(this,e,[It("contextmenu.validation"),[s("div","".concat(Pe,"-form-fields")).children(r.el,n.el),s("div","".concat(Pe,"-form-fields")).children(o.el,i.el,a.el,u.el,c.el,l.el),s("div","".concat(Pe,"-buttons")).children(new ln("cancel").on("click",(function(){return t.btnClick("cancel")})),new ln("remove").on("click",(function(){return t.btnClick("remove")})),new ln("save","primary").on("click",(function(){return t.btnClick("save")})))]])).mf=r,t.rf=n,t.cf=o,t.of=i,t.minvf=a,t.maxvf=u,t.vf=c,t.svf=l,t.change=function(){},t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ih(t,e)}(e,t),r=e,(n=[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",r=this.vf;r.input.hint(e),r.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,r=this.minvf,n=this.maxvf,o=this.vf,i=this.svf;"date"===t||"number"===t?(e.show(),r.rule.type=t,n.rule.type=t,"date"===t?(r.hint("2018-11-12"),n.hint("2019-11-12")):(r.hint("10"),n.hint("100")),r.show(),n.show(),o.hide(),i.hide()):("list"===t?i.show():i.hide(),o.hide(),e.hide(),r.hide(),n.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,r=this.maxvf,n=this.vf;if("be"===t||"nbe"===t)e.show(),r.show(),n.hide();else{var o=this.cf.val();n.rule.type=o,"date"===o?n.hint("2018-11-12"):n.hint("10"),n.show(),e.hide(),r.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],r=0;r<e.length;r+=1){var n=this[e[r]];if(n.isShow()&&!n.validate())return}var o=this.mf.val(),i=this.rf.val(),a=this.cf.val(),u=this.of.val(),l=this.svf.val();"number"!==a&&"date"!==a||(l="be"===u||"nbe"===u?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",o,i,{type:a,operator:u,required:!1,value:l}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,r=this.rf,n=this.cf,o=this.of,i=this.svf,a=this.vf,u=this.minvf,l=this.maxvf,c=t.mode,s=t.ref,f=t.validator||{type:"list"},h=f.type,p=f.operator,y=f.value;e.val(c||"cell"),r.val(s),n.val(h),o.val(p),Array.isArray(y)?(u.val(y[0]),l.val(y[1])):(i.val(y||""),a.val(y||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(p)}this.show()}}])&&Eh(r.prototype,n),o&&Eh(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ih);function Th(t){return(Th="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ph(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mh(n.key),n)}}function Mh(t){var e=function(t,e){if("object"!=Th(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Th(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Th(e)?e:e+""}function kh(t){return s("div","".concat(Pe,"-item ").concat(t))}function Rh(t){var e=this;return kh("state").child(It("sort.".concat(t))).on("click.stop",(function(){return e.itemClick(t)}))}function jh(t){var e=this,r=this.filterbEl,n=this.filterValues;r.html(""),Object.keys(t).forEach((function(o,i){var a=t[o],u=n.includes(o)?"checked":"";r.child(s("div","".concat(Pe,"-item state ").concat(u)).on("click.stop",(function(){return e.filterClick(i,o)})).children(""===o?It("filter.empty"):o,s("div","label").html("(".concat(a,")"))))}))}function Ch(){var t=this.filterhEl,e=this.filterValues,r=this.values;t.html("".concat(e.length," / ").concat(r.length)),t.checked(e.length===r.length)}var xh=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterbEl=s("div","".concat(Pe,"-body")),this.filterhEl=s("div","".concat(Pe,"-header state")).on("click.stop",(function(){return e.filterClick(0,"all")})),this.el=s("div","".concat(Pe,"-sort-filter")).children(this.sortAscEl=Rh.call(this,"asc"),this.sortDescEl=Rh.call(this,"desc"),kh("divider"),s("div","".concat(Pe,"-filter")).children(this.filterhEl,this.filterbEl),s("div","".concat(Pe,"-buttons")).children(new ln("cancel").on("click",(function(){return e.btnClick("cancel")})),new ln("ok","primary").on("click",(function(){return e.btnClick("ok")})))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]},(e=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,r=this.sort,n=this.filterValues;this.ok&&this.ok(e,r,"in",n)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,r=this.sortDescEl;e.checked("asc"===t),r.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var r=this.filterbEl,n=this.filterValues,o=this.values,i=r.children();"all"===e?i.length===n.length?(this.filterValues=[],i.forEach((function(t){return s(t).checked(!1)}))):(this.filterValues=Array.from(o),i.forEach((function(t){return s(t).checked(!0)}))):s(i[t]).toggle("checked")?n.push(e):n.splice(n.findIndex((function(t){return t===e})),1),Ch.call(this)}},{key:"set",value:function(t,e,r,n){this.ci=t;var o=this.sortAscEl,i=this.sortDescEl;null!==n?(this.sort=n.order,o.checked(n.asc()),i.checked(n.desc())):(this.sortDesc=null,o.checked(!1),i.checked(!1)),this.values=Object.keys(e),this.filterValues=r?Array.from(r.value):Object.keys(e),jh.call(this,e,r),Ch.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var r=1;Ne(this.el,(function(){r<=0&&e.hide(),r-=1}))}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),Oe(this.el)}}])&&Ph(t.prototype,e),r&&Ph(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Dh(t,e){var r=s("div","".concat(Pe,"-toast")),n=s("div","".concat(Pe,"-dimmer active"));r.children(s("div","".concat(Pe,"-toast-header")).children(new Sr("close").on("click.stop",(function(){return document.body.removeChild(r.el),void document.body.removeChild(n.el)})),t),s("div","".concat(Pe,"-toast-content")).html(e)),document.body.appendChild(r.el),document.body.appendChild(n.el);var o=r.box(),i=o.width,a=o.height,u=document.documentElement,l=u.clientHeight,c=u.clientWidth;r.offset({left:(c-i)/2,top:(l-a)/3})}function _h(t){return(_h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Uh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fh(n.key),n)}}function Fh(t){var e=function(t,e){if("object"!=_h(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_h(e)?e:e+""}function Vh(){var t=this.table,e=this.toolBar,r=this.data;e.gridEl.setClickCallback((function(e){t.setGridStatus(e),r.sheetConfig.setGrid(e)}))}function Bh(){var t=this.table,e=this.toolBar,r=this.data.sheetConfig;e.gridEl.setState(!(null==r||!r.gridLine)),t.setGridStatus(!(null==r||!r.gridLine))}var Hh=function(){return t=function t(e,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Lh(this,t),this.table=e,this.toolBar=r,this.data=n,this.options=o,Bh.call(this),Vh.call(this)},(e=[{key:"resetState",value:function(t){this.data=t,Bh.call(this),Vh.call(this)}}])&&Uh(t.prototype,e),r&&Uh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Gh(t){return(Gh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zh(n.key),n)}}function zh(t){var e=function(t,e){if("object"!=Gh(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Gh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Gh(e)?e:e+""}function Xh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Wh(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wh(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wh(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function $h(t,e){var r,n=this;return function(){for(var o=n,i=arguments.length,a=new Array(i),u=0;u<i;u++)a[u]=arguments[u];var l=a;r||(r=setTimeout((function(){r=null,t.apply(o,l)}),e))}}function Kh(){var t=this.data,e=this.verticalScrollbar,r=this.horizontalScrollbar,n=t.getSelectedRect(),o=n.l,i=n.t,a=n.left,u=n.top,l=n.width,c=n.height,s=this.getTableOffset();if(Math.abs(a)+l>s.width)r.move({left:o+l-s.width});else{var f=t.freezeTotalWidth();a<f&&r.move({left:o-1-f})}if(Math.abs(u)+c>s.height)e.move({top:i+c-s.height-1});else{var h=t.freezeTotalHeight();u<h&&e.move({top:i-1-h})}}function Qh(t,e,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==r){var i=this.table,a=this.selector,u=this.toolbar,l=this.data,c=this.contextMenu,s=l.getCell(e,r);t?(a.setEnd(e,r,o),this.trigger("cells-selected",s,a.range)):(a.set(e,r,n),this.trigger("cell-selected",s,e,r)),c.setMode(-1===e||-1===r?"row-col":"range"),u.reset(),i.render()}}function Zh(t,e){var r=this.selector,n=this.data,o=n.rows,i=n.cols,a=Xh(r.indexes,2),u=a[0],l=a[1],c=r.range,s=c.eri,f=c.eci;if(t){var h=Xh(r.moveIndexes,2);u=h[0],l=h[1]}"left"===e?l>0&&(l-=1):"right"===e?(f!==l&&(l=f),l<i.len-1&&(l+=1)):"up"===e?u>0&&(u-=1):"down"===e?(s!==u&&(u=s),u<o.len-1&&(u+=1)):"row-first"===e?l=0:"row-last"===e?l=i.len-1:"col-first"===e?u=0:"col-last"===e&&(u=o.len-1),t&&(r.moveIndexes=[u,l]),Qh.call(this,t,u,l),Kh.call(this)}function Jh(t){if(0===t.buttons&&t.target.className!=="".concat(Pe,"-resizer-hover")){var e=t.offsetX,r=t.offsetY,n=this.rowResizer,o=this.colResizer,i=this.tableEl,a=this.data,u=a.rows,l=a.cols;if(e>l.indexWidth&&r>u.height)return n.hide(),void o.hide();var c=i.box(),s=a.getCellRectByXY(t.offsetX,t.offsetY);s.ri>=0&&-1===s.ci?(s.width=l.indexWidth,n.show(s,{width:c.width}),u.isHide(s.ri-1)?n.showUnhide(s.ri):n.hideUnhide()):n.hide(),-1===s.ri&&s.ci>=0?(s.height=u.height,o.show(s,{height:c.height}),l.isHide(s.ci-1)?o.showUnhide(s.ci):o.hideUnhide()):o.hide()}}function tp(t){var e=this.verticalScrollbar,r=this.horizontalScrollbar,n=this.data,o=e.scroll().top,i=r.scroll().left,a=n.rows,u=n.cols,l=t.deltaY,c=t.deltaX,s=function(t,e){var r=t,n=0;do{n=e(r),r+=1}while(n<=0);return n},f=function(t){if(t>0){var r=n.scroll.ri+1;if(r<a.len){var i=s(r,(function(t){return a.getHeight(t)}));e.move({top:o+i-1})}}else{var u=n.scroll.ri-1;if(u>=0){var l=s(u,(function(t){return a.getHeight(t)}));e.move({top:0===u?0:o-l})}}},h=Math.abs(l),p=Math.abs(c),y=Math.max(h,p);/Firefox/i.test(window.navigator.userAgent)&&$h(f(t.detail),50),y===p&&$h(function(t){if(t>0){var e=n.scroll.ci+1;if(e<u.len){var o=s(e,(function(t){return u.getWidth(t)}));r.move({left:i+o-1})}}else{var a=n.scroll.ci-1;if(a>=0){var l=s(a,(function(t){return u.getWidth(t)}));r.move({left:0===a?0:i-l})}}}(c),50),y===h&&$h(f(l),50)}function ep(t,e){var r=this.verticalScrollbar,n=this.horizontalScrollbar,o=r.scroll().top,i=n.scroll().left;"left"===t||"right"===t?n.move({left:i-e}):"up"!==t&&"down"!==t||r.move({top:o-e})}function rp(){var t=this.data,e=this.verticalScrollbar,r=this.getTableOffset().height,n=t.exceptRowTotalHeight(0,-1);e.set(r,t.rows.totalHeight()-n)}function np(){var t=this.data,e=this.horizontalScrollbar,r=this.getTableOffset().width;t&&e.set(r,t.cols.totalWidth())}function op(){var t=this.selector,e=this.data,r=this.editor,n=Xh(e.freeze,2),o=n[0],i=n[1];if(o>0||i>0){var a=e.freezeTotalWidth(),u=e.freezeTotalHeight();r.setFreezeLengths(a,u)}t.resetAreaOffset()}function ip(){var t=this.tableEl,e=this.overlayerEl,r=this.overlayerCEl,n=this.table,o=this.toolbar,i=this.selector,a=this.el,u=this.getTableOffset(),l=this.getRect();t.attr(l),e.offset(l),r.offset(u),a.css("width","".concat(l.width,"px")),rp.call(this),np.call(this),op.call(this),n.render(),o.reset(),i.reset()}function ap(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function up(t){var e=this.data,r=this.selector;"read"!==e.settings.mode&&(e.copy(),e.copyToSystemClipboard(t),r.showClipboard())}function lp(){var t=this.data,e=this.selector;"read"!==t.settings.mode&&(t.cut(),e.showClipboard())}function cp(t,e){var r=this,n=this.data;if("read"!==n.settings.mode)if(n.clipboard.isClear()){n.pasteFromSystemClipboard(e,(function(){return ip.call(r)}),(function(t){r.trigger("pasted-clipboard",t)}))}else if(n.paste(t,(function(t){return Dh("Tip",t)})))ip.call(this);else if(e){var o=e.clipboardData.getData("text/plain");this.data.pasteFromText(o),ip.call(this)}}function sp(){this.data.hideRowsOrCols(),ip.call(this)}function fp(t,e){this.data.unhideRowsOrCols(t,e),ip.call(this)}function hp(){this.data.autofilter(),ip.call(this)}function pp(){var t=this.toolbar;t.paintformatActive()&&(cp.call(this,"format"),ap.call(this),t.paintformatToggle())}function yp(t){var e=this,r=this.selector,n=this.data,o=this.table,i=this.sortFilter,a=t.offsetX,u=t.offsetY,l=t.target.className==="".concat(Pe,"-selector-corner"),c=n.getCellRectByXY(a,u),s=c.left,f=c.top,h=c.width,p=c.height,y=c.ri,v=c.ci,b=n.autoFilter;if(b.includes(y,v)&&s+h-20<a&&f+p-20<u){var m=b.items(v,(function(t,e){return n.rows.getCell(t,e)}));return i.hide(),i.set(v,m,b.getFilter(v),b.getSort(v)),void i.setOffset({left:s,top:f+p+2})}t.shiftKey||(l?r.showAutofill(y,v):Qh.call(this,!1,y,v),Ie(window,(function(t){var o=n.getCellRectByXY(t.offsetX,t.offsetY);y=o.ri,v=o.ci,l?r.showAutofill(y,v):1!==t.buttons||t.shiftKey||Qh.call(e,!0,y,v,!0,!0)}),(function(){l&&r.arange&&"read"!==n.settings.mode&&n.autofill(r.arange,"all",(function(t){return Dh("Tip",t)}))&&o.render(),r.hideAutofill(),pp.call(e)}))),l||1!==t.buttons||t.shiftKey&&Qh.call(this,!0,y,v)}function vp(){var t=this.editor,e=this.data.getSelectedRect(),r=this.getTableOffset(),n="top";e.top>r.height/2&&(n="bottom"),t.setOffset(e,n)}function bp(){var t=this.editor,e=this.data;"read"!==e.settings.mode&&(vp.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),ap.call(this))}function mp(t){var e=this,r=this.data,n=this.table,o=this.selector;r.scrolly(t,(function(){o.resetBRLAreaOffset(),vp.call(e),n.render()}))}function dp(t){var e=this,r=this.data,n=this.table,o=this.selector;r.scrollx(t,(function(){o.resetBRTAreaOffset(),vp.call(e),n.render()}))}function gp(t,e){var r=t.ri,n=this.table,o=this.selector,i=this.data,a=o.range,u=a.sri,l=a.eri;if(r>=u&&r<=l)for(var c=u;c<=l;c+=1)i.rows.setHeight(c,e);else i.rows.setHeight(r,e);n.render(),o.resetAreaOffset(),rp.call(this),vp.call(this)}function wp(t,e){var r=t.ci,n=this.table,o=this.selector,i=this.data,a=o.range,u=a.sci,l=a.eci;if(r>=u&&r<=l)for(var c=u;c<=l;c+=1)i.cols.setWidth(c,e);else i.cols.setWidth(r,e);n.render(),o.resetAreaOffset(),np.call(this),vp.call(this)}function Ep(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",r=this.data,n=this.table;if("read"!==r.settings.mode){r.setSelectedCellText(t,e);var o=r.selector,i=o.ri,a=o.ci;"finished"===e?n.render():this.trigger("cell-edited",t,i,a)}}function Sp(t){var e=this.data;"read"!==e.settings.mode&&("insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),ap.call(this),ip.call(this))}function Op(t,e){var r=this.data;if("undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print.preview();else if("paintformat"===t)!0===e?up.call(this):ap.call(this);else if("clearformat"===t)Sp.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)hp.call(this);else if("freeze"===t)if(e){var n=r.selector,o=n.ri,i=n.ci;this.freeze(o,i)}else this.freeze(0,0);else r.setSelectedCellAttr(t,e),"formula"!==t||r.selector.multiple()||bp.call(this),ip.call(this)}function Np(t,e,r,n){this.data.setAutoFilter(t,e,r,n),ip.call(this)}function Ip(){var t,e,r,n,o,i,a=this,u=this.selector,l=this.overlayerEl,c=this.rowResizer,s=this.colResizer,f=this.verticalScrollbar,h=this.horizontalScrollbar,p=this.editor,y=this.contextMenu,v=this.toolbar,b=this.modalValidation,m=this.sortFilter;l.on("mousemove",(function(t){Jh.call(a,t)})).on("mousedown",(function(t){p.clear(),y.hide(),2===t.buttons?(a.data.xyInSelectedRect(t.offsetX,t.offsetY)||yp.call(a,t),y.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):2===t.detail?bp.call(a):yp.call(a,t)})).on("mousewheel.stop",(function(t){tp.call(a,t)})).on("mouseout",(function(t){var e=t.offsetX;t.offsetY<=0&&s.hide(),e<=0&&c.hide()})),u.inputChange=function(t){Ep.call(a,t,"input"),bp.call(a)},t=l.el,r=(e={move:function(t,e){ep.call(a,t,e)}}).move,n=e.end,o=0,i=0,Ee(t,"touchstart",(function(t){var e=t.touches[0],r=e.pageX,n=e.pageY;o=r,i=n})),Ee(t,"touchmove",(function(t){if(r){var e=t.changedTouches[0],n=e.pageX,a=e.pageY,u=n-o,l=a-i;(Math.abs(u)>10||Math.abs(l)>10)&&(Ae(u,l,t,r),o=n,i=a),t.preventDefault()}})),Ee(t,"touchend",(function(t){if(n){var e=t.changedTouches[0],r=e.pageX,a=e.pageY;Ae(r-o,a-i,t,n)}})),v.change=function(t,e){return Op.call(a,t,e)},m.ok=function(t,e,r,n){return Np.call(a,t,e,r,n)},c.finishedFn=function(t,e){gp.call(a,t,e)},s.finishedFn=function(t,e){wp.call(a,t,e)},c.unhideFn=function(t){fp.call(a,"row",t)},s.unhideFn=function(t){fp.call(a,"col",t)},f.moveFn=function(t,e){mp.call(a,t,e)},h.moveFn=function(t,e){dp.call(a,t,e)},p.change=function(t,e){Ep.call(a,e,t)},b.change=function(t){if("save"===t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(e=a.data).addValidation.apply(e,n)}else a.data.removeValidation()},y.itemClick=function(t){"validation"===t?b.setValue(a.data.getSelectedValidation()):"copy"===t?up.call(a):"cut"===t?lp.call(a):"paste"===t?cp.call(a,"all"):"paste-value"===t?cp.call(a,"text"):"paste-format"===t?cp.call(a,"format"):"hide"===t?sp.call(a):Sp.call(a,t)},Ee(window,"resize",(function(){a.reload()})),Ee(window,"click",(function(t){a.focusing=l.contains(t.target)})),Ee(window,"paste",(function(t){a.focusing&&(cp.call(a,"all",t),t.preventDefault())})),Ee(window,"copy",(function(t){a.focusing&&(up.call(a,t),t.preventDefault())})),Ee(window,"keydown",(function(t){if(a.focusing){var e=t.keyCode||t.which,r=t.key,n=t.ctrlKey,o=t.shiftKey,i=t.metaKey;if(n||i)switch(e){case 90:a.undo(),t.preventDefault();break;case 89:a.redo(),t.preventDefault();break;case 67:break;case 88:lp.call(a),t.preventDefault();break;case 85:v.trigger("underline"),t.preventDefault();break;case 86:break;case 37:Zh.call(a,o,"row-first"),t.preventDefault();break;case 38:Zh.call(a,o,"col-first"),t.preventDefault();break;case 39:Zh.call(a,o,"row-last"),t.preventDefault();break;case 40:Zh.call(a,o,"col-last"),t.preventDefault();break;case 32:Qh.call(a,!1,-1,a.data.selector.ci,!1),t.preventDefault();break;case 66:v.trigger("bold");break;case 73:v.trigger("italic")}else{switch(e){case 32:o&&Qh.call(a,!1,a.data.selector.ri,-1,!1);break;case 27:y.hide(),ap.call(a);break;case 37:Zh.call(a,o,"left"),t.preventDefault();break;case 38:Zh.call(a,o,"up"),t.preventDefault();break;case 39:Zh.call(a,o,"right"),t.preventDefault();break;case 40:Zh.call(a,o,"down"),t.preventDefault();break;case 9:p.clear(),Zh.call(a,!1,o?"left":"right"),t.preventDefault();break;case 13:p.clear(),Zh.call(a,!1,o?"up":"down"),t.preventDefault();break;case 8:Sp.call(a,"delete-cell-text"),t.preventDefault()}"Delete"===r?(Sp.call(a,"delete-cell-text"),t.preventDefault()):e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||"="===t.key?(Ep.call(a,t.key,"input"),bp.call(a)):113===e&&bp.call(a)}}}))}var Ap=function(){return t=function t(e,r){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};qh(this,t),this.options=o,this.options.initialGridStatus=!0,this.eventMap=Te();var i=r.settings,a=i.view,u=i.showToolbar,l=i.showContextmenu;this.el=s("div","".concat(Pe,"-sheet")),this.toolbar=new Zf(r,a.width,!u),this.print=new Xi(r),e.children(this.toolbar.el,this.el,this.print.el),this.data=r,this.tableEl=s("canvas","".concat(Pe,"-table")),this.rowResizer=new Ce(!1,r.rows.height),this.colResizer=new Ce(!0,r.cols.minWidth),this.verticalScrollbar=new Le(!0),this.horizontalScrollbar=new Le(!1),this.editor=new Jr(ui,(function(){return n.getTableOffset()}),r.rows.height,this.options),this.modalValidation=new Ah,this.contextMenu=new na((function(){return n.getRect()}),!l),this.selector=new or(r),this.overlayerCEl=s("div","".concat(Pe,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=s("div","".concat(Pe,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new xh,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new Di(this.tableEl.el,r,this.options),this.sheetContext=new Hh(this.table,this.toolbar,r,o),Ip.call(this),ip.call(this),Qh.call(this,!1,0,0)},(e=[{key:"on",value:function(t,e){return this.eventMap.on(t,e),this}},{key:"trigger",value:function(t){for(var e=this.eventMap,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];e.fire(t,n)}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,rp.call(this),np.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t),this.sheetContext.resetState(t)}},{key:"loadData",value:function(t){return this.data.setData(t),ip.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),ip.call(this),this}},{key:"undo",value:function(){this.data.undo(),ip.call(this)}},{key:"redo",value:function(){this.data.redo(),ip.call(this)}},{key:"reload",value:function(){return ip.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,r=t.cols,n=this.getRect(),o=n.width,i=n.height;return{width:o-r.indexWidth,height:i-e.height,left:r.indexWidth,top:e.height}}}])&&Yh(t.prototype,e),r&&Yh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Tp(t){return(Tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||kp(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mp(t){return function(t){if(Array.isArray(t))return Rp(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||kp(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kp(t,e){if(t){if("string"==typeof t)return Rp(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rp(t,e):void 0}}function Rp(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function jp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dp(n.key),n)}}function xp(t,e,r){return e&&Cp(t.prototype,e),r&&Cp(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dp(t){var e=function(t,e){if("object"!=Tp(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Tp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Tp(e)?e:e+""}function _p(t,e,r){return e=Lp(e),function(t,e){if(e&&("object"==Tp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,r||[],Lp(t).constructor):e.apply(t,r))}function Lp(t){return(Lp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Up(t,e){return(Up=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Fp=function(t){function e(t){var r;return jp(this,e),(r=_p(this,e,[new Sr("ellipsis"),"auto",!1,"top-left"])).contentClick=t,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Up(t,e)}(e,t),xp(e,[{key:"reset",value:function(t){var e=this,r=t.map((function(t,r){return s("div","".concat(Pe,"-item")).css("width","150px").css("font-weight","normal").on("click",(function(){e.contentClick(r),e.hide()})).child(t)}));this.setContentChildren.apply(this,Mp(r))}},{key:"setTitle",value:function(){}}])}(Ia),Vp=[{key:"delete",title:At("contextmenu.deleteSheet")}];function Bp(t){var e=this;return s("div","".concat(Pe,"-item")).child(t.title()).on("click",(function(){e.itemClick(t.key),e.hide()}))}function Hp(){var t=this;return Vp.map((function(e){return Bp.call(t,e)}))}var Gp=function(){return xp((function t(){var e;jp(this,t),this.el=(e=s("div","".concat(Pe,"-contextmenu")).css("width","160px")).children.apply(e,Mp(Hp.call(this))).hide(),this.itemClick=function(){}}),[{key:"hide",value:function(){var t=this.el;t.hide(),Oe(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),Ne(e)}}])}(),qp=function(){return xp((function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};jp(this,t),this.swapFunc=n,this.updateFunc=i,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new Fp((function(t){e.clickSwap2(e.items[t])})),this.contextMenu=new Gp,this.contextMenu.itemClick=o,this.el=s("div","".concat(Pe,"-bottombar")).children(this.contextMenu.el,this.menuEl=s("ul","".concat(Pe,"-menu")).child(s("li","").children(new Sr("add").on("click",(function(){r()})),s("span","").child(this.moreEl))))}),[{key:"addItem",value:function(t,e,r){var n=this;this.dataNames.push(t);var o=s("li",e?"active":"").child(t);o.on("click",(function(){n.clickSwap2(o)})).on("contextmenu",(function(t){if("read"!==r.mode){var e=t.target,i=e.offsetLeft,a=e.offsetHeight;n.contextMenu.setOffset({left:i,bottom:a+1}),n.deleteEl=o}})).on("dblclick",(function(){if("read"!==r.mode){var t=o.html(),e=new ch("auto","");e.val(t),e.input.on("blur",(function(e){var r=e.target.value,o=n.dataNames.findIndex((function(e){return e===t}));n.renameItem(o,r)})),o.html("").child(e.el),e.focus()}})),e&&this.clickSwap(o),this.items.push(o),this.menuEl.child(o),this.moreEl.reset(this.dataNames)}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var t=this;this.items.forEach((function(e){t.menuEl.removeChild(e.el)})),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t=this.activeEl,e=this.deleteEl;if(this.items.length>1){var r=this.items.findIndex((function(t){return t===e}));if(this.items.splice(r,1),this.dataNames.splice(r,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){var n=Pp(this.items,1)[0];return this.activeEl=n,this.activeEl.toggle(),[r,0]}return[r,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex((function(e){return e===t}));this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}])}();r(20);function Yp(t){return(Yp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zp(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],l=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);l=!0);}catch(t){c=!0,o=t}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Xp(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Xp(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xp(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Wp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function $p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Wp(Object(r),!0).forEach((function(e){Kp(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wp(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Kp(t,e,r){return(e=Jp(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zp(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Jp(n.key),n)}}function Jp(t){var e=function(t,e){if("object"!=Yp(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Yp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Yp(e)?e:e+""}var ty=function(){return t=function t(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Qp(this,t);var o=e;this.options=$p({showBottomBar:!0},n),this.sheetIndex=1,this.datas=[],"string"==typeof e&&(o=document.querySelector(e)),this.bottombar=this.options.showBottomBar?new qp((function(){if("read"!==r.options.mode){var t=r.addSheet();r.sheet.resetData(t)}}),(function(t){var e=r.datas[t];r.sheet.resetData(e)}),(function(){r.deleteSheet()}),(function(t,e){r.datas[t].name=e,r.sheet.trigger("change")})):null,this.data=this.addSheet();var i=s("div","".concat(Pe)).on("contextmenu",(function(t){return t.preventDefault()}));o.appendChild(i.el),this.sheet=new Ap(i,this.data,this.options),null!==this.bottombar&&i.child(this.bottombar.el)},r=[{key:"locale",value:function(t,e){Tt(t,e)}}],(e=[{key:"addSheet",value:function(t){var e=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t||"sheet".concat(this.sheetIndex),o=new me(n,this.options);return o.change=function(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];(t=e.sheet).trigger.apply(t,["change"].concat(n))},this.datas.push(o),null!==this.bottombar&&this.bottombar.addItem(n,r,this.options),this.sheetIndex+=1,o}},{key:"deleteSheet",value:function(){if(null!==this.bottombar){var t=zp(this.bottombar.deleteItem(),2),e=t[0],r=t[1];e>=0&&(this.datas.splice(e,1),r>=0&&this.sheet.resetData(this.datas[r]),this.sheet.trigger("change"))}}},{key:"loadData",value:function(t){var e=Array.isArray(t)?t:[t];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],e.length>0)for(var r=0;r<e.length;r+=1){var n=e[r],o=this.addSheet(n.name,0===r);o.setData(n),0===r&&this.sheet.resetData(o)}return this}},{key:"getData",value:function(){return this.datas.map((function(t){return t.getData()}))}},{key:"cellText",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[n].setCellText(t,e,r,"finished"),this}},{key:"cell",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[r].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[r].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return this.sheet.on("change",t),this}}])&&Zp(t.prototype,e),r&&Zp(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),ey=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new ty(t,e)};window&&(window.x_spreadsheet=ey,window.x_spreadsheet.locale=function(t,e){return Tt(t,e)});e.default=ty}]);
//# sourceMappingURL=xspreadsheet.js.map